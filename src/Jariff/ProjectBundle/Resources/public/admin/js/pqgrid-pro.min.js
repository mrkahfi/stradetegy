/**
 * ParamQuery Pro v2.0.2
 * 
 * Copyright (c) 2012-2013 Paramvir Dhindsa (http://paramquery.com)
 * Released under Commercial license
 * http://paramquery.com/pro/license
 * 
 */     	
(function(a){a.paramquery=(a.paramquery==null)?{}:a.paramquery;a.paramquery.pqgrid=(a.paramquery.pqgrid==null)?{}:a.paramquery.pqgrid;a.paramquery.xmlToArray=function(d,e){var c=e.itemParent;var g=e.itemNames;var b=[];var f=a(d).find(c);f.each(function(k,l){var j=a(l);var h=[];a(g).each(function(i,m){h.push(j.find(m).text())});b.push(h)});return b};a.paramquery.xmlToJson=function(d,e){var c=e.itemParent;var g=e.itemNames;var b=[];var f=a(d).find(c);f.each(function(n,o){var l=a(o);var k={};for(var m=0,h=g.length;m<h;m++){var p=g[m];k[p]=l.find(p).text()}b.push(k)});return b};a.paramquery.tableToArray=function(h){var i=a(h);var c=[];var f=[];var g=[];var e=[];var b=i.find("tr:first");var d=i.find("tr:eq(1)");b.find("th,td").each(function(p,m){var j=a(m);var r=j.html();var k=j.width();var s="string";var n=d.find("td:eq("+p+")");var l=n.text();var q=n.attr("align");l=l.replace(/,/g,"");if(parseInt(l)==l&&(parseInt(l)+"").length==l.length){s="integer"}else{if(parseFloat(l)==l){s="float"}}var o={title:r,width:k,dataType:s,align:q,dataIndx:p};c.push(o)});i.find("tr").each(function(k,m){if(k==0){return}var l=a(m);var j=[];l.find("td").each(function(n,o){j.push(a.trim(a(o).html()))});f.push(j)});return{data:f,colModel:c}};a.paramquery.formatCurrency=function(h){h=Math.round(h*10)/10;h=h+"";if(h.indexOf(".")==-1){h=h+".0"}var c=h.length;var e=h.substring(0,c-2),g=h.substring(c-2,c),b=e.match(/\d/g).reverse(),d=[];for(var f=0;f<b.length;f++){if(f>0&&f%3==0){d.push(",")}d.push(b[f])}d=d.reverse();e=d.join("");return e+g};a.paramquery.validation={is:function(b,c){if(b=="string"||!b){return true}b=b.substring(0,1).toUpperCase()+b.substring(1,b.length);return this["is"+b](c)},isFloat:function(c){var b=parseFloat(c);if(!isNaN(b)&&b==c){return true}else{return false}},isInteger:function(c){var b=parseInt(c);if(!isNaN(b)&&b==c){return true}else{return false}},isDate:function(c){var b=Date.parse(c);if(!isNaN(b)){return true}else{return false}}}})(jQuery);(function(b){var a={};a.options={currentPage:0,totalPages:0,totalRecords:0,msg:"",rPPOptions:[10,20,30,40,50,100],rPP:20};a._regional={strPage:"Page {0} of {1}",strFirstPage:"First Page",strPrevPage:"Previous Page",strNextPage:"Next Page",strLastPage:"Last Page",strRefresh:"Refresh",strRpp:"Records per page:",strDisplay:"Displaying {0} to {1} of {2} items."};b.extend(a.options,a._regional);a._create=function(){var d=this,c=this.options;this.element.addClass("pq-pager").css({});this.first=b("<button type='button' title='"+this.options.strFirstPage+"'></button>",{}).appendTo(this.element).button({icons:{primary:"ui-icon-seek-first"},text:false}).bind("click.paramquery",function(e){if(d.options.currentPage>1){if(d._trigger("change",e,{curPage:1})!==false){d.option({currentPage:1})}}});this.prev=b("<button type='button' title='"+this.options.strPrevPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-prev"},text:false}).bind("click",function(e){if(d.options.currentPage>1){var f=d.options.currentPage-1;if(d._trigger("change",e,{curPage:f})!==false){d.option({currentPage:f})}}});b("<span class='pq-separator'></span>").appendTo(this.element);this.pagePlaceHolder=b("<span class='pq-pageholder'></span>").appendTo(this.element);b("<span class='pq-separator'></span>").appendTo(this.element);this.next=b("<button type='button' title='"+this.options.strNextPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-next"},text:false}).bind("click",function(e){var f=d.options.currentPage+1;if(d._trigger("change",e,{curPage:f})!==false){d.option({currentPage:f})}});this.last=b("<button type='button' title='"+this.options.strLastPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-end"},text:false}).bind("click",function(e){var f=d.options.totalPages;if(d._trigger("change",e,{curPage:f})!==false){d.option({currentPage:f})}});b("<span class='pq-separator'></span>").appendTo(this.element);this.$strRpp=b("<span>"+this.options.strRpp+" </span>").appendTo(this.element);this.$rPP=b("<select class='ui-corner-all'></select>").appendTo(this.element).change(function(e){var f=b(this).val();if(d._trigger("change",e,{rPP:f})!==false){d.options.rPP=f}});b("<span class='pq-separator'></span>").appendTo(this.element);this.$refresh=b("<button type='button' title='"+this.options.strRefresh+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-refresh"},text:false}).bind("click",function(e){if(d._trigger("refresh",e)!==false){}});b("<span class='pq-separator'></span>").appendTo(this.element);this.$msg=b("<span class='pq-pager-msg'></span>").appendTo(this.element);this._refresh()};a._refreshPage=function(){var d=this;this.pagePlaceHolder.empty();var g=this.options.strPage;var c=g.split(" ");var f="";b(c).each(function(h,j){f+="<span>"+j+"</span>"});g=f.replace("<span>{0}</span>","<span class='textbox'></span>");g=g.replace("<span>{1}</span>","<span class='total'></span>");var e=b(g).appendTo(this.pagePlaceHolder);this.page=b("<input type='text' tabindex='0' class='ui-corner-all' />").replaceAll("span.textbox",e).bind("change",function(h){var i=b(this);var j=i.val();if(isNaN(j)||j<1){i.val(d.options.currentPage);return false}j=parseInt(j);if(j>d.options.totalPages){i.val(d.options.currentPage);return false}if(d._trigger("change",h,{curPage:j})!==false){d.option({currentPage:j})}else{i.val(d.options.currentPage);return false}});this.$total=e.filter("span.total")};a._refresh=function(){this._refreshPage();var e=(this.$rPP);var l=this.options;this.$strRpp.text(l.strRpp);this.first.attr("title",l.strFirstPage);this.prev.attr("title",l.strPrevPage);this.next.attr("title",l.strNextPage);this.last.attr("title",l.strLastPage);this.$refresh.attr("title",l.strRefresh);e.empty();var c=this.options.rPPOptions;for(var g=0;g<c.length;g++){var d=document.createElement("option");d.text=c[g];d.value=c[g];d.setAttribute("value",c[g]);d.innerHTML=c[g];e.append(d)}e.find("option[value="+l.rPP+"]").attr("selected",true);if(l.currentPage>=l.totalPages){this.next.button({disabled:true});this.last.button({disabled:true})}else{this.next.button({disabled:false});this.last.button({disabled:false})}if(l.currentPage<=1){this.first.button({disabled:true});this.prev.button({disabled:true})}else{this.first.button({disabled:false});this.prev.button({disabled:false})}this.page.val(l.currentPage);this.$total.text(l.totalPages);if(this.options.totalRecords>0){var h=l.rPP;var j=l.currentPage;var k=l.totalRecords;var n=(j-1)*h;var m=j*h;if(m>k){m=k}var f=l.strDisplay;f=f.replace("{0}",n+1);f=f.replace("{1}",m);f=f.replace("{2}",k);this.$msg.html(f)}else{this.$msg.html("")}};a._destroy=function(){this.element.empty().removeClass("pq-pager").enableSelection()};a._setOption=function(c,d){if(c=="currentPage"||c=="totalPages"){d=parseInt(d)}b.Widget.prototype._setOption.call(this,c,d)};a._setOptions=function(){b.Widget.prototype._setOptions.apply(this,arguments);this._refresh()};b.widget("paramquery.pqPager",a);b.paramquery.pqPager.regional={};b.paramquery.pqPager.regional.en=a._regional;b.paramquery.pqPager.setDefaults=function(d){for(var c in d){a.options[c]=d[c]}b.widget("paramquery.pqPager",a);b(".pq-pager").each(function(f,e){b(e).pqPager("option",d)})}})(jQuery);(function(b){var a={};a.options={length:200,num_eles:3,cur_pos:0,timeout:350,pace:"optimum",direction:"vertical"};a._destroy=function(){this.element.removeClass("pq-scrollbar-vert").enableSelection().removeClass("pq-scrollbar-horiz").unbind("click.pq-scrollbar").empty();this.element.removeData()};a._create=function(){var f=this,d=this.options;var g=this.element.empty();if(d.direction=="vertical"){g.addClass("pq-scrollbar-vert");g.html(["<div class='top-btn pq-sb-btn'></div>","<div class='pq-sb-slider'>","<div class='vert-slider-top'></div>","<div class='vert-slider-bg'></div>","<div class='vert-slider-center'></div>","<div class='vert-slider-bg'></div>","<div class='vert-slider-bottom'></div>","</div>","<div class='bottom-btn pq-sb-btn'></div>"].join(""))}else{g.addClass("pq-scrollbar-horiz");g.width(this.width);g.html(["<div class='left-btn pq-sb-btn'></div>","<div class='pq-sb-slider pq-sb-slider-h'>","<span class='horiz-slider-left'></span><span class='horiz-slider-bg'></span><span class='horiz-slider-center'></span><span class='horiz-slider-bg'></span><span class='horiz-slider-right'></span>","</div>","<div class='right-btn pq-sb-btn'></div>"].join(""))}this.element.disableSelection().bind("click.pq-scrollbar",function(j){if(f.options.disabled){return}if(f.$slider.is(":hidden")){return}if(d.direction=="vertical"){var o=j.pageY;var m=f.element.offset().top;var l=m+d.length;var i=f.$slider.offset().top;var k=i+f.$slider.height();if(o<i&&o>m+17){var p=o-m;f.$slider.css("top",p);f._updateCurPosAndTrigger(j)}else{if(o>k&&o<l-17){f.$slider.css("top",o-m-f.$slider.height());f._updateCurPosAndTrigger(j)}}}else{var n=j.pageX;i=f.$slider.offset().left;k=i+f.$slider.width();if(n<i){f.$slider.css("left",n-f.element.offset().left);f._updateCurPosAndTrigger(j)}else{if(n>k){f.$slider.css("left",n-f.element.offset().left-f.$slider.width());f._updateCurPosAndTrigger(j)}}}});var e="x";if(d.direction=="vertical"){e="y"}this.$slider=b("div.pq-sb-slider",this.element).draggable({axis:e,helper:function(i,j){f._setDragLimits();return this},start:function(i){f.topWhileDrag=null},drag:function(i){f.dragging=true;var j=f.options.pace;if(j=="optimum"){f._setNormalPace(i)}else{if(j=="fast"){f._updateCurPosAndTrigger(i)}}},stop:function(i){f._updateCurPosAndTrigger(i);f.dragging=false;f._refresh()}});function c(i){if(f.options.cur_pos>0){f.options.cur_pos--;f.updateSliderPos();f.scroll(i)}}this.$top_btn=b("div.top-btn,div.left-btn",this.element).click(function(i){if(f.options.disabled){return}c(i);i.preventDefault();return false}).mousedown(function(i){if(f.options.disabled){return}f.mousedownTimeout=window.setTimeout(function(){f.mousedownInterval=window.setInterval(function(){c(i)},50)},f.options.timeout)}).bind("mouseup mouseout",function(i){if(f.options.disabled){return}f._mouseup(i)});function h(i){var j=f.options;if(j.cur_pos<j.num_eles-1){j.cur_pos++}f.updateSliderPos();f.scroll(i)}this.$bottom_btn=b("div.bottom-btn,div.right-btn",this.element).click(function(i){if(f.options.disabled){return}h(i);i.preventDefault();return false}).mousedown(function(i){if(f.options.disabled){return}f.mousedownTimeout=window.setTimeout(function(){f.mousedownInterval=window.setInterval(function(){h(i)},50)},f.options.timeout)}).bind("mouseup mouseout",function(i){if(f.options.disabled){return}f._mouseup(i)});this._refresh()};a._mouseup=function(c){if(this.options.disabled){return}var d=this;window.clearTimeout(d.mousedownTimeout);d.mousedownTimeout=null;window.clearInterval(d.mousedownInterval);d.mousedownInterval=null};a._setDragLimits=function(){var c=this.options;if(c.direction=="vertical"){var d=this.element.offset().top+17;var e=(d+c.length-34-this.slider_length);this.$slider.draggable("option","containment",[0,d,0,e])}else{d=this.element.offset().left+17;e=(d+c.length-34-this.slider_length);this.$slider.draggable("option","containment",[d,0,e,0])}};a._refresh=function(){var c=this.options;if(c.num_eles<=1){this.element.css("display","none")}else{this.element.css("display","")}this._validateCurPos();this.$slider.css("display","");if(c.direction=="vertical"){this.element.height(c.length);this._setSliderBgLength();this.scroll_space=c.length-34-this.slider_length;if(this.scroll_space<4||c.num_eles<=1){this.$slider.css("display","none")}this.updateSliderPos(c.cur_pos)}else{this.element.width(c.length);this._setSliderBgLength();this.scroll_space=c.length-34-this.slider_length;if(this.scroll_space<4||c.num_eles<=1){this.$slider.css("display","none")}this.updateSliderPos(c.cur_pos)}};a._setSliderBgLength=function(){var e=this.options,f=e.length,g=e.num_eles*40+f,d=f-34,c=d*f/g,h=Math.round((c-(8+3+3))/2);if(h<1){h=1}this.slider_length=8+3+3+2*h;if(e.direction=="vertical"){b("div.vert-slider-bg",this.element).height(h);this.$slider.height(this.slider_length)}else{b(".horiz-slider-bg",this.element).width(h);this.$slider.width(this.slider_length)}};a._updateCurPosAndTrigger=function(c,i){var f=this,e=this.options,h=e.direction,j=f.$slider;if(i==null){i=(h=="vertical")?parseInt(j[0].style.top,10):parseInt(j[0].style.left,10)}var g=e.length-34-((h=="vertical")?j[0].offsetHeight:j[0].offsetWidth);var d=(i-17)*(e.num_eles-1)/g;d=Math.round(d);if(e.cur_pos!=d){if(this.dragging){if(this.topWhileDrag!=null){if(this.topWhileDrag<i&&e.cur_pos>d){return}else{if(this.topWhileDrag>i&&e.cur_pos<d){return}}}this.topWhileDrag=i}f.options.cur_pos=d;this.scroll(c)}};a._setNormalPace=function(c){if(this.timer){window.clearInterval(this.timer);this.timer=null}var e=this,d=this.options,f=d.direction;e.timer=window.setInterval(function(){var h=e.$slider;var g=(f=="vertical")?parseInt(h[0].style.top,10):parseInt(h[0].style.left,10);if(e.prev_top==g){e._updateCurPosAndTrigger(c,g);window.clearInterval(e.timer);e.timer=null}e.prev_top=g},20)};a.setNumEles=function(c){this.options.num_eles=c;this.updateSliderPos()};a._validateCurPos=function(){var c=this.options;if(c.cur_pos>=c.num_eles){c.cur_pos=c.num_eles-1}if(c.cur_pos<0){c.cur_pos=0}};a.updateSliderPos=function(){var d=this.options;var c=(this.scroll_space*(d.cur_pos))/(d.num_eles-1);if(d.direction=="vertical"){this.$slider.css("top",17+c)}else{this.$slider.css("left",17+c)}};a.scroll=function(c){var d=this.options;this._trigger("scroll",c,{cur_pos:d.cur_pos,num_eles:d.num_eles})};a._setOption=function(c,d){if(c=="disabled"){if(d==true){this.$slider.draggable("disable")}else{this.$slider.draggable("enable")}}b.Widget.prototype._setOption.call(this,c,d)};a._setOptions=function(){b.Widget.prototype._setOptions.apply(this,arguments);this._refresh()};b.widget("paramquery.pqScrollBar",a)})(jQuery);(function(g){var d=function(n){this.that=n;this.hidearrHS1=[];this.offset=null};g.paramquery.cGenerateView=d;var h=d.prototype;h.generateView=function(q){var y=this.that,C=y.options,u=C.virtualX,A=C.numberCell,r=y.colModel,v=y.initH,G=y.finalH,F=C.groupModel,E=parseInt(C.freezeCols),D=parseInt(C.freezeRows),z,M;if(q){var I=this._generateTables(null,null,q);q.$cont.empty();var H=g(I);q.$cont.append(H);if(!y.tables){y.tables=[]}var L=-1;for(var J=0;J<y.tables.length;J++){var p=y.tables[J].cont;if(p==q.$cont[0]){L=J}}if(L==-1){y.tables.push({$tbl:H,cont:q.$cont[0]})}else{y.tables[L].$tbl=H}}else{y._bufferObj_calcInitFinal();var K=y.init;this.init=y.init;var t=y["final"];this["final"]=y["final"];var o=this._generateTables(K,t,q);if(y.$td_edit!=null){y.$td_edit=null;y.$div_focus=null}y.$cont.empty();if(y.totalVisibleRows===0){y.$cont.append("<div class='pq-cont-inner pq-grid-norows' >"+C.strNoRows+"</div>")}else{if(!u&&(E||A.show)){y.$cont.append("<div class='pq-cont-inner'>"+o+"</div><div class='pq-cont-inner'>"+o+"</div>")}else{y.$cont.append("<div class='pq-cont-inner'>"+o+"</div>")}}var n=y.$cont.children("div");if(n.length==2){var x=g(n[0]);var s=g(n[1]);H=y.$cont.children().children("table");y.$tbl=H;var B=g(H[1]);z=i.call(y,-1,E);x.css({width:z,zIndex:1});M=i.call(y,E,v);s.css({left:z+"px",width:y.$tbl[0].scrollWidth,position:"absolute"});B.css({left:(-1*(M+z))+"px"})}else{H=y.$tbl=y.$cont.children().children("table");var w=g(n[0]);M=i.call(y,E,v);if(!u){H.css({left:"-"+(M)+"px"})}}y._fixTableViewPort();y._trigger("refresh",null,{dataModel:C.dataModel,colModel:r,pageData:(F?y.dataGM:y.data),initV:y.init,finalV:y["final"],initH:v,finalH:G})}};h._generateTables=function(Z,L,R){var M=this.that,S=M.colModel,y=S.length,B=M.options,v=B.virtualX,J=M.initH,W=M.finalH,T=B.numberCell,aa=B.columnBorders,G=B.rowBorders,r=B.scrollModel,o=B.groupModel,H=M.hidearrHS,D=B.freezeCols,n=parseInt(B.freezeRows),V=false,p=M.outerWidths,z=0,X=(R)?R.data.length-1:L,N="",O=o?true:false,C=B.treeModel,ab=(R&&R.data)?R.data:(O?M.dataGM:(M.data)),P=M.rowIndxOffset;if(!R&&(Z==null||X==null)){M.$cont.empty();M.$tbl=null;return}if(!R){M._trigger("beforeTableView",null,{pageData:ab,initV:Z,finalV:L,initH:J,finalH:W,colModel:S})}var s="pq-grid-table ";if(aa){s+="pq-grid-td-border-right "}if(G){s+="pq-grid-td-border-bottom "}var E=["<table class='"+s+"' cellpadding=0 cellspacing=0 >"];this.hidearrHS1=[];if(1===1){E.push("<tr class='pq-row-hidden'>");if(T.show){var t=T.width+1;E.push("<td style='width:"+t+"px;' ></td>")}for(var u=0;u<=W;u++){if((v||R)&&H[u]){this.hidearrHS1.push(u);continue}var Q=S[u];if(Q.hidden){continue}t=p[u];E.push("<td style='width:"+t+"px;' pq-top-col-indx="+u+"></td>")}E.push("</tr>")}this.offsetRow=null;for(var z=0;z<=X;z++){if(z<Z&&z>=n){z=Z}var q=ab[z],U=q,x=O?(q.rowIndx-P):z,A=(q)?q.pq_hidden:false;if(A){continue}V=false;if(n&&M.lastFrozenRow==z){V=true}if(this.offsetRow==null&&x!=null){M.offsetRow=(z-x)}if(o&&q.groupTitle){this._generateTitleRow(o,q,E,V)}else{if(o&&q.groupSummary){this._generateSummaryRow(q.data,S,E,V)}else{this._generateRow(U,x,S,E,R,V)}}}M.scrollMode=false;E.push("</table>");var I=E.join("");if(R){R.$cont.empty();var w=g(I);R.$cont.append(w);if(!M.tables){M.tables=[]}var F=-1;for(var Y=0;Y<M.tables.length;Y++){var K=M.tables[Y].cont;if(K==R.$cont[0]){F=Y}}if(F==-1){M.tables.push({$tbl:w,cont:R.$cont[0]})}else{M.tables[F].$tbl=w}}else{}return I};h._renderCell=function(p){var t=this.that,y=t.options.dataModel,o=p.rowIndxPage,v=p.rowIndx,w=p.rowData,B=p.colIndx,s=p.$td,C=p.expandIndx,F=p.expanded,I=p.treeMarginLeft,H=p.isLeaf,q=p.column,r=q.type,z=q.dataIndx,A=w[z],x=p.wrap,G=p.customData;if(!w){return}var D;if(r==="checkBoxSelection"){D="<input type='checkbox' "+(A?"checked='checked'":"")+" />"}else{if(q.render){D=q.render({data:t.data,dataModel:y,rowData:w,cellData:A,rowIndxPage:o,rowIndx:v,colIndx:B,column:q,dataIndx:z})}else{D=A}}if(D===""||D==undefined){D="&nbsp;"}var n="pq-td-div";if(x==false){n+=" pq-wrap-text"}var J="";if(z==C){var u="";if(H){u="ui-icon-radio-off"}else{if(F){u="ui-icon-triangle-1-se pq-tree-expand-icon"}else{u="ui-icon-triangle-1-e pq-tree-expand-icon"}}J=["<div class='pq-tree-icon-container' style='width:",I,"px;'>","<div class='ui-icon ",u," pq-tree-icon' ></div></div>"].join("")}var E="<div class='"+n+"'>"+J+D+"</div>";if(s!=undefined){s.html(E)}return E};h._generateRow=function(U,D,T,H,S,W){var r="pq-grid-row";if(W){r+=" pq-last-freeze-row"}var O=this.that,E=O.options,G=E.freezeCols,V=E.numberCell,F=E.treeModel,ab=E.columnBorders,Y=E.wrap,B=T.length,y=E.virtualX,M=O.initH,Z=O.finalH,Q=this.offset,J=O.hidearrHS,ad=E.customData;var X="pq-grid-cell ";if(!E.wrap||S){X+="pq-wrap-text "}var C;if(F){var t=F.levelIndx,v=F.leafIndx,aa=F.expandIndx,I=U[v],u=U[t],K=(u+1)*18,n=O._getRowPQData(D,"expanded"),C={rowIndx:D+Q,rowIndxPage:D,rowData:U,wrap:Y,customData:ad,treeMarginLeft:K,expandIndx:aa,isLeaf:I,expanded:n}}else{C={rowIndx:D+Q,rowIndxPage:D,rowData:U,wrap:Y,customData:ad}}if(E.stripeRows&&(D/2==parseInt(D/2))){r+=" pq-grid-oddRow"}if(U.pq_selectedrow){r+=" pq-row-select ui-state-highlight"}var s;var x=U.pq_rowcls;var q=U.pq_cellcls;if(x!=null){r+=" "+x}H.push("<tr pq-row-indx='"+D+"' class='"+r+"' >");if(V.show){H.push(["<td class='pq-grid-number-cell ui-state-default'>","<div class='pq-td-div'>",((S)?"&nbsp;":(D+1)),"</div></td>"].join(""))}for(var w=0;w<=Z;w++){if(w<M&&w>=G&&(y||S)){w=M;if(w>Z){throw ("initH>finalH");break}}var R=T[w],P=R.dataIndx;if(R.hidden){continue}C.column=R;C.colIndx=w;C.dataIndx=P;var o=false;if(1===1){var ac=U.pqSelectedCells;if(ac){o=ac[P]}}var N="";var p=X;if(R.align=="right"){p+=" pq-align-right"}else{if(R.align=="center"){p+=" pq-align-center"}}if(w==G-1&&ab){p+=" pq-last-freeze-col"}if(R.cls){p=p+" "+R.cls}if(o){p=p+" pq-cell-select ui-state-highlight"}if(q){var s=q[P];if(s){p+=" "+s}}var z="pq-col-indx='"+w+"'";if(S){z+=" pq-dataIndx='"+P+"'"}var A="";var L=["<td ",A," class='",p,"' style='",N,"' ",z," >",this._renderCell(C),"</td>"].join("");H.push(L)}H.push("</tr>");return H};var j=function(){};var a=j.prototype;a.getLastSelection=function(){var t=this.lastSelection;if(t){var w=this.that,x=this.options,y=x.dataModel,o=y.paging,r=t.rowIndx,p=t.rowData,q=w.rowIndxOffset,n=r-q,s=y.data,v=(o=="remote")?n:r,u=s[v];if(p==u&&this.isSelected(t)){return t}else{return false}}else{return null}};a.getLastSelectionCurPage=function(){var n=this.lastSelection;if(n&&this.isSelected(n)){var q=n.rowIndx,o=this.that.options.dataModel;if(o.paging){var p=o.curPage,r=o.rPP;if(Math.ceil((q+1)/r)==p){return n}else{return null}}else{return n}}else{return null}};a.getSelection=function(){this.refresh();return this.selection};a.getSelectionCurPage=function(){var r=this.that,t=this.getSelection(),u=[],v=r.options.dataModel;if(v.paging){var s=v.curPage,q=v.rPP;for(var p=0;p<t.length;p++){var n=t[p],o=n.rowIndx;if(Math.ceil((o+1)/q)==s){u.push(n)}}return u}else{return t}};a.setDirty=function(){};var l=function(n){this.that=n;this.options=n.options;this.selection=[];this.isDirty=false};g.paramquery.cRows=l;var b=l.prototype=new j;b._addToData=function(n){var q=this.options,p=q.dataModel,o=p.paging,t=p.data,r=(o=="remote")?n.rowIndxPage:n.rowIndx,s=t[r];s.pq_selectedrow=true;this.lastSelection={rowIndx:n.rowIndx,rowData:s}};b.removeAll=function(o){this.refresh();var s=o.raiseEvent,r=this.that,u=(o.offset==null)?r.getRowIndxOffset():o.offset;var t=this.selection.slice(0);for(var p=0;p<t.length;p++){var n=t[p];var q=n.rowIndx;this.remove({rowIndx:q,offset:u})}this.lastSelection=null};b.refresh=function(){this.selection=[];var u=this.that,w=this.options.dataModel,o=w.paging,n=(o=="remote")?true:false,r=u.rowIndxOffset,s=w.data;if(!s){return}for(var t=0,v=s.length;t<v;t++){var p=s[t];if(p.pq_selectedrow){var q=(n)?(t+r):t;this.selection.push({rowIndx:q})}}};b.replace=function(r){var q=r.rowIndx,s=(r.offset==null)?this.that.getRowIndxOffset():r.offset,n=q-s,p=r.$tr,o=r.evt;r.offset=s;r.rowIndxPage=n;this.removeAll({raiseEvent:true});this.add(r)};b._add=function(w){var q=w.rowIndx,s=this.that,u=this.options,p=(w.offset==null)?s.rowIndxOffset:w.offset,n=q-p,r=w.$tr,v=w.evt,o=this.isSelected({rowIndx:q,rowIndxPage:n});w.rowIndxPage=n;if(o==null){return false}else{if(o==false){var t=this._boundRow(w),r=t;this._addToData(w);s._trigger("rowSelect",v,{rowIndx:q,rowIndxPage:n,data:s.data,dataModel:u.dataModel,$tr:r})}}};b.add=function(p){var t=this.that,s=this.options,q=p.evt;if(typeof p.rowIndx.splice=="function"){var o=p.rowIndx;for(var r=0,n=o.length;r<n;r++){var u={rowIndx:o[r]};u.noTrigger=true;this._add(u)}t._trigger("rowSelect",q,{dataModel:s.dataModel})}else{this._add(p)}};b.remove=function(o){if(o.rowIndx==null){throw"rowIndx NA"}var t=o.rowIndx,s=this.that,q=this.options,u=s.rowIndxOffset,n=t-u,p=o.evt;o.rowIndxPage=n;if(this.isSelected(o)){var r=s.getRow({rowIndxPage:n});if(r){r.removeClass("pq-row-select ui-state-highlight")}s._trigger("rowUnSelect",p,{rowIndx:t,dataModel:q.dataModel,$tr:r});this._removeFromData(o)}};b.indexOf=function(q){this.refresh();var o=q.rowIndx,p=this.selection;for(var n=0;n<p.length;n++){if(p[n].rowIndx==o){return n}}return -1};b.isSelected=function(w){var u=this.that,v=this.options.dataModel,o=v.paging,q=u.rowIndxOffset,r=(w.rowIndx==null)?(obj.rowIndxPage+q):w.rowIndx,n=(w.rowIndxPage==null)?(r-q):w.rowIndxPage,s=v.data,t=(o=="remote")?n:r,p=s[t];return(p)?((p.pq_selectedrow==null)?false:p.pq_selectedrow):null};b._removeFromData=function(n){var p=this.options.dataModel,o=p.paging,s=p.data,q=(o=="remote")?n.rowIndxPage:n.rowIndx,r=s[q];r.pq_selectedrow=false};b._boundRow=function(r){var n=r.rowIndxPage,q=r.rowIndx,p=this.that,o=(r.$tr==null)?p.getRow({rowIndxPage:n}):r.$tr;if(o==null||o.length==0){return false}o.addClass("pq-row-select ui-state-highlight");return o};var c=function(n){this.options=n.options;this.that=n;this.selection=[]};var m=c.prototype=new j;m._addToData=function(v){var u=this.options.dataModel,n=u.paging,s=v.dataIndx,p=v.rowIndx,t=u.location;var q=u.data,r=(n=="remote")?v.rowIndxPage:p,o=q[r];if(!o.pqSelectedCells){o.pqSelectedCells={}}o.pqSelectedCells[s]=true;this.lastSelection={rowIndx:p,dataIndx:s,rowData:o}};m._removeFromData=function(n){var q=this.options.dataModel,p=q.paging,o=q.location;var t=q.data,r=(p=="remote")?n.rowIndxPage:n.rowIndx,s=t[r];if(s&&s.pqSelectedCells){delete s.pqSelectedCells[n.dataIndx]}};m.removeAll=function(o){this.refresh();var u=o.raiseEvent,t=this.that,n=this.selection.slice(0);for(var r=0;r<n.length;r++){var q=n[r];var s=q.rowIndx,p=q.dataIndx;this.remove({rowIndx:s,dataIndx:p})}this.lastSelection=null};m.isSelected=function(x){var w=this.options.dataModel,o=w.paging,u=this.that,q=u.rowIndxOffset,s=w.data,r=x.rowIndx,n=x.rowIndxPage,r=(r==null)?(n+q):r,n=(n==null)?(r-q):n,t=(o=="remote")?n:r,v=x.dataIndx,v=(v==null)?u.colModel[x.colIndx].dataIndx:v,p=s[t];if(p==null){return null}if(p.pqSelectedCells){if(p.pqSelectedCells[v]){return true}}return false};m.refresh=function(){this.selection=[];var v=this.that,y=this.options.dataModel,t=y.data,o=y.paging,n=(o=="remote")?true:false,s=v.rowIndxOffset;if(!t){return}for(var u=0,w=t.length;u<w;u++){var q=t[u];var p=q.pqSelectedCells;if(p){var r=(n)?(u+s):u;for(var x in p){if(p[x]){this.selection.push({rowIndx:r,dataIndx:x})}}}}this.isDirty=false};m.replace=function(r){var p=r.rowIndx,q=r.colIndx,t=(r.offset==null)?this.that.getRowIndxOffset():r.offset,n=p-t,s=r.$td,o=r.evt;r.rowIndxPage=n;r.offset=t;this.removeAll({raiseEvent:true});this.add(r)};m._add=function(x){var s=x.rowIndx,t=this.that,v=this.options,r=t.rowIndxOffset,n=s-r,q=x.colIndx,u=x.dataIndx,q=(q==null)?t.getColIndx({dataIndx:u}):q,u=(u==null)?t.colModel[q].dataIndx:u,w=x.evt,p=this.isSelected({rowIndx:s,rowIndxPage:n,dataIndx:u});if(p==null){return false}else{if(p==false){var o=t.getCell({rowIndxPage:n,colIndx:q});if(o){o.addClass("pq-cell-select ui-state-highlight")}this._addToData({rowIndx:s,rowIndxPage:n,dataIndx:u});if(!x.noTrigger){t._trigger("cellSelect",w,{rowIndx:s,rowIndxPage:n,colIndx:q,dataIndx:u,data:t.data,dataModel:v.dataModel})}}}};m.add=function(o){var s=this.that,r=this.options,p=o.evt;if(typeof o.splice=="function"){for(var q=0,n=o.length;q<n;q++){var t=o[q];t.noTrigger=true;this._add(t)}s._trigger("cellSelect",p,{cells:o,dataModel:r.dataModel})}else{this._add(o)}};m.remove=function(v){var r=v.rowIndx,s=this.that,t=(v.dataIndx==null)?s.colModel[v.colIndx].dataIndx:v.dataIndx,p=(v.colIndx==null)?s.getColIndx({dataIndx:t}):v.colIndx,q=s.rowIndxOffset,n=r-q,u=v.evt;v.rowIndxPage=n;if(this.isSelected(v)){var o=s.getCell({rowIndxPage:n,colIndx:p});if(o){o.removeClass("pq-cell-select ui-state-highlight")}s._trigger("cellUnSelect",u,{rowIndx:r,colIndx:p,dataIndx:t,dataModel:s.options.dataModel});this._removeFromData(v)}};m.indexOf=function(t){this.refresh();var s=t.rowIndx,r=this.that,o=(t.dataIndx==null)?r.colModel[t.colIndx].dataIndx:t.dataIndx;t.dataIndx=o;var n=this.selection;for(var p=0;p<n.length;p++){var q=n[p];if(q.rowIndx==s&&q.dataIndx==o){return p}}return -1};var e=function(n){this.options=n.options;this.that=n};var f=e.prototype;var k={widgetEventPrefix:"pqgrid"};k.options={collapsible:true,colModel:null,columnBorders:true,customData:null,dataModel:{cache:false,curPage:0,totalPages:0,rPP:10,location:"local",sorting:"local",sortDir:"up",method:"GET",rPPOptions:[10,20,50,100]},direction:"",draggable:false,editable:true,editModel:{cellBorderWidth:1,clicksToEdit:1,filterKeys:true,keyUpDown:true,saveKey:"",select:false},editor:{type:"contenteditable"},validation:{icon:"ui-icon-alert",cls:"ui-state-error"},flexHeight:false,flexWidth:false,freezeCols:0,freezeRows:0,getDataIndicesFromColIndices:true,height:400,hoverMode:"row",minWidth:50,numberCell:{width:50,title:"",resizable:false,minWidth:50,show:true},stripeRows:true,resizable:false,roundCorners:true,rowBorders:true,scrollModel:{pace:"fast",horizontal:true,lastColumn:"auto",autoFit:false},selectionModel:{type:"row",mode:"range"},showBottom:true,showHeader:true,showTitle:true,showToolbar:true,showTop:true,sortable:true,sql:false,title:"&nbsp;",treeModel:null,width:600,wrap:true};k._regional={strLoading:"Loading",strNoRows:"No rows to display.",strAdd:"Add",strEdit:"Edit",strDelete:"Delete",strSearch:"Search",strNothingFound:"Nothing found",strSelectedmatches:"Selected {0} of {1} match(es)",strPrevResult:"Previous Result",strNextResult:"Next Result"};g.extend(k.options,k._regional);k._destroyResizable=function(){if(this.element.data("resizable")){this.element.resizable("destroy")}};k._destroyDraggable=function(){if(this.element.data("draggable")){this.element.draggable("destroy")}};k._disable=function(){if(this.$disable==null){this.$disable=g("<div class='pq-grid-disable'></div>").css("opacity",0.2).appendTo(this.element)}};k._enable=function(){if(this.$disable){this.element[0].removeChild(this.$disable[0]);this.$disable=null}};k._destroy=function(){this._destroyResizable();this._destroyDraggable();this.element.empty();this.element.css("height","");this.element.css("width","");this.element.removeClass("pq-grid ui-widget ui-widget-content ui-corner-all").removeData()};k._findCellFromEvtCoords=function(A){if(this.$tbl==null){return null}var y=g(A.target).closest(".pq-cell-selected-border-edit");if(y.length>0){return null}var z=A.pageY-this.$cont.offset().top;var s=A.pageX-this.$cont.offset().left;var r=this.$tbl.find("tr.pq-grid-row");var x=0,o=0,t=0;for(var v=1;v<r.length;v++){if(r[v].offsetTop>z){break}else{x++}}var w=g(r[x]);o=parseInt(w.attr("pq-row-indx"));var n=w.find("td.pq-grid-cell");var x=0,q=false;for(var v=0;v<n.length;v++){var u=n[v];if(u.offsetLeft<s&&u.offsetLeft+u.offsetWidth>s){q=true;break}else{if(u.offsetLeft>s){break}else{x++}}}if(!q){return null}var p=g(n[x]);if(p[0].nodeName.toUpperCase()!="TD"){p=g(A.target).parent("td")}t=parseInt(p.attr("pq-col-indx"));if(isNaN(t)){return null}return{$td:p,rowIndxPage:o,rowIndx:o+this.rowIndxOffset,colIndx:t,dataIndx:this.colModel[t].dataIndx}};k._rangeSelectRow=function(p,s,u){var r=this,t=r.iRows.getSelection(),n=t.slice(0);for(var q=0;q<n.length;q++){var o=n[q],v=o.rowIndx;if(v<p||v>s){r.iRows.remove({rowIndx:v})}}for(var v=p;v<=s;v++){r.iRows.add({rowIndx:v})}};k._rangeSelect=function(u,r,y,v,z){var w=this,o=w.iCells.getSelection(),q=o.slice(0);for(var t=0;t<q.length;t++){var s=q[t],A=s.rowIndx,x=s.dataIndx,n=this.getColIndx({dataIndx:x});if(A<u||A>y){w.iCells.remove({rowIndx:A,colIndx:n,dataIndx:x})}else{if(A==u&&n<r){w.iCells.remove({rowIndx:A,colIndx:n,dataIndx:x})}else{if(A==y&&n>v){w.iCells.remove({rowIndx:A,colIndx:n,dataIndx:x})}}}}for(var n=0;n<w.colModel.length;n++){var p=w.colModel[n];if(p.hidden){continue}var x=p.dataIndx;var A=u;do{if(A==u&&n<r){}else{if(A==y&&n>v){break}else{w.iCells.add({rowIndx:A,colIndx:n,dataIndx:x})}}A++}while(A<=y)}};k._blockSelect=function(v,r,z,w,A){var x=this,o=x.iCells.getSelection(),q=o.slice(0);for(var u=0;u<q.length;u++){var t=q[u],B=t.rowIndx,y=t.dataIndx,n=this.getColIndx({dataIndx:y});if(n<r||n>w){x.iCells.remove({rowIndx:B,dataIndx:y,colIndx:n})}else{if(B<v||B>z){x.iCells.remove({rowIndx:B,dataIndx:y,colIndx:n})}}}var s=[];for(var n=r;n<=w;n++){var p=x.colModel[n];var y=p.dataIndx;if(p.hidden){continue}var B=v;do{s.push({rowIndx:B,colIndx:n,dataIndx:y});B++}while(B<=z);x.iCells.add(s)}};k._createIconList=function(){var r=this,t=this.options,o=t.toolbarIcons;if(!o){return}var p="<div class='pq-icon-list'>";for(var q=0;q<o.length;q++){var w=o[q],s=w.iconCls,u=w.title;p+="<span class='pq-icon-holder' title='"+u+"'><span class='ui-icon "+s+"'></span></span>"}p+="</div>";var v=g(p).appendTo(this.$bottom);v.find("span.pq-icon-holder").mouseover(function(x){g(this).addClass("ui-state-hover")}).mouseout(function(x){g(this).removeClass("ui-state-hover")});for(var q=0;q<o.length;q++){var w=o[q],s=w.iconCls,n=w.toolbar;v.find("span."+s).parent(".pq-icon-holder").click(function(x){return function(y){var A=g(this),z=g(x).pqToolbar({a:"b"});if(A.hasClass("ui-state-active")){A.removeClass("ui-state-active")}else{A.addClass("ui-state-active")}}}(n))}};k._createSlidingTop=function(s){var r=this,p=false,q=0,n=g(["<div class='pq-slider-icon' style='z-index:5;' >","<span class='ui-icon ui-icon-circle-triangle-n'></span>","</div>"].join("")).appendTo(s),o=n.children("span");n.mouseover(function(t){n.addClass("ui-state-hover")}).mouseout(function(t){n.removeClass("ui-state-hover")}).click(function(t){var v=r.element,u=r.options;if(p){v.animate({height:q},function(){r.refresh();o.addClass("ui-icon-circle-triangle-n").removeClass("ui-icon-circle-triangle-s");r.$toolbar.pqToolbar("enable")});p=false}else{q=(u.flexHeight)?v[0].offsetHeight:u.height;v.animate({height:"23px"},function(){o.addClass("ui-icon-circle-triangle-s").removeClass("ui-icon-circle-triangle-n");if(v.hasClass("ui-resizable")){v.resizable("destroy")}r.$toolbar.pqToolbar("disable")});p=true}});this.$collapsible=n};k._create=function(){var r=this;this.iGenerateView=new d(this);this.iKeyNav=new e(this);var o=r.widgetEventPrefix.toLowerCase();this.element.on(o+"celleditkeydown",function(s,t){return r.iKeyNav.filterKeys(s,t)});this.cols=[];this.widths=[];this.outerWidths=[];this.rowHeight=22;this.hidearr=[];this.hidearrHS=[];this.tables=[];var r=this,q=this.options;this.$tbl=null;this._calcThisColModel();this._refreshSorters();this.element.empty().addClass("pq-grid ui-widget ui-widget-content"+(q.roundCorners?" ui-corner-all":"")).append(["<div class='pq-grid-top ui-widget-header",(q.roundCorners?" ui-corner-top":""),"'>","<div class='pq-grid-title",(q.roundCorners?" ui-corner-top":""),"'>&nbsp;</div></div>","<div class='pq-grid-inner' tabindex='0'><div class='pq-grid-right'>","<div class='pq-header-outer ui-widget-header'>","<span class='pq-grid-header ui-state-default'></span><span class='pq-grid-header ui-state-default'></span>","</div>","<div class='pq-cont-right' >","<div class='pq-cont' ></div>","</div>","</div></div>","<div class='pq-grid-bottom ui-widget-header",(q.roundCorners?" ui-corner-bottom":""),"'>","<div class='pq-grid-footer'>&nbsp;</div>","</div>"].join(""));this._trigger("render",null,{dataModel:this.options.dataModel,colModel:this.colModel});this.$top=g("div.pq-grid-top",this.element);this.$title=g("div.pq-grid-title",this.element);if(!q.showTitle){this.$title.css("display","none")}if(q.collapsible){this._createSlidingTop(this.$top)}this.$toolbar=g("div.pq-grid-toolbar",this.element);this.$grid_inner=g("div.pq-grid-inner",this.element);this.$grid_right=g(".pq-grid-right",this.element);this.$header_o=g("div.pq-header-outer",this.$grid_right);if(!q.showTop){this.$top.css("display","none")}this.$header=g(".pq-grid-header",this.$grid_right);this.$header_left=g(this.$header[0]);this.$header_right=g(this.$header[1]);this.$bottom=g("div.pq-grid-bottom",this.element);if(!q.showBottom){this.$bottom.css("display","none")}this.$footer=g("div.pq-grid-footer",this.element);this.$cont_o=g("div.pq-cont-right",this.$grid_right);this.$cont_fixed=g("div.pq-cont-fixed",this.$grid_right);this.$cont=g("div.pq-cont",this.$grid_right);this.$cont.on("click",function(s){r._onClickCont(s)});this.$cont.on("click",".pq-tree-expand-icon",function(s){return r.cTreeView._onClickTreeExpandIcon(s)});this.$cont.on("click","td.pq-grid-cell",function(s){return r._onClickCell(s)});this.$cont.on("click","tr.pq-grid-row",function(s){return r._onClickRow(s)});this.$cont.on("contextmenu","td.pq-grid-cell",function(s){return r._onRightClickCell(s)});this.$cont.on("contextmenu","tr.pq-grid-row",function(s){return r._onRightClickRow(s)});this.$cont.on("dblclick","td.pq-grid-cell",function(s){return r._onDblClickCell(s)});this.$cont.on("dblclick","tr.pq-grid-row",function(s){return r._onDblClickRow(s)});this.$cont.on("mousedown","td.pq-grid-cell",function(s){});this.$cont.on("mousedown",function(t){var s=r._findCellFromEvtCoords(t);if(!s){return true}s.dataModel=r.options.dataModel;if(r._trigger("cellMouseDown",t,s)==false){return false}return true});this.$cont.on("mousemove","td.pq-grid-cell",function(s){return r._onCellMouseMove(s)});this.$cont.on("mouseup","td.pq-grid-cell",function(s){return r._onCellMouseUp(s)});this.element.on("mouseup",function(s){if(r._trigger("mouseUp",s,{dataModel:r.options.dataModel})==false){return false}});this.$cont.on("mouseenter","td.pq-grid-cell",function(s){var t=g(this);if(r._trigger("cellMouseEnter",s,{$td:t,dataModel:r.options.dataModel})==false){return false}if(r.options.hoverMode=="cell"){r.highlightCell(t)}return true});this.$cont.on("mouseenter","tr.pq-grid-row",function(t){var v=g(this);var u=r.getRowIndx({$tr:v});var s=u.rowIndxPage;if(r._trigger("rowMouseEnter",t,{$tr:v,dataModel:r.options.dataModel})==false){return false}if(r.options.hoverMode=="row"){r.highlightRow(s)}return true});this.$cont.on("mouseleave","td.pq-grid-cell",function(s){var t=g(this);if(r._trigger("cellMouseLeave",s,{$td:t,dataModel:r.options.dataModel})==false){return false}if(r.options.hoverMode=="cell"){r.unHighlightCell(t)}return true});this.$cont.on("mouseleave","tr.pq-grid-row",function(t){var v=g(this);var u=r.getRowIndx({$tr:v});var s=u.rowIndxPage;if(r._trigger("rowMouseLeave",t,{$tr:v,dataModel:r.options.dataModel})==false){return false}if(r.options.hoverMode=="row"){r.unHighlightRow(s)}return true});this.$cont.bind("mousewheel DOMMouseScroll",function(s){return r._onMouseWheel(s)});var n=0;this.$hvscroll=g("<div class='pq-hvscroll-square ui-widget-content'></div>").appendTo(this.$grid_inner);this.$vscroll=g("<div class='pq-vscroll'></div>").appendTo(this.$grid_inner);this.prevVScroll=0;this.$vscroll.pqScrollBar({pace:r.options.scrollModel.pace,direction:"vertical",cur_pos:0,scroll:function(s,u){r.scrollMode=true;r.selectCellRowCallback(function(){r.iGenerateView.generateView()});var t;g.measureTime(function(){if(s.originalEvent&&s.originalEvent.type=="drag"){t=r._setScrollVNumEles()}else{t=r._setScrollVNumEles(true)}if(t<=1){r._setScrollHLength()}},"scrollBar setNumEles stuff")}});var p=0;this.$hscroll=g("<div class='pq-hscroll'></div>").appendTo(this.$grid_inner);this.$hscroll.pqScrollBar({direction:"horizontal",pace:r.options.scrollModel.pace,cur_pos:0,scroll:function(s,t){r.refresh()}});this.element.width(this.options.width).height(this.options.height);this.element.width(this.element.width());this.disableSelection();if(window.opera){this.$grid_inner.bind("keypress.pq-grid",{that:this},function(s){r._keyPressDown(s)})}else{this.$grid_inner.bind("keydown.pq-grid",{that:this},function(s){r._keyPressDown(s)})}this._refreshOptions();this._refreshTitle();this._refreshDataIndices();this._createSelectedRowsObject();this._createSelectedCellsObject();this.generateLoading();this._initPager();this._refresh();this.refreshDataAndView();var o=r.widgetEventPrefix.toLowerCase();r.element.one(o+"load",function(s,t){r._refresh()})};k._onMouseWheel=function(o){if(this.options.flexHeight){return true}var r=this;var q=0;var o=o.originalEvent;if(o.wheelDelta){q=o.wheelDelta/120}else{if(o.detail){q=o.detail*-1/3}}var p=parseInt(r.$vscroll.pqScrollBar("option","cur_pos"));var n=p-q;if(n>=0){r.$vscroll.pqScrollBar("option","cur_pos",p-q).pqScrollBar("scroll")}return false};k._onDblClickCell=function(o){var q=this;var u=g(o.currentTarget);var s=q.getCellIndices({$td:u});var n=s.rowIndxPage,t=q.getRowIndxOffset(),p=n+t,r=s.colIndx;if(r==null){return}if(q._trigger("cellDblClick",o,{$td:u,dataModel:q.options.dataModel,rowIndxPage:n,rowIndx:p,colIndx:r})==false){return false}if(q.options.editModel.clicksToEdit>1&&this.isEditableRow({rowIndx:p})&&this.isEditableCell({colIndx:r,rowIndx:p})){q._setSelection(null);if(q.options.selectionModel.type=="cell"){q._setSelection({rowIndx:p,colIndx:r})}else{if(q.options.selectionModel.type=="row"){q._setSelection({rowIndx:p})}}q._editCell(u)}};k._onClickCont=function(n){var o=this;if(o.$td_edit){if(!o._isEditCell(n)){o.quitEditMode(n)}}};k._onClickRow=function(y){var w=this;var v=g(y.currentTarget);var n=parseInt(v.attr("pq-row-indx")),r=w.rowIndxOffset,s=n+r;if(isNaN(n)){return}var A={rowIndx:s,evt:y},z=this.options;if(w._trigger("rowClick",y,{$tr:v,rowIndxPage:n,rowIndx:s,dataModel:z.dataModel})==false){return false}var o=z.selectionModel;if(o.type=="row"){var u=w.iRows.getLastSelection();if(u){if(y.ctrlKey&&o.mode!="single"){if(w.iRows.indexOf(A)!=-1){w.iRows.remove(A)}else{w._setSelection(A)}}else{if(y.shiftKey&&o.mode!="single"){var q=u,p=q.rowIndx,t=p,x=s;if(p>s){t=s;x=p}this._rangeSelectRow(t,x,y);w._setSelection(A)}else{w.iRows.removeAll({raiseEvent:true});w._setSelection(A)}}}else{if(u===false){w.iRows.removeAll({raiseEvent:true});w._setSelection(A)}else{w._setSelection(A)}}}};k._onRightClickRow=function(o){var s=this,r=g(o.currentTarget),n=parseInt(r.attr("pq-row-indx")),t=s.rowIndxOffset,q=n+t;if(isNaN(n)){return}var p=this.options;if(s._trigger("rowRightClick",o,{$tr:r,rowIndxPage:n,rowIndx:q,dataModel:p.dataModel})==false){return false}};k._onDblClickRow=function(p){var s=this;var r=g(p.currentTarget);var o=parseInt(r.attr("pq-row-indx")),t=s.getRowIndxOffset(),q=o+t;var n={rowIndx:q,evt:p};if(s._trigger("rowDblClick",p,{$tr:r,rowIndxPage:o,rowIndx:q,dataModel:s.options.dataModel})==false){return false}};k._isValid=function(C){var v=this,x=C.rowData,E=g.trim(C.value),q=C.column,B=q.dataIndx,A=this.options.validation,p=q.validations;if(p&&p.length>0){for(var F=0;F<p.length;F++){var D=p[F],D=g.extend({},A,D),r=D.type,t=D.msg,t=t?t:"&nbsp;",K=D.icon,o=D.cls,o=o?o:"",H="padding:3px 10px;"+D.style,z=D.css,s=true,J={valid:false,msg:t,dataIndx:B},y=D.value;if(r=="minLen"&&E.length<y){s=false}else{if(r=="maxLen"&&E.length>y){s=false}else{if(r=="gt"&&E<=y){s=false}else{if(r=="gte"&&E<y){s=false}else{if(r=="lt"&&E>=y){s=false}else{if(r=="lte"&&E>y){s=false}else{if(r=="regexp"&&(new RegExp(y)).test(E)==false){s=false}else{if(typeof r=="function"){var G={column:q,value:E,rowData:x,msg:t};if(r.call(v.element,G)==false){s=false;if(G.msg!=t){t=G.msg}}}}}}}}}}if(!s){var w=this.getRowIndx({rowData:x}).rowIndx;if(w!=null){this.goToPage({rowIndx:w});this.scrollRow({rowIndx:w});this.editCell({rowIndx:w,dataIndx:B})}var n=this.getEditCell();if(n&&n.$cell){var u=n.$cell;u.attr("title",t);try{u.tooltip("destroy")}catch(I){}u.tooltip({position:{my:"left top",at:"right top"},content:function(){var M=g(this),L=(K=="")?"":("<span class='ui-icon "+K+" pq-tooltip-icon'></span>");return L+t},open:function(M,N){if(o){N.tooltip.addClass(o)}if(H){var L=N.tooltip.attr("style");N.tooltip.attr("style",L+";"+H)}if(z){N.tooltip.css(z)}}}).tooltip("open");u.find(".pq-editor-focus").focus()}return J}}}return{valid:true}};k.isValid=function(q){var s=q.rowList,n=this.getRowData(q),v=q.dataIndx;if(v==null){var p=this.colModel;for(var r=0,u=p.length;r<u;r++){var o=p[r],t=o.hidden;if(t){continue}var v=o.dataIndx,w=n[v],x=this._isValid({rowData:n,value:w,column:o});if(!x.valid){return x}}}else{var o=this.getColumn({dataIndx:v}),w=(q.value===undefined)?n[v]:q.value,x=this._isValid({rowData:n,value:w,column:o});if(!x.valid){return x}}return{valid:true}};k.isEditableRow=function(n){var p=this.options,o=p.editable;if(o!=null){if(typeof o=="function"){var q=n.rowIndx,r=p.dataModel.data[q];return o.call(this.element,{rowData:r,rowIndx:q})}else{return o}}else{return true}};k.isEditableCell=function(n){var t=n.colIndx,o=n.dataIndx,t=(t==null)?this.getColIndx({dataIndx:o}):t,q=this.colModel[t],o=(o==null)?q.dataIndx:o,p=q.editable;if(n.checkVisible&&q.hidden){return false}if(p!=null){if(typeof p=="function"){var r=n.rowIndx,s=this.getRowData(n);return p.call(this.element,{rowIndx:r,rowData:s,column:q,dataIndx:o})}else{return p}}else{return true}};k._getRowPQData=function(n,o,p){var p=(p==null)?this.data[n]:p;return p?p[o]:null};k._setRowPQData=function(o,n,q){var q=(q==null)?this.data[o]:q;if(!q){return}for(var p in n){q[p]=n[p]}};k._onCellMouseDown=function(o){var p=this;var q=g(o.currentTarget);var n=p.getCellIndices({$td:q});n.$td=q;n.dataModel=p.options.dataModel;if(p._trigger("cellMouseDown",o,n)==false){return false}return true};k._onCellMouseMove=function(o){var p=this;var q=g(o.currentTarget);var n=p.getCellIndices({$td:q});n.$td=q;n.dataModel=p.options.dataModel;if(p._trigger("cellMouseMove",o,n)==false){return false}return true};k._onCellMouseUp=function(o){var p=this;var q=g(o.currentTarget);var n=p.getCellIndices({$td:q});n.$td=q;n.dataModel=p.options.dataModel;if(p._trigger("cellMouseUp",o,n)==false){return false}return true};k._onClickCell=function(z){var t=this,w=this.options,q=this.colModel,C=w.selectionModel;var s=g(z.currentTarget);var o=t.getCellIndices({$td:s});var n=o.rowIndxPage,r=t.rowIndxOffset,u=n+r,B=o.colIndx;o.rowIndx=u;if(B==null){return}var p=q[B],x=p.dataIndx;o.dataIndx=x;o.evt=z;if(t._trigger("cellClick",z,{$td:s,rowIndxPage:n,rowIndx:u,colIndx:B,dataIndx:x,column:p,dataModel:w.dataModel})==false){return false}if(t.$td_edit){t.quitEditMode(z)}if(t.options.editModel.clicksToEdit==1&&this.isEditableRow({rowIndx:u})&&this.isEditableCell({colIndx:B,rowIndx:u})){t._setSelection(null);if(C.type=="cell"){t._setSelection(o)}else{t.scrollRow({rowIndxPage:n});s=t._bringCellToView({rowIndxPage:n,colIndx:B})}window.setTimeout(function(){t.editCell(o)},0);return}else{if(C.type=="cell"){var H=t.iCells.getLastSelection();if(H){if(z.ctrlKey&&C.mode!="single"){if(t.iCells.isSelected(o)){t.iCells.remove(o)}else{t._setSelection(o)}}else{if(z.shiftKey&&C.mode!="single"){var F=H,v=F.rowIndx,A=t.getColIndx({dataIndx:F.dataIndx}),y=v,E=u,D=A,G=B;if(v>u){y=u;E=v}if(t.options.selectionModel.mode=="range"){if(v>u){D=B;G=A}if(u==v&&B<A){D=B;G=A}t._rangeSelect(y,D,E,G,z)}else{if(t.options.selectionModel.mode=="block"){if(A>B){D=B;G=A}t._blockSelect(y,D,E,G,z)}}t._setSelection(o)}else{t.iCells.removeAll({raiseEvent:true});t._setSelection(o)}}}else{if(H===false){t.iCells.removeAll({raiseEvent:true});t._setSelection(o)}else{t._setSelection(o)}}}}};k._onRightClickCell=function(v){var o=g(v.currentTarget);var y=this.getCellIndices({$td:o});var n=y.rowIndxPage,s=this.rowIndxOffset,t=n+s,p=y.colIndx,r=this.colModel,x=this.options,w=x.DM;if(p==null){return}var q=r[p],u=q.dataIndx;if(this._trigger("cellRightClick",v,{$td:o,rowIndxPage:n,rowIndx:t,colIndx:p,dataIndx:u,column:q,dataModel:w})==false){return false}};k.highlightCell=function(n){n.addClass("pq-grid-cell-hover ui-state-hover")};k.unHighlightCell=function(n){n.removeClass("pq-grid-cell-hover ui-state-hover")};k.highlightRow=function(o){if(isNaN(o)){}else{var n=this.getRow({rowIndxPage:o});if(n){n.addClass("pq-grid-row-hover ui-state-hover")}}};k.unHighlightRow=function(o){if(isNaN(o)){}else{var n=this.getRow({rowIndxPage:o});if(n){n.removeClass("pq-grid-row-hover ui-state-hover")}}};k._createSelectedRowsObject=function(){this.iRows=new l(this)};k._createSelectedCellsObject=function(){this.iCells=new c(this)};k._getCreateEventData=function(){return{dataModel:this.options.dataModel,data:this.data,colModel:this.options.colModel}};k._refreshOptions=function(){this._refreshDataOptions()};k._refreshDataOptions=function(){};k.enableSelection=function(){this.$cont_o.enableSelection()};k.disableSelection=function(){this.$cont_o.disableSelection()};k._isEditCell=function(p){var n=g(p.target);var o=n.closest("div.pq-cell-selected-border-edit");if(o&&o.length>0){return true}return false};k._findCellFromEvt=function(o){var n=g(o.target);var q=n.closest(".pq-grid-cell");if(q==null||q.length==0){return{rowIndxPage:null,colIndx:null,$td:null}}else{var p=this.getCellIndices({$td:q});p.$td=q;return p}};k._initPager=function(){var n=this.options.dataModel;var o=this;var p={rPP:n.rPP,rPPOptions:n.rPPOptions,change:function(q,s){var r=o.options.dataModel;if(s.curPage!=undefined){r.prevPage=r.curPage;r.curPage=s.curPage}if(s.rPP!=undefined){r.rPP=s.rPP}if(r.paging=="remote"){o.remoteRequest()}else{o.$td_edit=null;o.refreshDataFromDataModel();o._refresh()}},refresh:function(q){o.refreshDataAndView()}};if(n.paging){this.$footer.pqPager(p)}else{}};k._initDataNotUsed=function(){var o=this;var n=this.options.dataModel;if(n==undefined){throw ("dataModel not found.")}this._initPager();if(n.location=="remote"){var o=this;this.generateLoading();this.remoteRequest()}else{this.refreshDataFromDataModel()}};k._refreshHideArrHS=function(){var s=this,o=this.colModel,q=s.hidearrHS,r=s.initH,u=s.finalH,t=parseInt(this.options.freezeCols);for(var p=0;p<t;p++){q[p]=false}for(var p=t;p<r;p++){q[p]=true}for(var p=r;p<=u;p++){q[p]=false}for(var p=u+1,n=o.length;p<n;p++){q[p]=true}};k.generateLoading=function(){if(this.$loading){this.$loading.remove()}this.$loading=g("<div class='pq-loading'></div>").appendTo(this.element);g(["<div class='pq-loading-bg'></div><div class='pq-loading-mask ui-state-highlight'><div>",this.options.strLoading,"...</div></div>"].join("")).appendTo(this.$loading);this.$loading.find("div.pq-loading-bg").css("opacity",0.2)};k.showLoading=function(){if(this.showLoadingCounter==null){this.showLoadingCounter=0}this.showLoadingCounter++;this.element.find("div.pq-loading").show()};k.hideLoading=function(){if(this.showLoadingCounter>0){this.showLoadingCounter--}if(!this.showLoadingCounter){this.element.find("div.pq-loading").hide()}};k.refreshDataFromDataModel=function(){var q=this.options,p=q.dataModel,r=p.data,o=p.paging;this.rowIndxOffset=0;if(r==null||r.length==0){if(o){p.curPage=0;p.totalPages=0;p.totalRecords=0}this.data=r;return}if(o&&o=="local"){p.totalRecords=r.length;p.totalPages=Math.ceil(r.length/p.rPP);if(p.curPage>p.totalPages){p.curPage=p.totalPages}if(p.curPage<1&&p.totalPages>0){p.curPage=1}var s=(p.curPage-1)*p.rPP;var n=p.curPage*p.rPP;if(n>r.length){n=r.length}this.data=r.slice(s,n)}else{if(o=="remote"){p.totalPages=Math.ceil(p.totalRecords/p.rPP);var n=p.rPP;if(n>r.length){n=r.length}this.data=r.slice(0,n)}else{this.data=r}}if(o=="local"||o=="remote"){this.rowIndxOffset=(p.rPP*(p.curPage-1))}};g.paramquery.filter=function(){var n={begin:{text:"Begins With",TR:true},contain:{text:"Contains",TR:true},notcontain:{text:"Does not contain",TR:true},equal:{text:"Equal To",TR:true},notequal:{text:"Not Equal To",TR:true},empty:{text:"Empty",TR:false},notempty:{text:"Not Empty",TR:false},end:{text:"Ends With",TR:true},less:{text:"Less Than",TR:true},great:{text:"Great Than",TR:true}};return{conditions:n,getConditions:(function(){var o=[];for(var p in n){o.push(p)}return o})(),getTRConditions:(function(){var o=[];for(var p in n){if(n[p].TR){o.push(p)}}return o})(),getWTRConditions:(function(){var o=[];for(var p in n){if(!n[p].TR){o.push(p)}}return o})()}}();k.getQueryStringSort=function(){var q=this.sorters,t="",r=this.options.sql;if(r){for(var p=0;p<q.length;p++){var s=q[p],o=s.dataIndx,n=s.dir=="up"?"asc":"desc";t+=(p>0?", ":"")+o+" "+n}return t}else{if(q.length){return JSON.stringify(q)}else{return""}}};k.getQueryStringCRUD=function(){return""};k.getQueryStringFilter=function(){var w=this.options,z=w.sql?true:false,r=w.filterModel,n=r.mode,p=this.getFilterData(),x=g.paramquery.filter.getTRConditions,o="";if(r&&r.on&&p){if(z){o=[];for(var s=0;s<p.length;s++){var u=p[s],q=u.condition,v=u.dataIndx,y=g.trim(u.value);if(q==="contain"){o.push(v+" like '%"+y+"%'")}else{if(q==="notcontain"){o.push(v+" not like '%"+y+"%'")}else{if(q==="begin"){o.push(v+" like '"+y+"%'")}else{if(q==="end"){o.push(v+" like '%"+y+"'")}else{if(q==="equal"){o.push(v+"='"+y+"'")}else{if(q==="notequal"){o.push(v+"!='"+y+"'")}else{if(q==="empty"){o.push("isnull("+v+",'')=''")}else{if(q==="notempty"){o.push("isnull("+v+",'')!=''")}else{if(q==="less"){o.push(v+"<'"+y+"'")}else{if(q==="great"){o.push(v+">'"+y+"'")}}}}}}}}}}}o=o.join(" "+n+" ")}else{if(p.length){var t={mode:n,data:p};o=JSON.stringify(t)}else{o=""}}}return o};k.remoteRequest=function(A){if(this.loading){this.xhr.abort()}var u=this,n="",p="",v=this.options,C=this.colModel,B=v.dataModel;if(typeof B.getUrl=="function"){var x={colModel:C,dataModel:B,groupModel:v.groupModel,filterModel:v.filterModel};var s=B.getUrl.call(this.element,x);if(s&&s.url){n=s.url}if(s&&s.data){p=s.data}}else{if(typeof B.url=="string"){n=B.url;var w={},z={},q={};if(B.sorting=="remote"){var y=this.getQueryStringSort();if(y){w={pq_sort:y}}}if(B.paging=="remote"){q={pq_curpage:B.curPage,pq_rpp:B.rPP}}var r=this.getQueryStringFilter();if(r){z={pq_filter:r}}var o=B.postData,t=B.postDataOnce;if(o&&typeof o=="function"){o=o.call(this.element,{colModel:C,dataModel:B})}p=g.extend({pq_datatype:B.dataType},z,q,w,o,t)}}if(!n){return}this.loading=true;this.showLoading();this.xhr=g.ajax({url:n,dataType:B.dataType,async:true,cache:B.cache,type:B.method,data:p,beforeSend:function(E,D){if(typeof B.beforeSend=="function"){return B.beforeSend(E,D)}},success:function(D,H,F){var E=false;if(typeof B.getData=="function"){var G=B.getData(D,H,F);B.data=G.data;if(B.paging){if(B.paging=="remote"){if(G.curPage){B.curPage=G.curPage}if(G.totalRecords){B.totalRecords=G.totalRecords}}}if(B.sorting=="local"&&u.sorters&&u.sorters.length>0){u._refreshSortingDataAndView({sorting:true})}else{u._onDataAvailable();u.refreshDataFromDataModel();u._refreshViewAfterDataSort()}}else{throw ("getData callback not found!")}u.hideLoading();u.loading=false;u._trigger("load",null,{dataModel:u.options.dataModel,colModel:C,data:u.data});if(typeof A=="function"){A()}},error:function(D,F,E){u.hideLoading();u.loading=false;if(typeof B.error=="function"){B.error(D,F,E)}else{if(E!="abort"){throw ("Error : "+E)}}}})};k._fixFireFoxContentEditableIssue=function(){if(window.postMessage){this.$grid_inner.focus()}};k.selectCellRowCallback=function(n){var o=this;n.call(o);if(this.options.flexHeight){this.setGridHeightFromTable()}if(this.options.flexWidth){this._setGridWidthFromTable()}};k._refreshTitle=function(){this.$title.html(this.options.title)};k._refreshDraggable=function(){if(this.options.draggable){this.$title.addClass("draggable");this.element.draggable({handle:this.$title,start:function(n,o){}})}else{this._destroyDraggable()}};k._refreshResizable=function(){var n=this;if(this.options.resizable){this.element.resizable({helper:"ui-state-highlight",delay:0,start:function(o,p){g(p.helper).css({opacity:0.5,background:"#ccc",border:"1px solid steelblue"})},resize:function(o,p){},stop:function(o,p){n.options.height=n.element.height();n.options.width=n.element.width();n._refresh();n.element.css("position","relative")}})}else{this._destroyResizable()}};k.refresh=function(n){if(n&&n.header===false){this.refreshHeaderView=false}this._refresh();this.refreshHeaderView=null};k._refreshDataIndices=function(){if(this.options.getDataIndicesFromColIndices==false){return}var n=this.colModel,q=n.length;for(var o=0;o<q;o++){var p=n[o];if(p.dataIndx==null){p.dataIndx=o}}};k.refreshView=function(){if(this.$td_edit!=null){this.quitEditMode()}this.refreshDataFromDataModel();this._refresh()};k._refresh=function(){var n=this;this._refreshDataIndices();this._refreshResizable();this._refreshDraggable();this._refreshWidths();this._computeOuterWidths(true);this._setScrollHNumEles();this._bufferObj_calcInitFinalH();this._refreshHideArrHS();if(this.refreshHeaderView!==false){this._createHeader()}else{this.refreshHeaderView=null}this._refreshHeaderSortIcons();this._setInnerGridHeight();this._setRightGridHeight();this.selectCellRowCallback(function(){n.iGenerateView.generateView();n._computeOuterWidths()});this._setScrollHLength();this._setScrollVLength(this.data);this._setScrollVNumEles(true);this._setScrollHLength();this._setScrollHVLength();this._refreshPager();this._refreshFreezeLine();this.options.dataModel.postDataOnce=undefined};k._setScrollHVLength=function(){if(this.$hscroll.is(":hidden")){this.$hvscroll.css("visibility","hidden")}};k._refreshPager=function(){var n=this.options.dataModel;if(n.paging){this.$footer.pqPager("option",{currentPage:n.curPage,totalPages:n.totalPages,totalRecords:n.totalRecords,rPP:n.rPP,rPPOptions:n.rPPOptions})}};k._refreshViewAfterDataSort=function(){this._refresh()};k.refreshSortingDataAndView=function(){this._refreshSortingDataAndView({sorting:true})};k._addRowsData=function(t){var s=t.data,r=this.options.dataModel.data,p=t.rowIndx;if(r==null){r=[]}if(p==null){for(var o=0,n=s.length;o<n;o++){var q=s[o];r.push(q)}}else{if(p<r.length){for(var o=0,n=s.length;o<n;o++){var q=s[o];r.splice(p,0,q);p++}}else{return false}}return true};k.addRows=function(n){if(this._addRowsData(n)){this.refreshDataFromDataModel();this.refresh();return true}else{return false}};k.appendRow=function(){var p=this.colModel,v=this.options.dataModel,n=v.paging,s=v.data,q,r=(this.getDataType()=="JSON")?{}:[];for(var t=0;t<p.length;t++){var o=p[t];r[o.dataIndx]=""}var u=[r];this.addRows({data:u});q=s.length-1;this.goToPage({rowIndx:q});this.editFirstCellInRow({rowIndx:q})};k.refreshDataAndView=function(p){var n=this.options.dataModel,o=(p&&p.keepSelection!=null)?p.keepSelection:true;if(p&&p.header===false){this.refreshHeaderView=false}this._refreshSorters();if(n.location=="remote"){this.remoteRequest()}else{this._refreshSortingDataAndView({keepSelection:o,sorting:true})}};k.getColIndx=function(r){var p=r.dataIndx;if(p===undefined){throw ("dataIndx NA")}var o=this.colModel;for(var q=0,n=o.length;q<n;q++){if(o[q].dataIndx==p){return q}}};k.getColumn=function(s){if(s.dataIndx===undefined){throw ("dataIndx N/A")}var p=s.dataIndx;var o=this.colModel;for(var q=0,n=o.length;q<n;q++){var r=o[q];if(r.dataIndx==p){return r}}return null};k._refreshSortingDataAndView=function(t){var s=t.sorting,q=t.fn,p=t.keepSelection,o=this.options.dataModel;var n=o.sortDir;var r=this;if(s==true){if(o.sorting=="remote"){this.remoteRequest(q)}else{this._onDataAvailable();if(r.$td_edit!=null){r.quitEditMode()}this._sortLocalData(o.data);this.refreshDataFromDataModel();r._refreshViewAfterDataSort();if(typeof q=="function"){q()}}}else{if(o.location=="remote"){this.remoteRequest(q)}else{if(this.data==null){this.refreshDataFromDataModel()}r._refreshViewAfterDataSort();if(typeof q=="function"){q()}}}};k._onDataAvailable=function(){};k._computeOuterWidths=function(p){var s=this.options,r=s.columnBorders,o=s.numberCell,n=this.colModel,u=n.length;for(var q=0;q<u;q++){var t=n[q];this.outerWidths[q]=parseInt(t.width)+((r)?1:0)}if(o.show){this.numberCell_outerWidth=o.width+1}return};k._setOption=function(o,p){if(o=="height"){this.element.height(p);this._super.call(this,o,p)}else{if(o=="width"){this.element.width(p);this._super.call(this,o,p)}else{if(o=="title"){this._super.call(this,o,p);this._refreshTitle()}else{if(o=="roundCorners"){if(p){this.element.addClass("ui-corner-all");this.$top.addClass("ui-corner-top");this.$bottom.addClass("ui-corner-bottom")}else{this.element.removeClass("ui-corner-all");this.$top.removeClass("ui-corner-top");this.$bottom.removeClass("ui-corner-bottom")}}else{if(o=="freezeCols"){if(!isNaN(p)&&p>=0&&parseInt(p)<=this.colModel.length-2){this.options.freezeCols=parseInt(p);this._refreshFreezeLine();this._setScrollHLength();this._super.call(this,o,p)}}else{if(o=="resizable"){this._super.call(this,o,p)}else{if(o=="scrollModel"){var q=p;for(var o in q){this.options.scrollModel[o]=q[o]}}else{if(o=="dataModel"){this._super.call(this,o,p);var n=p.paging;if(this.$footer.hasClass("pq-pager")==false&&(n=="local"||n=="remote")){this._initPager()}else{if(this.$footer.hasClass("pq-pager")&&(n!="local"&&n!="remote")){this.$footer.pqPager("destroy");this.$footer.html("&nbsp;")}}}else{if(o==="selectionModel"){var q=p;for(var o in q){this.options.selectionModel[o]=q[o]}}else{if(o==="colModel"){this._super.call(this,o,p);this._calcThisColModel();this._refresh()}else{if(o==="disabled"){if(p===true){this._disable()}else{this._enable()}}else{if(o==="numberCell"){this._super.call(this,o,p)}else{if(o==="customData"){this._super.call(this,o,p)}else{if(o==="strLoading"){this._super.call(this,o,p);this.generateLoading()}else{if(o==="showTop"){if(p===true){this.$top.css("display","")}else{this.$top.css("display","none")}}else{if(o==="showTitle"){if(p===true){this.$title.css("display","")}else{this.$title.css("display","none")}}else{if(o==="showToolbar"){if(p===true){this.$toolbar.css("display","")}else{this.$toolbar.css("display","none")}}else{if(o==="collapsible"){if(p===true){this.$collapsible.css("display","")}else{this.$collapsible.css("display","none")}}else{if(o==="showBottom"){if(p===true){this.$bottom.css("display","")}else{this.$bottom.css("display","none")}}else{this._super.call(this,o,p)}}}}}}}}}}}}}}}}}}}};k._setOptions=function(){this._super.apply(this,arguments)};k._generateCellRowOutline=function(v){var r=v.$td,D=v.$tr,B=v.rowIndxStart,z=this.options.editModel.cellBorderWidth,A=v.colIndxStart,y=v.rowIndxEnd,x=v.colIndxEnd,s=this;if(D){var t=s._calcRightEdgeCol(s.colModel.length-1);t-=4;var C=D[0].offsetHeight-4;var u=g(D[0].offsetParent);var n=u[0].offsetParent;var E=D[0].offsetLeft+u[0].offsetLeft;var w=D[0].offsetTop+u[0].offsetTop;s._generateCellHighlighter(n,E,w,t,C)}else{if(r){var u=g(r[0].offsetParent);var n=u[0].offsetParent;var t=r[0].offsetWidth-(z?(z*2):1);var C=r[0].offsetHeight-(z?(z*2):1);var E=r[0].offsetLeft+u[0].offsetLeft;var w=r[0].offsetTop+u[0].offsetTop;s._generateCellHighlighter(n,E,w,t,C)}else{if(B!=null){throw ("checking whether used");var u=this.$tbl;var n=this.$cont;var C=0,t=0;if(B<this.init){B=this.init}if(y>this["final"]){y=this["final"]}if(B>y){return}var o=this.getCell({rowIndxPage:B,colIndx:A});var q=this.getCell({rowIndxPage:y,colIndx:x});var E=o[0].offsetLeft+u[0].offsetLeft;var w=o[0].offsetTop+u[0].offsetTop;var t=q[0].offsetLeft+q[0].offsetWidth-o[0].offsetLeft-4;var C=q[0].offsetTop+q[0].offsetHeight-o[0].offsetTop-4;var p=1;s._generateCellHighlighter(n,E,w,t,C,p)}}}};k._removeCellRowOutline=function(){if(this.$div_focus){this._fixFireFoxContentEditableIssue();this.$div_focus.remove();this.$div_focus=null}};k._generateCellHighlighter=function(q,r,t,o,n){var p=this.options.editModel.cellBorderWidth,s=this.$div_focus;if(s&&s[0].offsetParent==q){if(this.$td_edit!=null){this._fixFireFoxContentEditableIssue();s.empty().removeClass("pq-cell-selected-border-edit");this.$td_edit=null}s.css({left:r,top:t,height:n,width:o,borderWidth:cBW})}else{if(s){s.remove()}this.$div_focus=g("<div class='pq-cell-selected-border'></div>").appendTo(q);this.$div_focus.css({left:r,top:t,height:n,width:o,borderWidth:p})}};k._onHeaderCellClick=function(t){var s=this,r=s.colModel[t],q=this.options,p=q.dataModel,o=r.dataIndx,n=r.dataType;if(s._trigger("headerCellClick",null,{dataModel:p,data:s.data,sortIndx:o})==false){return}if(!q.sortable){return}if(r.sortable==false){return}if(s._trigger("beforeSort",null,{dataModel:p,column:r,dataIndx:o})==false){return}this._refreshSorters(o);s._refreshSortingDataAndView({sorting:true,keepSelection:true,fn:function(){s._trigger("sort",null,{dataModel:p,colIndx:t,dataIndx:o})}})};k._refreshSorters=function(o){var n=this.options.dataModel,p=[];if(o!=null){if(n.sortIndx==o){n.sortDir=(n.sortDir=="up")?"down":"up"}else{n.sortIndx=o;n.sortDir="up"}p=[{dataIndx:o,dir:n.sortDir}]}else{if(n.sortIndx!=null){p=[{dataIndx:n.sortIndx,dir:n.sortDir}]}}this.sorters=p};k._selectRow=function(o,n){this.selectRow(o,n)};k._findfirstUnhiddenColIndx=function(){for(var n=0;n<this.colModel.length;n++){if(!this.colModel[n].hidden){return n}}};k.selectRow=function(p){var o=p.rowIndx,n=p.evt,q=p.offset;if(n&&(n.type=="keydown"||n.type=="keypress")){if(this.iRows.replace(p)==false){return false}}else{if(this.iRows.add(p)==false){return false}}if(n!=null){this._setGridFocus()}return true};k.scrollY=function(n){this.$vscroll.pqScrollBar("option","cur_pos",n).pqScrollBar("scroll")};k._get$Tbl=function(n,o){return this.$tbl};k.scrollRow=function(v){var o=v.rowIndxPage,r=v.rowIndx,o=(o==null)?(r-this.rowIndxOffset):o,t=this.options,u=parseInt(t.freezeRows);if(o<u){return}var x=this._calcCurPosFromRowIndxPage(o);if(x==null){return}if(x<this.scrollCurPos){this.$vscroll.pqScrollBar("option","cur_pos",x).pqScrollBar("scroll")}var z=this._get$Tbl(o);var D=z.find("tr[pq-row-indx="+o+"]");if(D[0]==undefined){this.$vscroll.pqScrollBar("option","cur_pos",x).pqScrollBar("scroll")}else{var s=D[0].offsetTop+D[0].offsetHeight,A=this.$cont[0].offsetHeight,p=parseInt(z.css("marginTop")),w=this._getScollBarHorizontalHeight();if(s>A-w-p){var y=s-(A-w);var B=z.children().children("tr");var C=0,E=0;B.each(function(F,G){C+=G.offsetHeight;if(C>=y){E=F;return false}});var q=this.scrollCurPos+E;var n=this.$vscroll.pqScrollBar("option","num_eles");if(n<q+1){n=q+1}this.$vscroll.pqScrollBar("option",{num_eles:n,cur_pos:q}).pqScrollBar("scroll")}}};k._bringCellToView=function(D){if(D.rowIndxPage==null||D.colIndx==null){throw"rowIndxPage/colIndx NA"}var o=D.rowIndxPage,s=D.colIndx,t=false,A=this.options.freezeCols;var q;if(this.hidearrHS[s]){this.hidearrHS[s]=false;var z=s-A-this._calcNumHiddenUnFrozens(s);this.$hscroll.pqScrollBar("option","cur_pos",z).pqScrollBar("scroll");t=true}else{var q=this.getCell(D);if(q==null||q.length==0){return false}var v=this._calcRightEdgeCol(s).width;var C=this._getScollBarVerticalWidth();if(v>this.$cont[0].offsetWidth-C){var B=i.call(this,-1,s+1)-(this.$cont[0].offsetWidth-C);var n=q.parent("tr").children("td");var u=this.colModel,y=this.outerWidths,p=u.length;var r=0,x=0;for(var w=A;w<p;w++){if(!u[w].hidden){r+=y[w]}if(w==s){x=w-A-this._calcNumHiddenUnFrozens(w);break}else{if(r>=B){x=w-A-this._calcNumHiddenUnFrozens(w)+1;break}}}this.$hscroll.pqScrollBar("option","cur_pos",x).pqScrollBar("scroll");t=true}}if(t){var q=this.getCell({rowIndxPage:o,colIndx:s});return q}else{return q}};k.scrollColumn=function(t){var p=(t.colIndx==null)?getColIndx({dataIndx:t.dataIndx}):t.colIndx,w=this.options.freezeCols,q=false;if(this.hidearrHS[p]){this.hidearrHS[p]=false;var v=p-w-this._calcNumHiddenUnFrozens(p);this.$hscroll.pqScrollBar("option","cur_pos",v).pqScrollBar("scroll");q=true}else{var r=this._calcRightEdgeCol(p).width;var y=this._getScollBarVerticalWidth();if(r>this.$cont[0].offsetWidth-y){var x=i.call(this,-1,p+1)-(this.$cont[0].offsetWidth-y);var n=this.colModel.length;var o=0,u=0;for(var s=w;s<n;s++){if(!this.colModel[s].hidden){o+=this.outerWidths[s]}if(s==p){u=s-w-this._calcNumHiddenUnFrozens(s);break}else{if(o>=x){u=s-w-this._calcNumHiddenUnFrozens(s)+1;break}}}this.$hscroll.pqScrollBar("option","cur_pos",u).pqScrollBar("scroll");q=true}}};k.selection=function(q){var o=q.rowIndx,p=q.colIndx,r=q.method,n=q.type;if(n=="row"){return this["iRows"][r](q)}else{if(n=="cell"){return this["iCells"][r](q)}}return};k.setSelection=function(n){if(n==null||n.rowIndx==null){this.iRows.removeAll({raiseEvent:true});this.iCells.removeAll({raiseEvent:true})}else{this._bringPageIntoView(n);return this._setSelection(n)}};k._bringPageIntoView=function(u){var s=u.rowIndx,r=this;var o=this.options.dataModel;if(o.paging=="local"&&s>=0){var q=o.curPage;var t=o.rPP;var p=(q-1)*t;var n=q*t;if(s>=p&&s<n){}else{o.curPage=Math.ceil((s+1)/t);this.refreshDataFromDataModel();this._refreshViewAfterDataSort()}}};k.goToPage=function(s){var n=this.options.dataModel;if(n.paging=="local"||n.paging=="remote"){var p=s.rowIndx,r=n.rPP,q=(s.page==null)?Math.ceil((p+1)/r):s.page,o=n.curPage;if(q!=o){n.curPage=q;if(n.paging=="local"){this.refreshDataFromDataModel();this._refresh()}else{this.refreshDataAndView()}}}};k._setSelection=function(s){if(s==null){this.iRows.removeAll({raiseEvent:true});this.iCells.removeAll({raiseEvent:true});return false}var q=this.data;var t=this.rowIndxOffset,p=(s.rowIndx==null)?s.rowIndxPage+t:s.rowIndx,n=(s.rowIndxPage==null)?s.rowIndx-t:s.rowIndxPage,r=(s.colIndx==null&&s.dataIndx!==undefined)?this.getColIndx({dataIndx:s.dataIndx}):s.colIndx,o=s.evt;s.rowIndx=p;s.rowIndxPage=n;if(n<0||r<0){return false}if(q==null||q.length==0){return false}if(n>=q.length||r>=this.colModel.length){return false}this.scrollRow({rowIndxPage:n});if(r==null){return this.selectRow({rowIndx:p,evt:o})}else{this._bringCellToView({rowIndxPage:n,colIndx:r});return this.selectCell({rowIndx:p,colIndx:r,evt:o})}};k.getColModel=function(){return this.colModel};k.saveEditCell=function(){if(this.$td_edit==null){return}var o=this.$td_edit,w=this.getCellIndices({$td:o}),u=this.getRowIndxOffset(),q=w.colIndx,n=w.rowIndxPage,v=n+u,C=this.colModel,s=C[q],y=s.dataIndx,r=this.data[n],B=this.options,A=B.dataModel,z;if(r==null){return}else{z=r[y]}w.rowIndx=v;w.column=s;w.dataIndx=y;if(n!=null){var p=this._getEditCellData(w);if(p=="<br>"){p=""}if(z==null&&p==""){p=null}var t={rowIndx:v,dataIndx:y,column:s,newVal:p,value:p,oldVal:z,rowData:r,dataModel:A};if(this._trigger("cellBeforeSave",null,t)===false){return false}if(p!=z){r[y]=p;this._trigger("cellSave",null,t);if(B.track){this.iUCData.update({rowIndx:v,dataIndx:y,oldVal:z,newVal:p})}this.refreshCell(w);this._fixTableViewPort();var x=this;if(B.flexHeight){x.setGridHeightFromTable();x._fixIEFooterIssue()}else{x.scrollRow({rowIndxPage:n})}}return true}};k._fixTableViewPort=function(){var n=this.$cont[0];n.scrollTop=0;n.scrollLeft=0};k._fixIEFooterIssue=function(){g(".pq-grid-footer").css({position:"absolute"});g(".pq-grid-footer").css({position:"relative"})};k.refreshColumn=function(q){var t=this.options.customData,p=(q.colIndx==null)?this.getColIndx({dataIndx:q.dataIndx}):q.colIndx,s=this.getRowIndxOffset();q.colIndx=p;for(var r=this.init;r<=this["final"];r++){var n=r;q.rowIndx=n+s;q.rowIndxPage=n;var o=this.colModel[p];q.$td=this.getCell(q);q.rowData=this.data[n];q.customData=t;q.column=o;this.iGenerateView._renderCell(q)}};k.refreshCell=function(v){if(!this.data){return}var t=this.rowIndxOffset,u=v.rowIndx=(v.rowIndx==null)?v.rowIndxPage+t:v.rowIndx,n=v.rowIndxPage=(v.rowIndxPage==null)?v.rowIndx-t:v.rowIndxPage,w=v.dataIndx,p=v.colIndx=(v.colIndx==null)?this.getColIndx({dataIndx:w}):v.colIndx,o=v.$td=(v.$td==null)?this.getCell(v):v.$td,r=v.column=this.colModel[p],q=this.data[n];if(!q){return}var s=v;s.rowData=q;s.customData=this.options.customData;if(o&&o.length>0){this.iGenerateView._renderCell(s)}};k.refreshRow=function(u){if(!this.data){return}var v=this.options,r=this.rowIndxOffset,t=u.rowIndx=(u.rowIndx==null)?u.rowIndxPage+r:u.rowIndx,n=u.rowIndxPage=(u.rowIndxPage==null)?u.rowIndx-r:u.rowIndxPage,s=(u.$tr==null)?this.getRow(u):u.$tr,p=this.colModel,o=this.data[n];if(!o){return}var q=[];this.iGenerateView._generateRow(o,n,p,q,null);var w=q.join("");s.replaceWith(w);this._trigger("refresh",null,{type:"row",dataModel:v.dataModel,colModel:p,rowData:o,rowIndx:t,rowIndxPage:n});return};k.quitEditMode=function(n){if(this.$td_edit){var t=this.$td_edit,q,s,p,o;this.disableSelection();var r=this.getCellIndices({$td:t});if(r&&r.rowIndx!=null){q=r.rowIndx;s=r.colIndx;p=this.colModel[s];o=p.dataIndx}else{this.$td_edit=null;return}this._setGridFocus();this._trigger("quitEditMode",n,{$td:t,rowIndx:q,column:p,dataIndx:o,dataModel:this.options.dataModel});this._removeCellRowOutline();this.$td_edit=null}};k.getData=function(){return this.data};k.getViewPortRowsIndx=function(){return{beginIndx:this.init,endIndx:this["final"]}};k.getRowIndxOffset=function(){return this.rowIndxOffset};k.selectCell=function(q){var o=q.rowIndx,p=q.colIndx,n=q.evt;if(n&&(n.type=="keydown"||n.type=="keypress")){if(this.iCells.replace(q)==false){return false}}else{if(this.iCells.add(q)==false){return false}}if(n!=null){this._setGridFocus()}return true};k._setGridFocus=function(){var n=this;window.setTimeout(function(){if(n.$td_edit==null){n.$grid_inner.focus()}},0)};k.getEditCell=function(){if(this.$td_edit){return{$td:this.$td_edit,$cell:this.$div_focus}}else{return null}};k.editCell=function(n){var o=this.getCell(n);if(o!=null&&o.length>0){if(this.$td_edit&&this.$td_edit[0]!=o[0]){this.quitEditMode()}this._editCell(o);return o}};k.getFirstEditableColIndx=function(n){if(n.rowIndx==null){throw"rowIndx NA"}if(!this.isEditableRow(n)){return -1}var o=this.colModel;for(var p=0;p<o.length;p++){n.colIndx=p;if(!this.isEditableCell(n)){continue}else{if(o[p].hidden){continue}}return p}return -1};k.editFirstCellInRow=function(o){var s=this.rowIndxOffset,p=o.rowIndx,n=o.rowIndxPage,p=(p==null)?(n+s):p,n=(n==null)?(p-s):n,q=this.getFirstEditableColIndx({rowIndx:p});if(q!=-1){this.scrollRow({rowIndxPage:n});var r=this._bringCellToView({colIndx:q,rowIndxPage:n});if(r&&r.length>0){this._editCell(r)}}};k._editCell=function(Y){var I=this;var o=I.getCellIndices({$td:Y});var t=o.rowIndxPage,M=this.rowIndxOffset,y=t+M,w=o.colIndx,R=this.colModel[w],v=R.editor,u=this.options.editor,n=v?g.extend({},u,v):u,T=I.data[t],L=false,J=R.dataIndx;if(this.$td_edit&&this.$td_edit[0]==Y[0]){return false}this.$td_edit=Y;this.enableSelection();this._removeCellRowOutline();this._generateCellRowOutline({$td:Y});var K=this.$div_focus.addClass("pq-cell-selected-border-edit");if(R.align=="right"){K.addClass("pq-align-right")}else{if(R.align=="center"){K.addClass("pq-align-center")}else{K.addClass("pq-align-left")}}var V=K.width()-8,Z=T[J],O;var N=n.type,B=n.select,D=n.cls?n.cls:"",q="pq-editor-focus "+D,p=q+" pq-cell-editor ",x=n.attr?n.attr:"",H=n.style,H=(H?H:""),r=H?("style='"+H+"'"):"",U="style='width:"+V+"px;"+H+"'",S=H?("style='"+H+"'"):"";if(typeof N=="function"){O=N.call(I.element,{$cell:K,cellData:Z,rowData:T,cls:q,dataIndx:J,data:n.data,column:R});K.find('*[name="'+J+'"]').val(Z)}else{if(N=="checkbox"){var E=Z?"checked='checked'":"";O="<input "+E+" class='"+p+"' "+x+" "+S+" type=checkbox name='"+J+"' />";K.html(O)}else{if(N=="textarea"||N=="select"||N=="textbox"){if(N=="textarea"){O="<textarea class='"+p+"' "+x+" "+U+" name='"+J+"' ></textarea>"}else{if(N=="select"){var C=n.options;var C=C?C:[];O=["<select class='"+p+"' "+x+" "+U+" name='"+J+"' >"];if(typeof C==="function"){C=C.call(I.element,{column:R,rowData:T})}for(var W=0,G=C.length;W<G;W++){var A=C[W];if(typeof A=="object"){for(var Q in A){O.push('<option value="'+Q+'">'+A[Q]+"</option>")}}else{O.push("<option>"+A+"</option>")}}O.push("</select>");O=O.join("")}else{O="<input class='"+p+"' "+x+" "+U+" type=text name='"+J+"' />"}}K.html(O);K.children().val(Z)}else{O="<div contenteditable='true' tabindx='0' "+r+" "+x+" class='pq-grid-editor-default "+q+"'></div>";K.html(O);K.children().html(Z);L=true}}}var I=this;if(I.$td_edit!=null){var K=I.$div_focus,z=K.children(".pq-editor-focus");z.focus();if(I._trigger("cellEditFocus",null,{$cell:K,$focus:z,dataIndx:J,column:R,rowIndx:y,rowData:T})==false){return false}if(B){if(L){try{var X=z[0];var s=document.createRange();s.selectNodeContents(X);var F=window.getSelection();F.removeAllRanges();F.addRange(s)}catch(P){}}else{z.select()}}}};k.getRow=function(s){var o=s.rowIndxPage,r=s.rowIndx,t=this.rowIndxOffset,p=this.options.dataModel;var q,u=this.$tbl;if(u!=undefined){var n=u.children("tbody");if(o!=null){q=n.children("tr[pq-row-indx="+o+"]")}else{if(r!=null){q=n.children("tr[pq-row-indx="+(r-t)+"]")}}}return q};k.getCell=function(s){var o=s.rowIndxPage,r=s.rowIndx,o=(o==null)?(r-this.rowIndxOffset):o,q=s.colIndx,t=s.dataIndx,q=(q==null)?this.getColIndx({dataIndx:t}):q,n=this.$tbl,p,v=this.options,u=v.freezeCols;if(n!=undefined){if(n.length>1){if(q>=u){n=g(n[1])}else{n=g(n[0])}}var p=n.children().children("tr[pq-row-indx="+o+"]").children("td[pq-col-indx="+q+"]")}if(p.length==0||p[0].style.visibility=="hidden"){return null}return p};k.getEditCellData=function(){if(this.$td_edit){var n=this.getCellIndices({$td:this.$td_edit});return this._getEditCellData(n)}else{return null}};k._getEditCellData=function(v){if(v.colIndx==undefined||v.rowIndxPage==undefined){throw ("colIndx, rowIndxpage N/A")}var o=v.colIndx,n=v.rowIndxPage,t=(v.rowIndx!=null)?v.rowIndx:n+this.rowIndxOffset,r=(v.column)?v.column:this.colModel[o],p=r.editor,q=this.options.editor,w=p?g.extend({},q,p):q,x=r.dataIndx,y=(v.$cell)?v.$cell:this.$div_focus,z;var u=w.getData;if(typeof u=="function"){z=w.getData({$cell:y,dataIndx:x,rowIndx:t,rowIndxPage:n,column:r})}else{var A=w.type;if(A=="checkbox"){z=y.children().is(":checked")?true:false}else{if(A=="contenteditable"){z=y.children().html()}else{var s=y.find('*[name="'+x+'"]');if(s&&s.length){z=s.val()}else{var s=y.find(".pq-editor-focus");if(s&&s.length){z=s.val()}}}}}return z};k.getCellIndices=function(o){var r=o.$td;if(r==null||r.length==0){return{rowIndxPage:null,colIndx:null}}var p=r.parent("tr");var n=p.attr("pq-row-indx");if(n==null){return{rowIndxPage:null,colIndx:null}}n=parseInt(n);var q=r.attr("pq-col-indx");if(q==null){return{rowIndxPage:n,colIndx:null}}q=parseInt(q);return{rowIndxPage:n,rowIndx:n+this.rowIndxOffset,colIndx:q,dataIndx:this.colModel[q].dataIndx}};k.getRowsByClass=function(q){var x=this.options.dataModel,n=x.paging,s=(n=="remote")?true:false,p=this.rowIndxOffset,r=x.data,w=[];if(r==null){return w}for(var t=0,u=r.length;t<u;t++){var o=r[t];q.rowData=o;if(this.hasClass(q)){var v={rowData:o};if(s){v.rowIndx=(t+p)}else{v.rowIndx=t}w.push(v)}}return w};k.addClass=function(s){var r=s.rowIndx,w=s.dataIndx,y=s.cls,q=this.rowIndxOffset,o=this.getRowData(s);if(!o){return}if(r==null){r=this.getRowIndx({rowData:o}).rowIndx}var p=y.split(" ");for(var t=0;t<p.length;t++){var A=p[t];if(w==null&&this.hasClass({rowData:o,cls:A})===false){var x=o.pq_rowcls;if(x){o.pq_rowcls=g.trim(x)+" "+A}else{o.pq_rowcls=A}if(r!=null){var u=this.getRow({rowIndxPage:(r-q)});if(u){u.addClass(A)}}}else{if(this.hasClass({rowData:o,dataIndx:w,cls:A})===false){var z=o.pq_cellcls;if(z){var v=z[w];if(v){z[w]=g.trim(v)+" "+A}else{z[w]=A}}else{var z={};z[w]=A;o.pq_cellcls=z}if(r!=null){var n=this.getCell({rowIndxPage:(r-q),dataIndx:w});if(n){n.addClass(A)}}}}}};k.removeClass=function(s){var q=s.rowIndx,p=this.getRowData(s),v=s.dataIndx,w=s.cls,n=(v!=null&&p)?p.pq_cellcls:null,t=p?p.pq_rowcls:null;if(p==null){return}if(q==null){q=this.getRowIndx({rowData:p}).rowIndx}if(v==null){if(t){p.pq_rowcls=this._removeClass(t,w)}if(q!=null){var u=this.getRow({rowIndx:q});if(u){u.removeClass(w)}}}else{if(n){var r=n[v];if(r){p.pq_cellcls[v]=this._removeClass(r,w)}if(q!=null){var o=this.getCell({rowIndx:q,dataIndx:v});if(o){o.removeClass(w)}}}}};k.hasClass=function(s){var o=s.dataIndx,n=s.cls,r=this.getRowData(s),q=new RegExp("\\b"+n+"\\b"),t;if(r){if(o==null){t=r.pq_rowcls;if(t&&q.test(t)){return true}else{return false}}else{var p=r.pq_cellcls;if(p&&p[o]&&q.test(p[o])){return true}else{return false}}}else{return null}};k._removeClass=function(w,p){if(w){var s=w.split(" "),v=p.split(" "),u=[];for(var q=0,t=s.length;q<t;q++){var x=s[q],y=false;for(var o=0,n=v.length;o<n;o++){var r=v[o];if(x===r){y=true;break}}if(!y){u.push(x)}}if(u.length>1){return u.join(" ")}else{if(u.length===1){return u[0]}else{return null}}}};k.getRowIndx=function(u){var x=u.$tr,q=u.rowData;if(q){var z=this.options.dataModel,o=z.paging,w=(o=="remote")?true:false,v=z.data,p=false;for(var t=0,y=v.length;t<y;t++){if(v[t]==q){p=true;break}}if(p){var s=this.rowIndxOffset,n=(w)?t:(t-s),r=(w)?(t+s):t;return{rowIndxPage:n,rowIndx:r}}else{return{}}}else{if(x==null||x.length==0){return{rowIndxPage:null}}var n=x.attr("pq-row-indx");if(n==null){return{rowIndxPage:null}}n=parseInt(n);return{rowIndxPage:n,rowIndx:n+this.rowIndxOffset}}};f._incrRowIndx=function(o,r){var u=this.that,s=o,r=(r==null)?1:r,p=u.data,n=0;for(var q=o+1,v=p.length;q<v;q++){var t=p[q].pq_hidden;if(!t){n++;s=q;if(n==r){return s}}}return s};f._decrRowIndx=function(n,q){var s=this.that,p=n,u=s.data,q=(q==null)?1:q,o=0;for(var r=n-1;r>=0;r--){var t=u[r].pq_hidden;if(!t){o++;p=r;if(o==q){return p}}}return p};k.addColumn=function(q,r){var p=this.options,n=p.colModel,t=p.dataModel.data;n.push(q);this._calcThisColModel();for(var o=0;o<t.length;o++){var s=t[o];s.push("")}};k.rowNextSelect=function(){var p=this.selection({type:"row",method:"getSelection"}),o,n,q=this.rowIndxOffset;if(p&&p[0]){o=p[0].rowIndx;n=o-q;n=this.iKeyNav._incrRowIndx(n)}if(n!=null){this.setSelection(null);this._setSelection({rowIndxPage:n})}return n};k.rowPrevSelect=function(){var p=this.selection({type:"row",method:"getSelection"}),o,n,q=this.rowIndxOffset;if(p&&p[0]){o=p[0].rowIndx;n=o-q;n=this.iKeyNav._decrRowIndx(n)}if(n!=null){this.setSelection(null);this._setSelection({rowIndxPage:n})}return n};f._incrIndx=function(n,s){var q=this.that,r=q._getLastVisibleRowIndxPage(q.data),o=q.colModel,t=o.length;if(s==null){if(n==r){return null}n=this._incrRowIndx(n);return{rowIndxPage:n}}var p;do{s++;if(s>=t){if(n==r){return null}n=this._incrRowIndx(n);s=0}p=o[s]}while(p&&p.hidden);return{rowIndxPage:n,colIndx:s}};f._decrIndx=function(n,s){var r=this.that,o=r.colModel,t=o.length,p=r._getFirstVisibleRowIndxPage(r.data);if(s==null){if(n==p){return null}n=this._decrRowIndx(n);return{rowIndxPage:n}}var q;do{s--;if(s<0){if(n==p){return null}n=this._decrRowIndx(n);s=t-1}q=o[s]}while(q&&q.hidden);return{rowIndxPage:n,colIndx:s}};f._incrEditIndx=function(n,q){var w=this.that,s=w.colModel,o=s.length,r,u=w.rowIndxOffset,v=w._getLastVisibleRowIndxPage(w.data);do{q++;if(q>=o){if(n==v){return null}do{n=this._incrRowIndx(n);var t=n+u,x=w.isEditableRow({rowIndx:t});if(n==v&&x==false){return null}}while(x==false);q=0}r=s[q];var t=n+u,p=w.isEditableCell({rowIndx:t,colIndx:q,checkVisible:true})}while(r&&(r.hidden||p==false));return{rowIndxPage:n,colIndx:q}};f._decrEditIndx=function(n,q){var v=this.that,s=v.colModel,o=s.length,r,u=v.rowIndxOffset,x=v._getFirstVisibleRowIndxPage(v.data);do{q--;if(q<0){if(n==x){return null}do{n=this._decrRowIndx(n);var t=n+u,w=v.isEditableRow({rowIndx:t});if(n==x&&w==false){return null}}while(w==false);q=o-1}r=s[q];var t=n+u,p=v.isEditableCell({rowIndx:t,colIndx:q,checkVisible:true})}while(r&&(r.hidden||p==false));return{rowIndxPage:n,colIndx:q}};f._incrEditRowIndx=function(n,p){var t=this.that,q=t.rowIndxOffset,s=t._getLastVisibleRowIndxPage(t.data);if(n==s){return null}do{n=this._incrRowIndx(n);var r=n+q,u=t.isEditableRow({rowIndx:r}),o=t.isEditableCell({rowIndx:r,colIndx:p}),v=(u&&o);if(n==s&&!v){return null}}while(!v);return{rowIndxPage:n,colIndx:p}};f._decrEditRowIndx=function(n,p){var s=this.that,q=s.rowIndxOffset,u=s._getFirstVisibleRowIndxPage(s.data);if(n==u){return null}do{n=this._decrRowIndx(n);var r=n+q,t=s.isEditableRow({rowIndx:r}),o=s.isEditableCell({rowIndx:r,colIndx:p}),v=(t&&o);if(n==u&&!v){return null}}while(!v);return{rowIndxPage:n,colIndx:p}};k._keyPressDown=function(n){var o=g(n.target).closest(".pq-grid-header");if(o.length>0){if(this._trigger("headerKeyDown",n,{dataModel:this.options.dataModel})==false){return false}else{return true}}else{var p=this.iKeyNav._bodyKeyPressDown(n);if(p===false){return false}if(this._trigger("keyDown",n,{dataModel:this.options.dataModel})==false){return false}}};f._saveAndMove=function(u,p){var s=this.that,q=this.options,o=q.selectionModel;if(s.saveEditCell()==false){p.preventDefault();return false}if(u==null){p.preventDefault();return false}s.quitEditMode(p);var n=u.rowIndxPage,t=u.colIndx;if(o.type=="row"){s._setSelection(null);s._setSelection({rowIndxPage:n});s._bringCellToView({rowIndxPage:n,colIndx:t})}else{if(o.type=="cell"){s._setSelection(null);s._setSelection({rowIndxPage:n,colIndx:t})}else{s.scrollRow({rowIndxPage:n});s._bringCellToView({rowIndxPage:n,colIndx:t})}}var r=s.getCell({rowIndxPage:n,colIndx:t});if(r&&r.length>0){s._editCell(r)}p.preventDefault();return false};f._bodykeyPressDownInEdit=function(B){var x=this.that,A=this.options,v=x.rowIndxOffset,y=g.ui.keyCode,t=x.colModel,C=A.dataModel,n=A.editModel,p=g(x.$td_edit[0]),w=x.getCellIndices({$td:p}),o=w.rowIndxPage,u=o+v,r=w.colIndx,s=t[r],q=s.editModel,z=q?g.extend({},n,q):n;if(x._trigger("cellEditKeyDown",B,{dataModel:C,$cell:x.$div_focus,rowIndx:u,rowIndxPage:o,colIndx:r,$td:p,dataIndx:s.dataIndx,column:s})==false){return false}if(B.keyCode==y.TAB){var w;if(B.shiftKey){w=this._decrEditIndx(o,r)}else{w=this._incrEditIndx(o,r)}return this._saveAndMove(w,B)}else{if(B.keyCode==z.saveKey){var w=this._incrEditIndx(o,r);return this._saveAndMove(w,B)}else{if(B.keyCode==y.ESCAPE){x.quitEditMode(B);B.preventDefault();return false}else{if(B.keyCode==y.PAGE_UP||B.keyCode==y.PAGE_DOWN){B.preventDefault();return false}else{if(z.keyUpDown){if(B.keyCode==y.DOWN){var w=this._incrEditRowIndx(o,r);return this._saveAndMove(w,B)}else{if(B.keyCode==y.UP){var w=this._decrEditRowIndx(o,r);return this._saveAndMove(w,B)}}}}}}}return};f.filterKeys=function(x,t){var r=this.that,q=this.options.editModel.filterKeys;var p=t.column,v=p.dataType,o=p.editModel;if(o&&o.filterKeys!=undefined){q=o.filterKeys}if(!q){return}if(v=="float"||v=="integer"){var s=g(x.originalEvent.target),u=s[0].nodeName.toLowerCase(),z=(v=="integer")?/^[\-]?[0-9]*$/:/^[\-]?[0-9]*\.?[0-9]*$/;var y=["input","textarea","select"],n="text";if(g.inArray(u,y)!=-1){n="val"}var w=s[n]();window.setTimeout(function(){var A=s[n]();if(z.test(A)==false){s[n](w)}},0)}};f._bodyKeyPressDown=function(C){var w=this.that,I=w.iCells.getLastSelectionCurPage(),F=w.iRows.getLastSelectionCurPage(),t=w.getRowIndxOffset(),y=this.options,z=y.dataModel,q=w.colModel,E=y.selectionModel,x,D;var H=g.ui.keyCode;if(w.$td_edit){return this._bodykeyPressDownInEdit(C)}else{if(F!=null&&E.type=="row"){var B=F,x=B.rowIndx,n=x-t}else{if(I!=null&&E.type=="cell"){var B=I,x=B.rowIndx,n=x-t,A=B.dataIndx,D=w.getColIndx({dataIndx:A});if(x==null||D==null){return}if(w._trigger("cellKeyDown",C,{dataModel:z,rowIndx:x,colIndx:D,dataIndx:A})==false){return false}if(C.cancelBubble){return}}else{return}}}var p=n,G=D,v=w._getFirstVisibleRowIndxPage(w.data),r=w._getLastVisibleRowIndxPage(w.data);if(C.keyCode==H.LEFT){var B=this._decrIndx(n,D);if(B){w._setSelection({rowIndxPage:B.rowIndxPage,colIndx:B.colIndx,evt:C})}C.preventDefault();return}else{if(C.keyCode==H.RIGHT){var B=this._incrIndx(n,D);if(B){w._setSelection({rowIndxPage:B.rowIndxPage,colIndx:B.colIndx,evt:C})}C.preventDefault();return}else{if(C.keyCode==H.TAB){var B;if(C.shiftKey){B=this._decrIndx(n,D)}else{B=this._incrIndx(n,D)}if(B){w._setSelection({rowIndxPage:B.rowIndxPage,colIndx:B.colIndx,evt:C})}C.preventDefault();return}else{if(C.keyCode==H.UP){n=this._decrRowIndx(n);if(B){w._setSelection({rowIndxPage:n,colIndx:D,evt:C})}C.preventDefault();return}else{if(C.keyCode==H.DOWN){n=this._incrRowIndx(n);if(B){w._setSelection({rowIndxPage:n,colIndx:D,evt:C})}C.preventDefault();return}else{if(C.keyCode==H.PAGE_DOWN||C.keyCode==H.SPACE){var x=this._incrRowIndx(n,w.pageSize+1)+t;w._setSelection({rowIndx:x,colIndx:D,evt:C});C.preventDefault();return}else{if(C.keyCode==H.PAGE_UP){var x=this._decrRowIndx(n,w.pageSize+1)+t;w._setSelection({rowIndx:x,colIndx:D,evt:C});C.preventDefault();return}else{if(C.keyCode==H.HOME){x=v+t;w._setSelection({rowIndx:x,colIndx:D,evt:C});C.preventDefault();return}else{if(C.keyCode==H.END){x=r+t;w._setSelection({rowIndx:x,colIndx:D,evt:C});C.preventDefault();return}else{if(C.keyCode==H.ENTER){if(E.type=="row"){var J,s;if(F!=null){w.editFirstCellInRow({rowIndx:n+t})}}else{if(I!=null){var s=w.getCell({rowIndxPage:n,colIndx:D});if(s&&s.length>0){var x=n+t,u=w.isEditableRow({rowIndx:x}),o=w.isEditableCell({rowIndx:x,colIndx:D});if(u&&o){w._editCell(s)}}}}C.preventDefault();return}else{}}}}}}}}}}};k._calcNumHiddenFrozens=function(){var n=0,p=this.options.freezeCols;for(var o=0;o<p;o++){if(this.colModel[o].hidden){n++}}return n};k._calcNumHiddenUnFrozens=function(r){var o=0,q=this.options.freezeCols;var n=(r!=null)?r:this.colModel.length;for(var p=q;p<n;p++){if(this.colModel[p].hidden){o++}}return o};k._setScrollHLength=function(){if(!this.options.scrollModel.horizontal){this.$hscroll.css("visibility","hidden");this.$hvscroll.css("visibility","hidden");return}else{this.$hscroll.css("visibility","");this.$hvscroll.css("visibility","")}var p=this.$cont[0].offsetWidth;var n=this.colModel;var o=this._getScollBarVerticalWidth();if(o==0){this.$hscroll.css("right",0)}else{this.$hscroll.css("right","")}p-=o;this.$hscroll.pqScrollBar("option","length",p)};k._setScrollHNumEles=function(){var o=this.options,n=o.scrollModel,p=0;if(!o.flexWidth){if(n.lastColumn=="fullScroll"){p=this.colModel.length-o.freezeCols-this._calcNumHiddenUnFrozens()}else{p=this.calcColsOutsideCont(this.colModel)+1}}this.$hscroll.pqScrollBar("option","num_eles",p)};k.calcColsOutsideCont=function(u){var w=this.options.numberCell,s=(this.$tbl)?this.$tbl[this.$tbl.length-1]:null,o=s?s.scrollWidth:0,y=this.options.freezeCols,v=this.outerWidths,x=this.$cont[0].offsetWidth-this._getScollBarVerticalWidth();o=0;if(w.show){o+=this.numberCell_outerWidth}for(var t=0;t<u.length;t++){var q=u[t];if(!q.hidden){o+=v[t]}}var p=0,n=0;var r=o;if(r>x){n++}for(t=y;t<u.length;t++){q=u[t];if(!q.hidden){p+=v[t];r=o-p;if(r>x){n++}else{break}}}return n};k._getScollBarHorizontalHeight=function(){var o=17,n=this.$hscroll;if(n.css("visibility")=="hidden"||this.options.scrollModel.horizontal==false||n.css("display")=="none"){o=0}return o};k._getScollBarVerticalWidth=function(){var o=17,n=this.$vscroll;if(n.css("visibility")=="hidden"||this.options.flexHeight||n.css("display")=="none"){o=0}return o};k._setScrollVNumEles=function(p){var s=this,t=this.$vscroll,o=t.pqScrollBar("option"),n=parseInt(o.num_eles),r=parseInt(o.cur_pos),u=this.options;var v=this._getScollBarHorizontalHeight();var w=u.groupModel;var D=(w)?this.dataGM:this.data;var A=D?this.totalVisibleRows:0;var q,x,E=0;if(this.$tbl&&this.$tbl.length>0){q=this.$tbl[this.$tbl.length-1];E=q.offsetHeight;x=g(q)}var z=this.$cont[0].offsetHeight;if(E>0&&E>z-v){var B=x.children().children("tr");var C=0,y=0;B.each(function(F,G){C+=G.offsetHeight;if(C>=z-v){y=(F>1)?(F-1):0;return false}});if(y==0){y=B.length-1}n=A-y+1}else{n=r+1}if(n>A){n=A}if(p){s.$vscroll.pqScrollBar("option","num_eles",n)}else{s.$vscroll.pqScrollBar("setNumEles",n)}return n};k._getFirstVisibleRowIndxPage=function(q){for(var o=0,n=q.length;o<n;o++){var p=q[o].pq_hidden;if(!p){return o}}};k._getLastVisibleRowIndxPage=function(p){for(var n=p.length-1;n>=0;n--){var o=p[n].pq_hidden;if(!o){return n}}return null};k._getLastVisibleColIndx=function(){var n=this.colModel,q=n.length;for(var o=q-1;o>=0;o--){var p=n[o].hidden;if(!p){return o}}return null};k.getTotalVisibleColumns=function(){var n=this.colModel,s=n.length,o=0;for(var p=0;p<s;p++){var q=n[p],r=q.hidden;if(!r){o++}}return o};k._getTotalVisibleRows=function(x,A,B,t){var u=0,n=(t)?t.length:0,z=A,r=0,p=0,q=null,y=false,o=false;if(t==null||n==0){return{init:q,_final:q,noRows:u}}for(var s=0,w=((n>A)?A:n);s<w;s++){var v=t[s].pq_hidden;if(!v){q=s;u++}}this.lastFrozenRow=q;if(n<A){return{init:q,_final:q,noRows:u}}B=B-u;for(var s=A,w=n;s<w;s++){var v=t[s].pq_hidden;if(!y){if(v){z++}else{if(p==x){y=true;r=z;p=0}else{z++;p++}}}else{if(!o){if(v){r++}else{if(p==B){o=true}else{r++;p++}}}}if(!v){u++}}if(z>=n){z=n-1}if(r<z){r=z}return{init:z,_final:r,noRows:u}};k._setScrollVLength=function(q){var p=this.$cont.height();var o=this._getScollBarHorizontalHeight();this.$vscroll.css("bottom",o);var n=(p-o);this.$vscroll.pqScrollBar("option","length",n);return};k._setInnerGridHeight=function(){var o=this.options;if(o.flexHeight){return}var n=(this.element.height()-((o.showTop)?this.$top[0].offsetHeight:0)-((o.showBottom)?this.$bottom[0].offsetHeight:0));this.$grid_inner.height(n+"px")};k._setRightGridHeight=function(){var q=this.options;var p=this.$header[0].offsetHeight;this.$header_o.height(p-2);if(q.flexHeight){return}this.$vscroll.css("visibility","");if(this.$tbl){this.$tbl.css("marginBottom",0)}var o=(this.element.height()-this.$header_o[0].offsetHeight-((q.showTop)?this.$top[0].offsetHeight:0)-((q.showBottom)?this.$bottom[0].offsetHeight:0));var n=0;this.$cont.height((o-n)+"px")};k.setGridHeightFromTable=function(){var p=0;var o=this._getScollBarHorizontalHeight(),q=this.$tbl;if(q&&q.length){p=(q[0].offsetHeight-1);q.css("marginBottom",o)}else{p=22}var n=p+o;this.$cont.height("");this.element.height("");this.$grid_inner.height("");this.$vscroll.css("visibility","hidden")};k._setGridWidthFromTable=function(){var n;var o=this._getScollBarVerticalWidth();if(this.$tbl&&this.$tbl[0]&&this.$tbl[0].scrollWidth>0){n=this.$tbl[0].scrollWidth;this.element.width((n+o)+"px")}else{n=i.call(this,-1,this.colModel.length);this.element.width((n)+"px")}};k._setRightGridWidth=function(){};k._bufferObj_getInit=function(){return this.init};k._bufferObj_getFinal=function(){return this["final"]};k._bufferObj_minRowsPerGrid=function(){var n=this.$cont[0].offsetHeight;return Math.ceil(n/this.rowHeight)};k._calcCurPosFromRowIndxPage=function(n){var v=this.options,w=v.groupModel,q=w?this.dataGM:this.data,x=v.freezeRows;var u=0,p=x;for(var r=x,t=q.length;r<t;r++){var o=q[r];if(w&&(o.groupSummary||o.groupTitle)){}else{if(p==n){break}p++}var s=o.pq_hidden;if(!s){u++}}if(u>=t){return null}else{return u}};k._bufferObj_calcInitFinal=function(){var s=this.options,w=s.freezeRows,r=s.flexHeight,u=s.groupModel,n=(u)?true:false,o=n?this.dataGM:this.data,x=s.treeModel;if(o==null||o.length==0){var q=this._getTotalVisibleRows(p,w,t,o);this.totalVisibleRows=q.noRows;this.init=q.init;this["final"]=q._final}else{var v=this.$vscroll.pqScrollBar("option"),p=parseInt(v.cur_pos);if(isNaN(p)||p<0){throw ("cur_pos NA");this.init=0}this.scrollCurPos=p;var t=this._bufferObj_minRowsPerGrid();this.pageSize=t;var q=this._getTotalVisibleRows(p,w,t,o);this.totalVisibleRows=q.noRows;this.init=q.init;if(r){this["final"]=o.length-1}else{this["final"]=q._final}}};k._bufferObj_calcInitFinalH=function(){var x=parseInt(this.$hscroll.pqScrollBar("option","cur_pos")),C=this.options,y=parseInt(C.freezeCols),r=C.flexWidth,z=C.virtualX,v=y,w=0,s=this.colModel,u=this.outerWidths,o=s.length;for(var t=y;t<o;t++){if(s[t].hidden){v++}else{if(w==x){break}else{v++;w++}}}if(v>o-1){v=o-1}this.initH=v;if(r||!z){this.finalH=o-1}else{var p=i.call(this,-1,y),n=this.$cont[0].offsetWidth-this._getScollBarVerticalWidth();for(var t=v;t<o;t++){var q=s[t];if(!q.hidden){var A=u[t];if(!A){throw ("width N/A")}p+=A;if(p>n){break}}}var B=t;if(B>o-1){B=o-1}this.finalH=B}};var i=function(r,p,x){var n=0,y=this.options,t=y.columnBorders,w=y.numberCell,v=this.outerWidths,q=this.colModel;if(r==-1){if(w.show){if(x){n+=parseInt(w.width)+1}else{n+=this.numberCell_outerWidth}}r=0}if(x){for(var s=r;s<p;s++){var o=q[s],u=o.hidden;if(!u){n+=parseInt(o.width)+(t?1:0)}}}else{for(var s=r;s<p;s++){if(!q[s].hidden){n+=v[s]}}}return n};g.paramquery.pqgrid.calcWidthCols=i;k._calcHeightRows=function(r,p){var n=0;var q=r;do{if(q>=p){break}var o=this.getRow({rowIndxPage:q});if(o&&o[0]){n+=o[0].offsetHeight}q++}while(1==1);return n};k._calcRightEdgeCol=function(u){var s=0,t=0,n=this.colModel,r=this.hidearrHS,q=this.outerWidths,o=this.options.numberCell;if(o.show){s+=this.numberCell_outerWidth;t++}for(var p=0;p<=u;p++){if(!n[p].hidden&&r[p]==false){s+=q[p];t++}}return{width:s,cols:t}};k._refreshFreezeLine=function(){var p=this.options,n=p.numberCell,s=this.$cont_o,r=p.freezeCols;if(this.$freezeLine){this.$freezeLine.remove()}if(r){var q=i.call(this,-1,(r))-1;if(isNaN(q)||q==0){}else{if(q>0&&n.show&&q==n.width){}else{this.$freezeLine=g("<div class='pq-grid-vert-freezeline' ></div>").appendTo(s);var o=s[0].offsetHeight;this.$freezeLine.css({height:o,left:q})}}}};k._getDragHelper=function(o){var n=g(o.currentTarget);this.$cl=g("<div class='pq-grid-drag-bar'></div>").appendTo(this.$grid_inner);this.$clleft=g("<div class='pq-grid-drag-bar'></div>").appendTo(this.$grid_inner);var q=parseInt(n.attr("pq-grid-col-indx"));var p=this.$grid_inner.outerHeight();this.$cl.height(p);this.$clleft.height(p);var s=g("td[pq-grid-col-indx="+q+"]",this.$header)[0];var r=s.offsetLeft+((q>this.options.freezeCols)?parseInt(this.$header[1].offsetLeft):0);this.$clleft.css({left:r});r=r+s.offsetWidth;this.$cl.css({left:r})};k._setDragLimits=function(p){var q=this,u=this.options,s=u.numberCell;var t=q.$header_left;if(p>=u.freezeCols){t=q.$header_right}var r=t.find("div.pq-grid-col-resize-handle[pq-grid-col-indx="+p+"]");var o=t.find("td[pq-grid-col-indx='"+p+"']");var n=o.offset().left+u.minWidth;if(p==-1){n=o.offset().left+s.minWidth}var v=17;if(u.flexHeight||this.$vscroll.css("visibility")=="hidden"){v=0}var w=q.$cont.offset().left+q.$cont[0].offsetWidth-v+20;r.draggable("option","containment",[n,0,w,0])};k._getOrderIndx=function(o){var n=this.options.columnOrder;if(n!=null){return n[o]}else{return o}};k.nestedCols=function(x,w,y){var v=x.length;var t=[];if(w==null){w=1}var s=w,u=0,n=0,p=0;for(var r=0;r<v;r++){var o=x[r];if(y==true){o.hidden=y}if(o.colModel!=null&&o.colModel.length>0){var q=this.nestedCols(o.colModel,w+1,o.hidden);t=t.concat(q.colModel);if(q.colSpan>0){if(q.depth>s){s=q.depth}o.colSpan=q.colSpan;u+=q.colSpan}else{o.colSpan=0;o.hidden=true}o.childCount=q.childCount;p+=q.childCount}else{if(o.hidden){o.colSpan=0}else{o.colSpan=1;u++}o.childCount=0;p++;t.push(o)}}return{depth:s,colModel:t,colSpan:u,width:n,childCount:p}};k.getHeadersCells=function(){var x=this.options.colModel,E=this.colModel.length,F=this.depth;var o=[];for(var v=0;v<F;v++){o[v]=[];var C=0;var w=0,q=0;for(var u=0;u<E;u++){var y;if(v==0){y=x[C]}else{var r=o[v-1][u];var s=r.colModel;if(s==null||s.length==0){y=r}else{var B=(u-r.leftPos);var z=0,p=0;var n=0;for(var A=0;A<s.length;A++){p+=(s[A].childCount>0)?s[A].childCount:1;if(B<p){n=A;break}}y=s[n]}}var D=(y.childCount)?y.childCount:1;if(u==q){y.leftPos=u;o[v][u]=y;q+=D;if(x[C+1]){C++}}else{o[v][u]=o[v][u-1]}}}this.headerCells=o;return o};k.getDataType=function(){var n=this.colModel;if(n&&n[0]){var o=n[0].dataIndx;if(typeof o=="string"){return"JSON"}else{if(typeof o=="number"){return"ARRAY"}}}throw ("dataType unknown")};k.assignRowSpan=function(){var r=this.options.colModel,n=this.colModel.length,u=this.headerCells,p=this.depth;for(var o=0;o<n;o++){for(var w=0;w<p;w++){var t=u[w][o];if(o>0&&t==u[w][o-1]){continue}else{if(w>0&&t==u[w-1][o]){continue}}var s=1;for(var v=w+1;v<p;v++){var q=u[v][o];if(t==q){s++}}t.rowSpan=s}}return u};k._calcThisColModel=function(){var n=this.nestedCols(this.options.colModel);this.colModel=n.colModel;this.depth=n.depth;this.getHeadersCells();this.assignRowSpan();this._refreshWidths();this._computeOuterWidths()};k._refreshWidthsAutoFit=function(){var u=this.options,q=this.colModel,s=this.$cont,o=q.length,y=u.minWidth;var n=i.call(this,-1,o,true);var B=s[0].offsetWidth-this._getScollBarVerticalWidth();if(n!=B){var w=n-B,r=[];for(var D=0;D<o;D++){var p=q[D],C=p.hidden;if(!C){var x=p.minWidth,x=(x?parseInt(x):y),G=parseInt(p.width)-x;if(G>0||w<0){r.push({availWd:G,colIndx:D})}}}r.sort(function(I,H){if(I.availWd>H.availWd){return 1}else{if(I.availWd<H.availWd){return -1}else{return 0}}});for(var D=0,E=r.length;D<E;D++){var v=r[D],G=v.availWd,z=v.colIndx,A=Math.round(w/(E-D)),p=q[z],F=p.width;if(G>A){var t=F-A;w=w-A;p.width=t}else{var t=F-G;w=w-G;p.width=t}}}};k._refreshWidths=function(){var B=this.options,A=B.numberCell,D=B.freezeCols,q=B.flexWidth,M=B.columnBorders,s=this.colModel,G=B.scrollModel,I=G.lastColumn,t=G.autoFit,w=this.$cont,o=s.length,F=B.minWidth;if(A.show){if(A.width<A.minWidth){A.width=A.minWidth}}for(var K=0;K<o;K++){var r=s[K],J=r.hidden;if(J){continue}var N=r.width,E=r.minWidth,E=(E?parseInt(E):F);if(N!=undefined){var z=parseInt(N);if(z<E){z=E}r.width=z}else{r.width=E}}if(w&&q==false){if(t){this._refreshWidthsAutoFit()}if(I=="auto"){var H=w[0].offsetWidth-this._getScollBarVerticalWidth();var L=i.call(this,-1,D,true);var p=H-L,n=false,u=this._getLastVisibleColIndx(),y=s[u],v=parseInt(y.width),O=y.minWidth,O=(O?parseInt(O):F);for(var K=o-1;K>=D;K--){var r=s[K];if(r.hidden){continue}var x=r.width+(M?1:0);p=p-x;if(p<0){n=true;if(v+p>=O){y.width=v+p}else{var C=v+x+p;if(C>=O){y.width=C}else{}}break}}if(!n){if(p<0){throw ("assert failed")}y.width=v+p}}}};k._createHeader=function(){var M=this,E=this.options,F=parseInt(E.freezeCols),R=E.numberCell,x=E.colModel,y=x.length,Q=this.colModel,n=this.outerWidths,A=Q.length,t=this.depth,w=E.virtualX,L=M.initH,T=M.finalH,V=E.columnBorders,P=this.headerCells,q=[],I=this.hidearrHS,v=this.$header;if(E.showHeader===false){v.empty();this.$header_o.css("display","none");return}else{this.$header_o.css("display","")}var G=["<table class='pq-grid-header-table' cellpadding=0 cellspacing=0>"];if(t>=1){G.push("<tr>");if(R.show){G.push("<td style='width:"+(R.width+1)+"px;' ></td>")}for(var u=0;u<=T;u++){if(u<L&&u>=F&&w){u=L;if(u>T){throw ("initH>finalH")}}var O=Q[u];if(O.hidden){continue}var p=n[u];G.push("<td style='width:"+p+"px;'></td>")}G.push("</tr>")}var S="pq-grid-col "+((E.hwrap===false)?" pq-wrap-text ":"");for(var C=0;C<t;C++){G.push("<tr>");if(C==0&&R.show){G.push(["<td pq-grid-col-indx='-1' class='pq-grid-number-col' rowspan='",t,"'>","<div class='pq-grid-header-table-div'>",R.title?R.title:"","</div></td>"].join(""))}for(var u=0;u<=T;u++){if(u<L&&u>=F&&w){u=L;if(u>T){throw ("initH>finalH");break}}var O=P[C][u],z=O.colSpan,H=O.halign,U=O.align,J=O.title,J=J?J:"";if(C>0&&O==P[C-1][u]){continue}else{if(u>0&&O==P[C][u-1]){continue}}if(O.hidden){continue}var o=S;if(H!=null){o+=" pq-align-"+H}else{if(U!=null){o+=" pq-align-"+U}}if(u==F-1&&t==1){o+=" pq-last-freeze-col"}if(u<=F-1){o+=" pq-left-col"}else{if(u>=L){o+=" pq-right-col"}}var B="",N="";if(O.colModel==null||O.colModel.length==0){B="pq-grid-col-indx='"+u+"'"}var D="pq-row-indx="+C;var W="pq-col-indx="+u;G.push("<td "+B+" "+W+" "+D+" "+N+" class='"+o+"' rowspan="+O.rowSpan+" colspan="+z+">				<div class='pq-grid-header-table-div' >"+J+"<span class='pq-col-sort-icon'>&nbsp;</span></div></td>")}G.push("</tr>")}this.ovCreateHeader(G,S);G.push("</table>");var K=G.join("");v.empty();v.append(K);this.$tbl_header=v.children("table");var r=g(v[0]);var s=g(v[1]);var p=i.call(this,-1,F);r.css({width:p,zIndex:1});if(!w){var X=i.call(this,F,L);s.css({left:(-1*X)+"px"})}v.find("td.pq-grid-col").click(function(){if(M.iDragColumns&&M.iDragColumns.status!="stop"){return}var Y=g(this).attr("pq-grid-col-indx");if(Y==null){return}return M._onHeaderCellClick(Y)});this._refreshResizeColumn(L,T,Q)};k.ovCreateHeader=function(){};k._refreshResizeColumn=function(v,B,r){var w=this,y=this.options,x=y.numberCell,H=0,C=w.$header[0].offsetHeight,u=y.virtualX,G=w.hidearrHS,A=parseInt(y.freezeCols),F=y.direction;if(x.show&&x.resizable){var o=g("<div pq-grid-col-indx='-1' class='pq-grid-col-resize-handle'>&nbsp;</div>").appendTo(w.$header_left);var E=w.$header_left.find("td.pq-grid-number-col")[0];H=parseInt(E.offsetLeft)+parseInt((F=="rtl")?0:(E.offsetWidth-10));o.css({left:H,height:C})}for(var D=0;D<=B;D++){if(D<v&&D>=A){D=v;if(D>B){throw ("initH>finalH")}}var p=r[D];if(p.hidden){continue}else{if(p.resizable===false){continue}}var z=w.$header_left;if(D>=A){z=w.$header_right}var o=g("<div pq-grid-col-indx='"+D+"' class='pq-grid-col-resize-handle'>&nbsp;</div>").appendTo(z);var E=w.$header_right.find("td[pq-grid-col-indx="+D+"]")[0];H=parseInt(E.offsetLeft)+parseInt((F=="rtl")?0:(E.offsetWidth-10));o.css({left:H,height:C})}var t,s,q;var n=w.$header.find(".pq-grid-col-resize-handle").draggable({axis:"x",helper:function(J,L){var I=g(J.target);var K=parseInt(I.attr("pq-grid-col-indx"));w._setDragLimits(K);w._getDragHelper(J,L);return I},start:function(I,J){t=J.position.left;q=parseInt(w.$cl[0].style.left)},drag:function(I,K){s=K.position.left;var J=(s-t);w.$cl[0].style.left=q+J+"px"},stop:function(I,J){return w._refreshResizeColumnStop(I,J,r,t)}})};k._refreshResizeColumnStop=function(y,v,s,z){var t=this,w=this.options,u=w.numberCell;t.$clleft.remove();t.$cl.remove();var x=v.position.left;var A=(x-z);var n=g(v.helper),o=parseInt(n.attr("pq-grid-col-indx")),p;if(o==-1){p=null;var q=parseInt(u.width);var r=q+A;u.width=r}else{p=s[o];var q=parseInt(p.width);var r=q+A;p.width=r}t._refresh();t._trigger("columnResize",y,{colIndx:o,column:p,dataIndx:(p?p.dataIndx:null),oldWidth:q,newWidth:p?p.width:u.width})};k._refreshHeaderSortIcons=function(){var p=this.options.dataModel;if(p.sortIndx==undefined){return}var o=this.$header;var s=o.find(".pq-grid-col");s.removeClass("pq-col-sort-asc pq-col-sort-desc ui-state-active");o.find(".pq-col-sort-icon").removeClass("ui-icon ui-icon-triangle-1-n ui-icon-triangle-1-s");var t=p.sortIndx;var r=this.getColIndx({dataIndx:t});var q="ui-state-active pq-col-sort-"+(p.sortDir=="up"?"asc":"desc");var n="ui-icon ui-icon-triangle-1-"+(p.sortDir=="up"?"n":"s");o.find(".pq-grid-col[pq-grid-col-indx="+r+"]").addClass(q);o.find(".pq-grid-col[pq-grid-col-indx="+r+"] .pq-col-sort-icon").addClass(n)};k.createTable=function(n){this.iGenerateView.generateView(n)};k._refreshOtherTables=function(){return;var D=this.colModel,y=D.length,B=this.options.freezeCols,w=this.options.columBorders;for(var v=0;v<this.tables.length;v++){var u=this.tables[v];var p=u.$tbl,x=p.find("tr:first");for(var r=0;r<y;r++){var s=D[r],z=s.dataIndx;if(s.hidden){var q=x.find("td[pq-dataIndx='"+z+"']");if(q.length>1){var o=p.find("td[pq-dataIndx='"+z+"']").remove();u.$tds.add(o)}}else{if(this.hidearrHS[r]){var q=x.find("td[pq-dataIndx='"+z+"']");if(q.css("visibility")!="hidden"){}}}var n="";var C=const_cls;if(s.align=="right"){C+=" pq-align-right"}else{if(s.align=="center"){C+=" pq-align-center"}}if(r==B-1&&w){C+=" pq-last-freeze-col"}if(s.cls){C=C+" "+s.cls}if(cellSelection){C=C+" pq-cell-select"}var A="<td class='"+C+"' style='"+n+"' pq-col-indx='"+r+"'>				"+this.iGenerateView._renderCell(objRender)+"</td>";buffer.push(A)}for(var t=0;t<hidearrHS1.length;t++){var r=hidearrHS1[t];var s=D[r];objRender.column=s;objRender.colIndx=r;var n="";n+="visibility:hidden;";var C=const_cls;if(s.align=="right"){C+=" pq-align-right"}else{if(s.align=="center"){C+=" pq-align-center"}}var A="<td class='"+C+"' style='"+n+"' pq-col-indx='"+r+"'>				"+this.iGenerateView._renderCell(objRender)+"</td>";buffer.push(A)}}};k._sortLocalData=function(r){if(r==null||r.length==0||this.sorters.length==0){return}var t=this.sorters[0],q=t.dataIndx,s=this.getColIndx({dataIndx:q}),o=this.colModel[s].dataType,p=t.dir;function n(){function y(C,B){var A=C[q];var z=B[q];A=A?parseInt(A):0;z=z?parseInt(z):0;return(A-z)}function u(C,B){var A=C[q];var z=B[q];return o(A,z)}function x(C,B){var A=(C[q]+"").replace(/,/g,"");var z=(B[q]+"").replace(/,/g,"");A=A?parseFloat(A):0;z=z?parseFloat(z):0;return(A-z)}var v=0;function w(C,B){v++;var A=C[q];var z=B[q];A=A?A:"";z=z?z:"";if(A>z){return 1}else{if(A<z){return -1}}return 0}if(o=="integer"){r=r.sort(y)}else{if(o=="float"){r=r.sort(x)}else{if(typeof o=="function"){r=r.sort(u)}else{r=r.sort(w)}}}if(p=="down"){r=r.reverse()}}g.measureTime(n,"innerSort")};g.widget("paramquery._pqGrid",k);g.measureTime=function(r,q){var o=(new Date()).getTime();r();var n=(new Date()).getTime();var p=n-o}})(jQuery);(function($){var calcWidthCols=$.paramquery.pqgrid.calcWidthCols;function cCheckBoxColumn(that){var self=this;this.that=that;this.type="checkBoxSelection";var data=that.options.dataModel.data;var dataIndx=this._findSelectionIndx();var arr=[];for(var i=0;i<data.length;i++){if(data[i][dataIndx]){arr.push(i)}}that.selection({type:"row",method:"add",rowIndx:arr});var widgetEventPrefix=that.widgetEventPrefix.toLowerCase();that.element.on(widgetEventPrefix+"cellclick",function(evt,ui){return self.cellClick(evt,ui)});that.element.on(widgetEventPrefix+"rowselect",function(evt,ui){return self.rowSelect(evt,ui)});that.element.on(widgetEventPrefix+"rowunselect",function(evt,ui){return self.rowUnSelect(evt,ui)});that.element.on(widgetEventPrefix+"cellkeydown",function(evt,ui){return self.cellKeyDown(evt,ui)})}var _pCheckBC=cCheckBoxColumn.prototype;_pCheckBC._findSelectionIndx=function(){var CM=this.that.colModel,type=this.type;for(var i=0;i<CM.length;i++){var column=CM[i];if(column.type===type){return column.dataIndx}}};_pCheckBC.cellClick=function(evt,ui){var that=this.that,rowIndx=ui.rowIndx,colIndx=ui.colIndx,column=ui.column,dataModel=ui.dataModel,data=dataModel.data,type=this.type;if(column&&column.type===type){var dataIndx=column.dataIndx;if(!data[rowIndx][dataIndx]){that.selection({type:"row",method:"add",rowIndx:rowIndx})}else{that.selection({type:"row",method:"remove",rowIndx:rowIndx})}evt.stopPropagation();return false}};_pCheckBC.rowSelect=function(evt,ui){var that=this.that,rowIndx=ui.rowIndx,data=ui.dataModel.data,dataIndx=this._findSelectionIndx();data[rowIndx][dataIndx]=true;that.refreshCell({rowIndx:rowIndx,dataIndx:dataIndx})};_pCheckBC.rowUnSelect=function(evt,ui){var that=this.that,rowIndx=ui.rowIndx,data=ui.dataModel.data,dataIndx=this._findSelectionIndx();data[rowIndx][dataIndx]=false;that.refreshCell({rowIndx:rowIndx,dataIndx:dataIndx})};_pCheckBC.cellKeyDown=function(evt,ui){var that=this.that,rowIndx=ui.rowIndx,colIndx=ui.colIndx,column=ui.column,data=ui.dataModel.data,type=this.type;if(column&&column.type===type){var dataIndx=column.dataIndx,rowIndx=ui.rowIndx;if(evt.keyCode==13||evt.keyCode==32){if(!data[rowIndx][dataIndx]){that.selection({type:"row",method:"add",rowIndx:rowIndx})}else{that.selection({type:"row",method:"remove",rowIndx:rowIndx})}evt.stopPropagation();evt.preventDefault();return false}}};var toolbarFactory={getToolbarByClass:function(cls){},createToolbar:function(){},toggle:function(cls){var $toolbar=$(this.element).find("."+cls)}};function cToolBar(){this.DOM=false}cToolBar.prototype.toggleToolbar=function(){if(!this.DOM){this.show()}else{this.hide()}return this.DOM};cToolBar.prototype.show=function(){this.create();this.DOM=true};cToolBar.prototype.hide=function(){this.remove();this.DOM=false};var cCRUD=function(that){this.that=that;this.$crudPopup=null;this.$toolbar=null};cCRUD.prototype=new cToolBar;var _pCRUD=cCRUD.prototype;_pCRUD.remove=function(){this.$crudPopup.remove();this.$toolbar.remove()};_pCRUD.create=function(){this._createDOM()};_pCRUD._createDOM=function(){var that=this.that,self=this,thisOptions=that.options,thisColModel=that.colModel;var buffer=["<div style='display:none;' class=''>","<form class='pq-grid-form' onsubmit='alert(null)'><input type='submit' />"];var strCRUDFORM=buffer.join("")+"</form></div>";var $crudPopup=$(strCRUDFORM).appendTo(document.body);self.$crudPopup=$crudPopup;self.$crudForm=this.$crudPopup.find("form");$crudPopup.dialog({width:"auto",modal:true,open:function(){$(".ui-dialog").position({of:this.element});$(".ui-dialog").find('button:contains("Cancel")').button({icons:{primary:"ui-icon-close"}});$(".ui-dialog").find('button:contains("Add")').button({icons:{primary:"ui-icon-disk"}});$(".ui-dialog").find('button:contains("Update")').button({icons:{primary:"ui-icon-disk"}});that._trigger("crudFormOpen",null,{$form:self.$crudForm,colModel:thisColModel,dataModel:thisOptions.dataModel})},autoOpen:false});$crudPopup.parent(".ui-dialog").addClass("pq-grid-dialog");$crudPopup.on("dialogopen",function(evt,ui){self.onDialogOpen()});var $toolbar=$("<div class='pq-grid-toolbar pq-grid-toolbar-crud'></div>").appendTo($(".pq-grid-top",this.element));this.$toolbar=$toolbar};var cSearch=function(that){this.that=that;this.dust=[]};cSearch.prototype=new cToolBar;var _pSearch=cSearch.prototype;_pSearch._init=function(){this.txt="";this.rowIndices=[];this.curIndx=null;this.dataIndx=null;this.sortIndx=null;this.sortDir=null;this.results=null;this.$toolbar=null};_pSearch.remove=function(){var that=this.that;this.$toolbar.remove();this.rowIndices=[];$(that.element).off(".pqsearch")};_pSearch.create=function(){var that=this.that,self=this;this._init();this._createDOM();var widgetEventPrefix=that.widgetEventPrefix.toLowerCase();that.element.on(widgetEventPrefix+"refresh.pqsearch",function(){var DM=that.options.dataModel,location=DM.location;if(location=="local"){self.highlight()}});that.element.on(widgetEventPrefix+"sort.pqsearch",function(){var DM=that.options.dataModel,location=DM.location;if(location=="local"){}})};_pSearch.prevResult=function(){var dataIndx=this.dataIndx,rowIndices=this.rowIndices;if(rowIndices.length==0){this.curIndx=null}else{if(this.curIndx==null||this.curIndx==0){this.curIndx=rowIndices.length-1}else{this.curIndx--}}this.updateSelection()};_pSearch.nextResult=function(){var rowIndices=this.rowIndices;if(rowIndices.length==0){this.curIndx=null}else{if(this.curIndx==null){this.curIndx=0}else{if(this.curIndx<rowIndices.length-1){this.curIndx++}else{this.curIndx=0}}}this.updateSelection()};_pSearch.updateSelection=function(){var that=this.that,dataIndx=this.dataIndx,curIndx=this.curIndx,rowIndices=this.rowIndices;if(dataIndx==null){return}if(rowIndices.length>0){this.results.html("Selected "+(curIndx+1)+" of "+rowIndices.length+" match(es).")}else{this.results.html("Nothing found.")}that.setSelection(null);that.refreshColumn({dataIndx:dataIndx});that.setSelection({rowIndx:rowIndices[curIndx],dataIndx:dataIndx});this.highlight()};_pSearch.search=function(){var that=this.that,txtUpper=this.$input.val().toUpperCase(),dataIndx=this.$select.val(),CM=that.colModel,colIndx=that.getColIndx({dataIndx:dataIndx}),dataType=CM[colIndx].dataType,thisOptions=that.options,DM=thisOptions.dataModel,sortIndx=DM.sortIndx,sortDir=DM.sortDir;if(txtUpper==this.txt&&dataIndx==this.dataIndx&&sortIndx==this.sortIndx&&sortDir==this.sortDir){return}this.rowIndices=[];this.curIndx=null;this.sortIndx=sortIndx;this.sortDir=sortDir;if(this.dataIndx!=null&&dataIndx!=this.dataIndx){thisOptions.customData=null;that.refreshColumn({dataIndx:this.dataIndx})}this.dataIndx=dataIndx;if(txtUpper!=null&&txtUpper.length>0){var data=DM.data;for(var i=0,len=data.length;i<len;i++){var rowData=data[i];if(this._isMatch(rowData,dataType,dataIndx,txtUpper)){this.rowIndices.push(i)}}}this.txt=txtUpper};_pSearch.highlightTextNodes=function(node){var self=this,txt=this.txt,txtUpper=this.txt.toUpperCase();function getTextNodes(node){if(node.nodeType==3){var val=node.nodeValue,valUpper=val.toUpperCase(),indx=valUpper.indexOf(txtUpper);if(indx>=0){var txt1=val.substring(0,indx);var txt2=val.substring(indx,indx+txt.length);var txt3=val.substring(indx+txt.length);var html=txt1+"<span class='ui-state-highlight'>"+txt2+"</span>"+txt3;$(node).replaceWith(html)}}else{for(var i=0,len=node.childNodes.length;i<len;++i){getTextNodes(node.childNodes[i])}}}getTextNodes(node)};_pSearch.render=function(){var that=this.that,rowIndices=this.rowIndices,offset=that.rowIndxOffset,DM=that.options.dataModel,location=DM.location,len=(location==="local")?rowIndices.length:DM.rPP,paging=(DM.paging==="local"||DM.paging==="remote")?true:false,colIndx=that.getColIndx({dataIndx:this.dataIndx});if($.trim(this.txt)==""){return}for(var i=0;i<len;i++){var rowIP;if(location==="local"){rowIP=rowIndices[i]-offset;if(paging&&(rowIP<0||rowIP>=DM.rPP)){continue}}else{rowIP=i}var $td=that.getCell({rowIndxPage:rowIP,colIndx:colIndx});if($td&&$td.length>0){for(var j=0;j<$td.length;j++){this.highlightTextNodes($td[j])}}}};_pSearch.highlight=function(){var that=this.that,thisOptions=that.options,TBM=thisOptions.toolBarModel,toolbars=TBM.toolbars;if(toolbars&&toolbars.search&&toolbars.search.highlight){this.render()}};var cHeaderSearch=function(that){this.that=that;var self=this;this.dataHS={};var widgetEventPrefix=that.widgetEventPrefix.toLowerCase();that.element.on(widgetEventPrefix+"headerkeydown",function(evt,ui){var $src=$(evt.originalEvent.target);if($src.hasClass("pq-search-hd-field")){return self.onKeyDown(evt,ui,$src)}else{return true}});that.element.on(widgetEventPrefix+"createheader",function(evt,ui){return self._onCreateHeader()})};var _pHeaderSearch=cHeaderSearch.prototype=new cSearch;_pHeaderSearch.onChange=function(evt,ui,$this){throw ("not being used");var that=this.that,CM=that.colModel,dataIndx=$this.attr("pq-dataIndx"),column=that.getColumn({dataIndx:dataIndx}),filter=column.filter,fvalue=filter.value,thisOptions=that.options,DM=thisOptions.dataModel,location=DM.location,val=$.trim($this.val());if(dataIndx!=null){if(fvalue==val||(val==""&&fvalue==null)){return}filter.value=val;filter.on=true;if(that._trigger("beforeFilter",null,{filterData:that.getFilterData(),colModel:CM,dataModel:DM})==false){return}if(location=="local"){that.refreshDataAndView({header:false})}else{if(location=="remote"){that.refreshDataAndView({header:false})}}}};_pHeaderSearch.onKeyDown=function(evt,ui,$this){var that=this.that,keyCode=evt.keyCode,keyCodes=$.ui.keyCode,dataIndx=$this.attr("pq-dataIndx"),freezeCols=that.options.freezeCols;if(keyCode===keyCodes.TAB){var colIndx=that.getColIndx({dataIndx:dataIndx}),CM=that.colModel,shiftKey=evt.shiftKey,$tbl_left,$tbl_right;var col=colIndx;do{if(shiftKey){col--}else{col++}if(col<0||col>=CM.length){break}var column=CM[col],$inp,dIndx=column.dataIndx,selector="input[pq-dataIndx='"+dIndx+"'],select[pq-dataIndx='"+dIndx+"']";if(column.hidden){continue}if(!column.filter){continue}that.scrollColumn({colIndx:col});$tbl_left=$(that.$tbl_header[0]);$tbl_right=$(that.$tbl_header[(that.$tbl_header.length==2)?1:0]);if(col>=freezeCols){$inp=$tbl_right.find(selector)}else{$inp=$tbl_left.find(selector)}if($inp){$inp.focus();evt.preventDefault();return false}else{break}}while(1===1)}else{return true}};_pHeaderSearch._onCreateHeader=function(){var that=this.that,CM=that.colModel,freezeCols=that.options.freezeCols,$tbl_left=$(that.$tbl_header[0]),$tbl_right=$(that.$tbl_header[1]),selector="input,select";$tbl_left.find(selector).css("visibility","hidden");for(var i=0;i<freezeCols;i++){var column=CM[i];var dIndx=column.dataIndx;var selector="*[pq-dataIndx='"+dIndx+"']";$tbl_left.find(selector).css("visibility","visible");$tbl_right.find(selector).css("visibility","hidden")}for(var i=0,len=CM.length;i<len;i++){var column=CM[i],filter=column.filter;if(filter){var value=filter.value;var listeners=filter.listeners;if(listeners){var dataIndx=column.dataIndx,selector=".pq-search-hd-field[pq-dataIndx='"+dataIndx+"']",ele=that.$header_o.find(selector);for(var j=0;j<listeners.length;j++){var listener=listeners[j];for(var event in listener){var handler=listener[event];(function(handler,dataIndx){ele.bind(event,function(evt){var column=that.getColumn({dataIndx:dataIndx});return handler.call(this,evt,{column:column})})})(handler,dataIndx)}}}}}};_pHeaderSearch.createDOM=function(buffer,td_const_cls){var that=this.that,self=this,initH=that.initH,finalH=that.finalH,hidearrHS=that.hidearrHS,thisOptions=that.options,freezeCols=thisOptions.freezeCols,virtualX=thisOptions.virtualX,CM=that.colModel,columnBorders=thisOptions.columnBorders,dataHS=this.dataHS,numberCell=thisOptions.numberCell;buffer.push("<tr class='pq-grid-header-search'>");if(numberCell.show){buffer.push(["<td pq-grid-col-indx='-1' class='pq-grid-number-col' rowspan='1'>","<div class='pq-grid-header-table-div'>&nbsp;</div></td>"].join(""))}for(var i=0;i<=finalH;i++){if(i<initH&&i>=freezeCols&&virtualX){i=initH;if(i>finalH){throw ("initH>finalH")}}var column=CM[i];if(column.hidden){continue}var td_cls=td_const_cls,align=column.halign;if(!align){align=column.align}if(align=="right"){td_cls+=" pq-align-right"}else{if(align=="center"){td_cls+=" pq-align-center"}}var filter=column.filter;if(filter){var dataIndx=column.dataIndx,type=filter.type,value=filter.value,wd=parseInt(column.width)+((columnBorders)?1:0),wd=wd-15,cls=filter.cls,cls="pq-search-hd-field "+(cls?cls:""),style=filter.style,style=style?style:"",attr=filter.attr,attr=attr?attr:"",strS="";if(type==="textbox"){value=value?value:"";cls=cls+" ui-corner-all pq-search-txt";strS=this._input(dataIndx,value,wd,cls,style,attr)}else{if(type==="select"){var so=filter.options;if(typeof so==="function"){so=so({colModel:CM})}value=value?value:"";cls=cls+" ui-corner-all";strS=this._dropDown(so,dataIndx,value,wd,cls,style,attr)}else{if(type=="checkbox"){var checked=(value==null||value==false)?"":"checked=checked";strS=["<input ",checked," pq-dataIndx='",dataIndx,"' type=checkbox class='"+cls+"' style='"+style+"' "+attr+"/>"].join("")}else{if(typeof type=="string"){strS=type}else{if(typeof type=="function"){strS=type({width:wd,value:value,colModel:CM,cls:cls})}}}}}buffer.push(["<td class='",td_cls,"'><div class='pq-grid-header-table-div' style='padding:0px 2px;' >","",strS,"</div></td>"].join(""))}else{buffer.push(["<td class='",td_cls,"'><div class='pq-grid-header-table-div' >","&nbsp;","</div></td>"].join(""))}}buffer.push("</tr>")};_pHeaderSearch._input=function(dataIndx,value,wd,cls,style,attr){return['<input value="',value,"\" pq-dataIndx='",dataIndx,"' type=text style='width:",wd,"px;"+style+"' class='"+cls+"' "+attr+" />"].join("")};_pHeaderSearch._dropDown=function(so,dataIndx,value,wd,cls,style,attr){var buffer=["<select pq-dataIndx='",dataIndx,"' class='"+cls+"' style='width:",wd,"px;"+style+"' "+attr+" >"],selected="";for(var i=0,len=so.length;i<len;i++){var option=so[i];if(option==value){selected="selected"}else{selected=""}buffer.push("<option value='"+option+"' "+selected+" >"+option+"</option>")}buffer.push("</select>");return buffer.join("")};var _pGenerateView={};_pGenerateView._generateTitleRow=function(GM,rowObj,buffer,lastFrozenRow){var that=this.that,thisOptions=that.options,numberCell=thisOptions.numberCell,groupTitle=rowObj.groupTitle,GMTitle=GM.title,groupLevel=rowObj.level,GMRowIndx=rowObj.GMRowIndx,GMIcon=GM.icon,GMIcon=GMIcon?GMIcon[groupLevel]:null,GMIcon=(GMIcon&&GMIcon.length&&GMIcon.length==2&&typeof GMIcon.push==="function")?GMIcon:["ui-icon-minus","ui-icon-plus"];if(GMTitle&&GMTitle[groupLevel]){groupTitle=GMTitle[groupLevel].replace("{0}",groupTitle);groupTitle=groupTitle.replace("{1}",rowObj.items)}else{groupTitle=groupTitle+" - "+rowObj.items+" item(s)"}buffer.push(["<tr class='pq-group-row pq-grid-row",(lastFrozenRow?" pq-last-freeze-row":""),"' title=\"",rowObj.groupTitle,"\" level='",groupLevel,"' GMRowIndx='",GMRowIndx,"'>"].join(""));if(numberCell.show){buffer.push("<td class='pq-grid-number-cell ui-state-default'><div class='pq-td-div'></div></td>")}var icon=GMIcon[0];if(rowObj.collapsed){icon=GMIcon[1]}buffer.push(["<td class='pq-grid-cell' colspan='100' >","<div class='pq-td-div' style='margin-left:",(groupLevel*16),"px;'>","<span class='ui-icon ",icon,"'></span>",groupTitle,"</div></td>"].join(""));buffer.push("</tr>")};_pGenerateView._generateSummaryRow=function(rowData,thisColModel,buffer,lastFrozenRow){var row_cls="pq-summary-row pq-grid-row"+(lastFrozenRow?" pq-last-freeze-row":""),that=this.that,thisOptions=that.options,virtualX=thisOptions.virtualX,initH=that.initH,finalH=that.finalH,freezeCols=thisOptions.freezeCols,numberCell=thisOptions.numberCell,TVM=thisOptions.treeModel,columnBorders=thisOptions.columnBorders,wrap=thisOptions.wrap,offset=this.offset;var const_cls="pq-grid-cell ";var row_str="<tr class='"+row_cls+"'>";buffer.push(row_str);if(numberCell.show){buffer.push(["<td class='pq-grid-number-cell ui-state-default'>","<div class='pq-td-div'>&nbsp;</div></td>"].join(""))}for(var col=0;col<=finalH;col++){if(col<initH&&col>=freezeCols&&virtualX){col=initH;if(col>finalH){throw ("initH>finalH")}}var column=thisColModel[col],dataIndx=column.dataIndx;if(column.hidden){continue}var strStyle="";var cls=const_cls;if(column.align=="right"){cls+=" pq-align-right"}else{if(column.align=="center"){cls+=" pq-align-center"}}if(col==freezeCols-1&&columnBorders){cls+=" pq-last-freeze-col"}if(column.cls){cls=cls+" "+column.cls}var valCell=(rowData[dataIndx]==null)?"":rowData[dataIndx];var str=["<td class='",cls,"' style='",strStyle,"' >","<div class='pq-td-div'>",valCell,"</div></td>"].join("");buffer.push(str)}buffer.push("</tr>");return buffer};var cTreeView=function(that){this.that=that};var _pTVM=cTreeView.prototype;_pTVM._onClickTreeExpandIcon=function(evt){var that=this.that,TVM=that.options.treeModel,rowIndxPage=parseInt($(evt.currentTarget).parents(".pq-grid-row").attr("pq-row-indx"),10),thisData=that.data,rowData=that.data[rowIndxPage],level=rowData[TVM.levelIndx],expanded=that._getRowPQData(rowIndxPage,"expanded");if(expanded){that._setRowPQData(rowIndxPage,{expanded:false});for(var i=rowIndxPage+1,len=thisData.length;i<len;i++){var rowData2=thisData[i];var level2=rowData2[TVM.levelIndx];if(level2==level){break}else{that._setRowPQData(i,{hidden:true})}}}else{that._setRowPQData(rowIndxPage,{expanded:true});this._nestedShowNodes(level,rowIndxPage,TVM.levelIndx,TVM.leafIndx)}that._refresh();evt.preventDefault();return false};_pTVM._nestedShowNodes=function(level,rowIndxPage,levelIndx,leafIndx){var that=this.that,thisData=that.data;for(var i=rowIndxPage+1,len=thisData.length;i<len;i++){var rowData2=thisData[i];var level2=rowData2[levelIndx],isLeaf=rowData2[leafIndx];if(level2==level+1){that._setRowPQData(i,{hidden:false});if(!isLeaf){var expanded=that._getRowPQData(i,"expanded");if(expanded){this._nestedShowNodes(level2,i,levelIndx,leafIndx)}}}else{if(level2==level){break}}}};_pTVM._refreshDataFromDataModel=function(){var that=this.that,TVM=that.options.treeModel,levelIndx=TVM.levelIndx,leafIndx=TVM.leafIndx,thisData=that.data,expanded=TVM.expanded,parents=[];for(var i=0,len=thisData.length;i<len;i++){var rowData=thisData[i],isLeaf=rowData[leafIndx],level=rowData[levelIndx];if(expanded){if(!isLeaf){that._setRowPQData(i,{expanded:true})}}else{if(!isLeaf){that._setRowPQData(i,{expanded:false})}if(level!=0){that._setRowPQData(i,{hidden:true})}}if(!isLeaf){parents[level]=rowData}if(level>0){that._setRowPQData(i,{parent:parents[level-1]})}}};var cGroupView=function(that){this.that=that};var _pGroupView=cGroupView.prototype;_pGroupView._refreshDataFromDataModelNotUsedOld=function(){this._groupArrays();var dataGM=this.dataGM;for(var i=0,len=dataGM.length;i<len;i++){var rowIndx=dataGM[i].rowIndx;if(rowIndx==begIndx){if(dataGM[i-1].rowIndx==null){begIndx=i-1}else{begIndx=i}}else{if(rowIndx==endIndx){if(dataGM[i+1].rowIndx==null){endIndx=i+1}else{endIndx=i}}}}this.data=this.dataGM.slice(begIndx,endIndx)};_pGroupView.showHideRows=function(initIndx,level,hide){var arr=[],that=this.that,data=that.dataGM;for(var i=initIndx,len=data.length;i<len;i++){var rowObj=data[i],rowData=rowObj;if(rowData.groupSummary){if(rowObj.level<level){break}else{rowObj.pq_hidden=hide}}else{if(rowData.groupTitle){if(rowObj.collapsed){arr.push({indx:i,level:rowObj.level})}if(rowObj.level<=level){break}else{rowObj.pq_hidden=hide}}else{rowObj.pq_hidden=hide}}}return arr};_pGroupView.onClickGroupRow=function(evt){var $tr=$(evt.currentTarget),that=this.that;var level=parseInt($tr.attr("level")),GMRowIndx=parseInt($tr.attr("GMRowIndx")),data=that.dataGM,collapsed=true,rowObj=data[GMRowIndx];if(!rowObj.collapsed){rowObj.collapsed=true;collapsed=true}else{rowObj.collapsed=false;collapsed=false}if(collapsed){this.showHideRows(GMRowIndx+1,level,true)}else{var arr=this.showHideRows(GMRowIndx+1,level,false);for(var j=0;j<arr.length;j++){var indx=arr[j].indx;var level=arr[j].level;this.showHideRows(indx+1,level,true)}}that._refresh()};_pGroupView.initcollapsed=function(){var that=this.that,data=that.dataGM;if(!data){return}for(var i=0,len=data.length;i<len;i++){var rowData=data[i],groupTitle=rowData.groupTitle;if(groupTitle!==undefined){var level=rowData.level,collapsed=rowData.collapsed;if(collapsed){this.showHideRows(i+1,level,true)}}}};_pGroupView.max=function(arr,dataType){var ret;if(dataType=="integer"||dataType=="float"){ret=Math.max.apply(Math,arr);if(dataType==="float"){ret=ret.toFixed(2)}}else{if(dataType=="date"){arr=arr.sort(function(a,b){a=Date.parse(a);b=Date.parse(b);return(a-b)});ret=arr[arr.length-1]}else{arr=arr.sort();ret=arr[arr.length-1]}}return ret};_pGroupView.min=function(arr,dataType){var ret;if(dataType=="integer"||dataType=="float"){ret=Math.min.apply(Math,arr);if(dataType==="float"){ret=ret.toFixed(2)}}else{if(dataType=="date"){arr=arr.sort(function(a,b){a=Date.parse(a);b=Date.parse(b);return(a-b)});ret=arr[0]}else{arr=arr.sort();ret=arr[0]}}return ret};_pGroupView.count=function(arr){return arr.length};_pGroupView.sum=function(arr,dataType){var s=0,fn;if(dataType==="float"){fn=parseFloat}else{if(dataType==="integer"){fn=parseInt}else{fn=function(val){return val}}}for(var i=0,len=arr.length;i<len;i++){s+=fn(arr[i])}if(dataType==="float"){s=s.toFixed(2)}return s};_pGroupView._groupData=function(data){var that=this.that,thisOptions=that.options,GM=thisOptions.groupModel,DM=thisOptions.dataModel,CM=that.colModel,rowOffset=(DM.paging)?((DM.curPage-1)*DM.rPP):0,CMLength=CM.length,GMdataIndx=GM.dataIndx,GMLength=GMdataIndx.length,GMcollapsed=GM.collapsed,groupSummaryShow=[];for(var u=0;u<GMLength;u++){groupSummaryShow[u]=false;for(var v=0;v<CMLength;v++){var column=CM[v],summary=column.summary;if(!summary){continue}var summaryType=summary.type;if(!summaryType||typeof summaryType.push!="function"){continue}if(summaryType[u]){groupSummaryShow[u]=true;break}}}if(GM&&data&&data.length>0){var dataGM=[],titleIndx=[],groupVal=[],prevGroupVal=[],cols=[];for(var u=0;u<GMLength;u++){prevGroupVal[u]="";groupVal[u]="";cols[u]={}}for(var i=0,len=data.length;i<=len;i++){var rowData=data[i];var changeGroup=false,changeGroupIndx=null;for(var u=0;u<GMLength;u++){groupVal[u]=(i<len)?$.trim(rowData[GMdataIndx[u]]):"";if(prevGroupVal[u]!=groupVal[u]){changeGroup=true}if(changeGroup&&changeGroupIndx==null){changeGroupIndx=u}}if(changeGroup){for(var l=0;l<GMLength;l++){prevGroupVal[l]=groupVal[l]}if(i>0){for(var u=GMLength-1;u>=changeGroupIndx;u--){if(groupSummaryShow[u]){var groupRowData=[];for(var f=0;f<CMLength;f++){var column=CM[f],summary=column.summary,summaryType=(summary)?(summary.type?summary.type[u]:null):null;if(summaryType){var dataIndx=column.dataIndx,summaryCellData="",summaryTitle=summary.title?summary.title[u]:null,sText="{0}";if(typeof summaryType=="function"){summaryCellData=summaryType(cols[u][dataIndx],column.dataType)}else{sText=summaryType+": {0}";summaryCellData=this[summaryType](cols[u][dataIndx],column.dataType)}if(summaryTitle){sText=summaryTitle}groupRowData[dataIndx]=sText.replace("{0}",summaryCellData)}}dataGM.push({groupSummary:true,level:u,data:groupRowData})}}for(var m=changeGroupIndx;m<GMLength;m++){dataGM[titleIndx[m]].items=cols[m][CM[0].dataIndx].length}}if(i==len){break}for(var z=GMLength-1;z>=changeGroupIndx;z--){for(var e=0;e<CMLength;e++){var column=CM[e];cols[z][column.dataIndx]=[]}}for(var m=changeGroupIndx;m<GMLength;m++){dataGM.push({groupTitle:groupVal[m],level:m,GMRowIndx:dataGM.length,collapsed:(GMcollapsed&&(GMcollapsed[m]!=null))?GMcollapsed[m]:false});titleIndx[m]=dataGM.length-1}}rowData.rowIndx=i+rowOffset;rowData.pq_hidden=false;dataGM.push(rowData);for(var k=0;k<CMLength;k++){var column=CM[k],dataIndx=column.dataIndx;for(var u=0;u<GMLength;u++){cols[u][dataIndx].push(rowData[dataIndx])}}}that.dataGM=dataGM}};_pGroupView._refreshDataFromDataModelNotUsed=function(){throw ("not used");var that=this.that,thisOptions=that.options,GM=thisOptions.groupModel,DM=thisOptions.dataModel,thisColModel=that.colModel,offset=that.rowIndxOffset,colModelLength=thisColModel.length;if(GM&&DM.data&&DM.data.length>0){var dataGM=this.dataGM;if(dataGM==null){throw ("dataGM N/A")}that.dataGM=[];if(DM.paging&&DM.paging=="local"){var begIndx=(DM.curPage-1)*DM.rPP;var endIndx=DM.curPage*DM.rPP;if(endIndx>DM.data.length){endIndx=DM.data.length}var takeIn=false,getOut=false;for(var i=begIndx;i<dataGM.length;i++){var rowData=dataGM[i];if(rowData.groupSummary&&getOut){that.dataGM.push(rowData);break}else{if((rowData.groupSummary)&&takeIn){that.dataGM.push(rowData)}else{if((rowData.groupTitle)&&takeIn){that.dataGM.push(rowData)}else{if(getOut){break}var rowIndx=rowData.rowIndx;if(rowIndx==null||rowIndx<begIndx){continue}if(i>0&&rowIndx==begIndx){var prevRowData=dataGM[i-1];if(prevRowData.groupTitle){that.dataGM.push(prevRowData)}}if(rowIndx>=endIndx-1){getOut=true}if(rowIndx>=begIndx){takeIn=true;var rowIndxPage=rowIndx-offset;rowData.rowIndxPage=rowIndxPage;that.dataGM.push(rowData)}}}}}}else{that.dataGM=dataGM}}};var cDragColumns=function(that){this.that=that;this.$drag_helper=null;var dragColumns=that.options.dragColumns,topIcon=dragColumns.topIcon,bottomIcon=dragColumns.bottomIcon;this.status="stop";this.$arrowTop=$("<div class='pq-arrow-down ui-icon "+topIcon+"'></div>").appendTo(that.element);this.$arrowBottom=$("<div class='pq-arrow-up ui-icon "+bottomIcon+"' ></div>").appendTo(that.element);this.hideArrows()};var _pDragColumns=cDragColumns.prototype;_pDragColumns.showFeedback=function($td,leftDrop){var that=this.that;var td=$td[0];var offParent=td.offsetParent.offsetParent;var left=td.offsetLeft+offParent.offsetLeft+((!leftDrop)?td.offsetWidth:0)-8;var top=that.$grid_inner[0].offsetTop+td.offsetTop-16;var top2=that.$grid_inner[0].offsetTop+that.$header[0].offsetHeight;this.$arrowTop.css({left:left,top:top,display:""});this.$arrowBottom.css({left:left,top:top2,display:""})};_pDragColumns.showArrows=function(){this.$arrowTop.show();this.$arrowBottom.show()};_pDragColumns.hideArrows=function(){this.$arrowTop.hide();this.$arrowBottom.hide()};_pDragColumns.updateDragHelper=function(accept){var that=this.that,dragColumns=that.options.dragColumns,acceptIcon=dragColumns.acceptIcon,rejectIcon=dragColumns.rejectIcon,$drag_helper=this.$drag_helper;if(!$drag_helper){return}if(accept){$drag_helper.children("span.pq-drag-icon").addClass(acceptIcon).removeClass(rejectIcon);$drag_helper.removeClass("ui-state-error")}else{$drag_helper.children("span.pq-drag-icon").removeClass(acceptIcon).addClass(rejectIcon);$drag_helper.addClass("ui-state-error")}};_pDragColumns.setDraggables=function(evt,ui){var $td=$(evt.currentTarget),that=this.that,dragColumns=that.options.dragColumns,rejectIcon=dragColumns.rejectIcon,self=this;if($td.hasClass("ui-draggable")){return}if(!that.getHeaderColumnFromTD($td)){return}$td.draggable({distance:10,cursorAt:{top:-18,left:-10},helper:function(){var $this=$(this);self.status="helper";self._setupDroppables($this);that.$header.find(".pq-grid-col-resize-handle").hide();var colIndx=$this.attr("pq-col-indx");var rowIndx=$this.attr("pq-row-indx");$this.droppable("destroy");var column=that.headerCells[rowIndx][colIndx];var $drag_helper=$("<div class='pq-col-drag-helper ui-widget-content ui-corner-all' ><span class='pq-drag-icon ui-icon "+rejectIcon+"'></span>"+column.title+"</div>");self.$drag_helper=$drag_helper;return $drag_helper[0]},zIndex:"1000",appendTo:that.element,revert:"invalid",drag:function(evt,ui){self.status="drag";var $td=$("td.pq-drop-hover",that.$header);if($td.length>0){if($.trim($td.text())!=$.trim($(evt.originalEvent.target).text())){return}self.showArrows();self.updateDragHelper(true);var wd=$td.width();var lft=evt.offsetX;if(lft==0){}if(lft<wd/2){self.leftDrop=true;self.showFeedback($td,true)}else{self.leftDrop=false;self.showFeedback($td,false)}}else{self.hideArrows();if(that.$toolbar.hasClass("pq-drop-hover")){self.updateDragHelper(true)}else{self.updateDragHelper()}}},stop:function(evt,ui){self.status="stop";that.$header.find(".pq-grid-col-resize-handle").show();self.hideArrows()}})};_pDragColumns._columnIndexOf=function(colModel,column){for(var i=0,len=colModel.length;i<len;i++){if(colModel[i]==column){return i}}return -1};_pDragColumns.refreshSorting=function(){var that=this.that;window.setTimeout(function(){var arr=that.$toolbar.sortable("toArray",{attribute:"sorter"});that.sorters=[];for(var i=0,len=arr.length;i<len;i++){that.sorters.push(eval("("+arr[i]+")"))}that.sortLocalData(that.sorters,that.data);that.refresh()},0)};_pDragColumns._setupDroppables=function($td){var that=this.that,self=this;var objDrop={hoverClass:"pq-drop-hover ui-state-highlight",tolerance:"pointer",drop:function(evt,ui){if(that.dropPending){return}var colIndxDrag=parseInt(ui.draggable.attr("pq-col-indx"),10);var rowIndxDrag=parseInt(ui.draggable.attr("pq-row-indx"),10);var colIndxDrop=parseInt($(this).attr("pq-col-indx"),10);var rowIndxDrop=$(this).attr("pq-row-indx");var optCM=that.options.colModel;var headerCells=that.headerCells;var columnDrag=headerCells[rowIndxDrag][colIndxDrag];var colModelDrag,colModelDrop;if(rowIndxDrag==0){colModelDrag=optCM}else{colModelDrag=headerCells[rowIndxDrag-1][colIndxDrag].colModel}if(rowIndxDrop==0){colModelDrop=optCM}else{colModelDrop=headerCells[rowIndxDrop-1][colIndxDrop].colModel}var columnDrop=headerCells[rowIndxDrop][colIndxDrop];var indxDrag=self._columnIndexOf(colModelDrag,columnDrag);var column=colModelDrag.splice(indxDrag,1)[0];var indxDrop=self._columnIndexOf(colModelDrop,columnDrop);var decr=(self.leftDrop)?1:0;colModelDrop.splice(indxDrop+1-decr,0,column);that.dropPending=true;window.setTimeout(function(){that._calcThisColModel();that._refresh();that.dropPending=false},0)}};var $tds=that.$header_left.find("td.pq-left-col");var $tds2=that.$header_right.find("td.pq-right-col");$tds=$tds.add($tds2);$tds.each(function(i,td){var $td=$(td);if($td.hasClass("ui-droppable")){return}$td.droppable(objDrop)});return;var column=that.getHeaderColumnFromTD($td);var dataIndx=column.dataIndx;if(that.getIndxInSorters(dataIndx)!=-1){if(that.$toolbar.hasClass("ui-droppable")){that.$toolbar.droppable("destroy")}return}that.$toolbar.droppable({hoverClass:"pq-drop-hover ui-state-highlight",tolerance:"pointer",drop:function(evt,ui){var colIndxDrag=parseInt(ui.draggable.attr("pq-col-indx"),10);var rowIndxDrag=parseInt(ui.draggable.attr("pq-row-indx"),10);var optCM=that.options.colModel;var headerCells=that.headerCells;var columnDrag=headerCells[rowIndxDrag][colIndxDrag];var colModelDrag;if(rowIndxDrag==0){colModelDrag=optCM}else{colModelDrag=headerCells[rowIndxDrag-1][colIndxDrag].colModel}var indxDrag=self._columnIndexOf(colModelDrag,columnDrag);var column=colModelDrag[indxDrag];var dataIndx=column.dataIndx;var dataType=column.dataType;that.sorters.push({dataIndx:dataIndx,dataType:dataType,dir:"up"});$("<span class='pq-sortable' sorter=\"{dataIndx:"+dataIndx+",dataType:'"+dataType+"',dir:'up'}\">"+column.title+"</span>").appendTo(that.$toolbar).button({icons:{primary:"ui-icon-triangle-1-n",secondary:"ui-icon-close"}}).mouseover(function(evt){var $target=$(evt.target);if($target.is("span.ui-icon-close")){$target.css("outline","1px solid black")}}).mouseout(function(evt){var $target=$(evt.target);if($target.is("span.ui-icon-close")){$target.css("outline","")}}).click(function(evt){var $button=$(this);if($(evt.target).is("span.ui-icon-close")){window.setTimeout(function(){$button.button("destroy");$button.remove();self.refreshSorting()},0)}else{var sorter=eval("("+$button.attr("sorter")+")");if(sorter.dir=="up"){sorter.dir="down";$button.button({icons:{primary:"ui-icon-triangle-1-s",secondary:"ui-icon-close"}})}else{sorter.dir="up";$button.button({icons:{primary:"ui-icon-triangle-1-n",secondary:"ui-icon-close"}})}var sorterStr="{dataIndx:"+sorter.dataIndx+",dataType:'"+sorter.dataType+"',dir:'"+sorter.dir+"'}";$button.attr("sorter",sorterStr);self.refreshSorting()}});self.refreshSorting();window.setTimeout(function(){that.$toolbar.droppable("destroy")},0)}})};var cHistory=function(that){this.that=that;this.records=[];this.counter=0};var _pHistory=cHistory.prototype;_pHistory.push=function(arr){if(this.records.length>this.counter){this.records.splice(this.counter,(this.records.length-this.counter))}this.records[this.counter]=arr;this.counter++};_pHistory.undo=function(){var that=this.that,data=that.options.dataModel.data;if(this.counter>0){this.counter--}else{return false}var fullOp=this.records[this.counter];for(var i=0;i<fullOp.length;i++){var op=fullOp[i],rowIndx=op.rowIndx,rowData=data[rowIndx];if(rowData){rowData[op.colIndx]=op.oldVal}}return true};_pHistory.redo=function(){var that=this.that,data=that.options.dataModel.data;if(this.counter==this.records.length){return false}var fullOp=this.records[this.counter];for(var i=0;i<fullOp.length;i++){var op=fullOp[i],rowIndx=op.rowIndx,rowData=data[rowIndx];if(rowData){rowData[op.colIndx]=op.newVal}}if(this.counter<this.records.length){this.counter++}return true};var fn={};fn.options={dragColumns:{enabled:true,acceptIcon:"ui-icon-check",rejectIcon:"ui-icon-closethick",topIcon:"ui-icon-circle-arrow-s",bottomIcon:"ui-icon-circle-arrow-n"},track:false,virtualX:true,filterModel:{on:true,mode:"AND",header:false}};fn._create=function(){$.extend($.paramquery.cGenerateView.prototype,_pGenerateView);var that=this,thisOptions=this.options;this.History=new cHistory(this);this.iGroupView=new cGroupView(this);this.cTreeView=new cTreeView(this);this.iSearch=new cSearch(this);this.iHeaderSearch=new cHeaderSearch(this);this.iCRUD=new cCRUD(this);this.iUCData=new $.paramquery.cUCData(this);this.pqSheet={};$(this.element).on("pqsheetcellmousedown",function(evt,ui){return true;return that._onCellMouseDownSheet(evt,ui)});$(this.element).on("pqsheetcellmousemove",function(evt,ui){return true;return that._onCellMouseMoveSheet(evt,ui)});$(document).bind("mouseup",function(evt,ui){return true;return that._onDocumentMouseUpSheet(evt,ui)});this._super.apply(this);this.$cont.on("click","tr.pq-group-row",function(evt){return that.iGroupView.onClickGroupRow(evt)});this.pqSheet={};this.iDragColumns=new cDragColumns(this);var dragColumns=thisOptions.dragColumns;if(dragColumns&&dragColumns.enabled){this.$header.on("mousemove","td.pq-grid-col",function(evt,ui){that.iDragColumns.setDraggables(evt,ui)})}this._createToolbar();this._createIconList();this._createCheckBoxColumn();this.refresh()};fn._createToolbar=function(){var that=this,options=this.options,toolbar=options.toolbar;if(toolbar){var tb=toolbar,cls=tb.cls,cls=cls?cls:"",style=tb.style,style=style?style:"",attr=tb.attr,attr=attr?attr:"",items=tb.items;var $toolbar=$("<div class='"+cls+"' style='"+style+"' "+attr+" ></div>").appendTo($(".pq-grid-top",this.element));$toolbar.pqToolbar({items:items,gridInstance:this});if(!options.showToolbar){$toolbar.css("display","none")}this.$toolbar=$toolbar}};fn.isLeftOrRight=function(colIndx){var thisOptions=this.options,freezeCols=this.freezeCols;if(colIndx>freezeCols){return"right"}else{return"left"}};fn.ovCreateHeader=function(buffer,const_cls){if(this.options.filterModel.header){this.iHeaderSearch.createDOM(buffer,const_cls)}};fn._createHeader=function(){this._super.apply(this);if(this.options.showHeader){this._trigger("createHeader")}};fn.exportExcel=function(obj){obj.format="xml";return $.paramquery.pqgrid.exportToExcel.call(this,obj)};fn.exportCsv=function(obj){obj.format="csv";return $.paramquery.pqgrid.exportToExcel.call(this,obj)};fn.filter=function(objP){var replace=(objP.oper=="replace")?true:false,arrS=objP.data,CM=this.colModel,foundCount=0,CMLength=CM.length,arrSLength=arrS.length;for(var i=0;i<CMLength;i++){var column=CM[i],found=false;for(var j=0;j<arrSLength;j++){if(foundCount==arrSLength){break}var obj=arrS[j];if(obj.dataIndx==column.dataIndx){found=true;foundCount++;var filter=column.filter;if(filter){filter.on=true;filter.value=obj.value;if(obj.condition){filter.condition=obj.condition}}else{column.filter={condition:obj.condition,value:obj.value,on:true}}break}}if(replace&&!found&&column.filter){column.filter.on=false}}this.refreshDataAndView({header:false})};fn._refreshHeader=function(){throw ("not used");var thisOptions=this.options,numberCell=thisOptions.numberCell,columnBorders=thisOptions.columnBorders,CM=this.colModel,$tbl_header=this.$tbl_header;var $tr1=$($($tbl_header[0]).children("tbody").children("tr")[0]);var $tds1=$tr1.find("td");if($tbl_header.length>1){var $tr2=$($($tbl_header[1]).children("tbody").children("tr")[0]);var $tds2=$tr2.find("td")}var k=0;if(numberCell.show){$tds1[0].style.width=(numberCell.width+1)+"px";if($tds2&&$tds2[0]){$tds2[0].style.width=(numberCell.width+1)+"px"}k=1}for(var i=0;i<CM.length;i++){var column=CM[i];if(column.hidden){continue}var wd=parseInt(column.width)+((columnBorders)?1:0);$tds1[k].style.width=wd+"px";if($tds2&&$tds2[k]){$tds2[k].style.width=wd+"px"}k++}};fn._createCheckBoxColumn=function(){var CM=this.colModel;for(var i=0;i<CM.length;i++){var column=CM[i];if(column.type==="checkBoxSelection"){new cCheckBoxColumn(this)}}};fn.refreshHeader=function(){this._createHeader()};fn.refreshDataFromDataModel=function(){this._super.apply(this);var thisOptions=this.options,DM=thisOptions.dataModel,GM=thisOptions.groupModel,GMTrue=(GM)?true:false,TVM=thisOptions.treeModel,TVTrue=(TVM)?true:false;if(GMTrue){this.iGroupView._groupData(this.data);this.iGroupView.initcollapsed()}else{if(TVTrue){this.cTreeView._refreshDataFromDataModel()}}};fn._refreshSorters=function(pDataIndx){var thisOptions=this.options,DM=thisOptions.dataModel,DMsortIndx=DM.sortIndx,multiSort=$.isArray(DMsortIndx),GM=thisOptions.groupModel,GMdataIndx=GM?GM.dataIndx:null,GMDir=GM?GM.dir:null,foundInGMIndx=-1,sorters=[];if(GM){for(var i=0;i<GMdataIndx.length;i++){var gDataIndx=GMdataIndx[i];if(gDataIndx==pDataIndx){foundInGMIndx=i}sorters.push({dataIndx:gDataIndx,dir:(GMDir&&GMDir[i])?GMDir[i]:"up"})}}if(foundInGMIndx!==-1){var dir=sorters[foundInGMIndx].dir;var newDir=(dir==="up")?"down":"up";sorters[foundInGMIndx].dir=newDir;GMDir[foundInGMIndx]=newDir}else{if(pDataIndx!=null){if(multiSort){var indx=$.inArray(pDataIndx,DM.sortIndx);if(indx!=-1){if(DM.sortDir[indx]=="up"){DM.sortDir[indx]="down"}else{if(DMsortIndx.length==1){DM.sortDir[indx]="up"}else{DM.sortIndx.splice(indx,1);DM.sortDir.splice(indx,1)}}}else{var len=DM.sortIndx.length;DM.sortIndx[len]=pDataIndx;DM.sortDir[len]="up"}}else{if(DM.sortIndx==pDataIndx){DM.sortDir=(DM.sortDir=="up")?"down":"up"}else{DM.sortIndx=pDataIndx;DM.sortDir="up"}}}}if(DM.sortIndx!=null){if(multiSort){for(var i=0;i<DMsortIndx.length;i++){var dataIndx=DMsortIndx[i];if(this.inSorters(sorters,dataIndx)==-1){sorters.push({dataIndx:dataIndx,dir:DM.sortDir[i]})}}}else{if(this.inSorters(sorters,DM.sortIndx)==-1){sorters.push({dataIndx:DM.sortIndx,dir:DM.sortDir})}}}this.sorters=sorters};fn.inSorters=function(sorters,dataIndx){var found=-1;for(var i=0;i<sorters.length;i++){var sorter=sorters[i];if(sorter.dataIndx==dataIndx){found=i;break}}return found};fn._sortLocalData=function(data){var thisOptions=this.options,DM=thisOptions.dataModel,CM=this.colModel,sorters=this.sorters;for(var i=0;i<sorters.length;i++){var sorter=sorters[i],dataIndx=sorter.dataIndx,colIndx=this.getColIndx({dataIndx:dataIndx}),dataType=CM[colIndx].dataType;sorter.dataType=dataType}this.__sortLocalData(sorters,DM.data)};fn.__sortLocalData=function(sorters,data){if(data==null||data.length==0||sorters.length==0){return}function innerSort(){function sort_composite(obj1,obj2){var ret=0;for(var i=0,len=sorters.length;i<len;i++){var sorter=sorters[i],dataIndx=sorter.dataIndx,dir=(sorter.dir=="up")?1:-1,dataType=sorter.dataType;if(dataType=="integer"){ret=sort_integer(obj1,obj2,dataIndx,dir)}else{if(dataType=="float"){ret=sort_float(obj1,obj2,dataIndx,dir)}else{if(typeof dataType=="function"){ret=sort_custom(obj1,obj2,dataIndx,dir,dataType)}else{if(dataType=="date"){ret=sort_date(obj1,obj2,dataIndx,dir)}else{ret=sort_string(obj1,obj2,dataIndx,dir)}}}}if(ret!=0){break}}return ret}function sort_integer(obj1,obj2,dataIndx,dir){var val1=obj1[dataIndx];var val2=obj2[dataIndx];val1=val1?parseInt(val1,10):0;val2=val2?parseInt(val2,10):0;return((val1-val2)*dir)}function sort_date(obj1,obj2,dataIndx,dir){var val1=obj1[dataIndx];var val2=obj2[dataIndx];val1=val1?Date.parse(val1):0;val2=val2?Date.parse(val2):0;return((val1-val2)*dir)}function sort_custom(obj1,obj2,dataIndx,dir,dataType){var val1=obj1[dataIndx];var val2=obj2[dataIndx];return(dataType(val1,val2)*dir)}function sort_float(obj1,obj2,dataIndx,dir){var val1=(obj1[dataIndx]+"").replace(/,/g,"");var val2=(obj2[dataIndx]+"").replace(/,/g,"");val1=val1?parseFloat(val1):0;val2=val2?parseFloat(val2):0;return((val1-val2)*dir)}function sort_string(obj1,obj2,dataIndx,dir){var val1=obj1[dataIndx];var val2=obj2[dataIndx];val1=val1?val1:"";val2=val2?val2:"";var ret=0;if(val1>val2){ret=1}else{if(val1<val2){ret=-1}}return(ret*dir)}function sort_stringi(obj1,obj2,dataIndx,dir){var val1=obj1[dataIndx];var val2=obj2[dataIndx];val1=val1?val1.toUpperCase():"";val2=val2?val2.toUpperCase():"";var ret=0;if(val1>val2){ret=1}else{if(val1<val2){ret=-1}}return(ret*dir)}data=data.sort(sort_composite)}$.measureTime(innerSort,"innerSort")};fn._refreshHeaderSortIcons=function(){var thisOptions=this.options,DM=thisOptions.dataModel,sorters=this.sorters,thisColModel=this.colModel;var $header=this.$header;var $pQuery_cols=$header.find(".pq-grid-col");$pQuery_cols.removeClass("pq-col-sort-asc pq-col-sort-desc ui-state-active");$header.find(".pq-col-sort-icon").removeClass("ui-icon ui-icon-triangle-1-n ui-icon-triangle-1-s");for(var i=0;i<sorters.length;i++){var sorter=sorters[i];var dataIndx=sorter.dataIndx;var colIndx=this.getColIndx({dataIndx:dataIndx});var dir=sorter.dir;var addClass="ui-state-active pq-col-sort-"+(dir=="up"?"asc":"desc");var cls2="ui-icon ui-icon-triangle-1-"+(dir=="up"?"n":"s");$header.find(".pq-grid-col[pq-grid-col-indx="+colIndx+"]").addClass(addClass);$header.find(".pq-grid-col[pq-grid-col-indx="+colIndx+"] .pq-col-sort-icon").addClass(cls2)}};fn.getHeaderColumnFromTD=function($td){var colIndx=$td.attr("pq-grid-col-indx");if(colIndx==null){return}var column=this.colModel[colIndx];return column};fn.getIndxInSorters=function(dataIndx){var sorters=this.sorters;for(var i=0,len=sorters.length;i<len;i++){if(sorters[i].dataIndx==dataIndx){return i}}return -1};fn._getTblSingle=function(rowIndxPage,colIndx){var $tbl=this.$tbl,colIndx=(colIndx!=null)?colIndx:0,thisOptions=this.options,freezeCols=thisOptions.freezeCols,freezeRows=thisOptions.freezeRows;if($tbl!=undefined){if($tbl.length==4){if(rowIndxPage>=freezeRows&&colIndx>=freezeCols){$tbl=$($tbl[3])}else{if(rowIndxPage>=freezeRows&&colIndx<freezeCols){$tbl=$($tbl[2])}else{if(rowIndxPage<freezeRows&&colIndx>=freezeCols){$tbl=$($tbl[1])}else{$tbl=$($tbl[0])}}}}else{if($tbl.length==2){if(rowIndxPage>=freezeRows&&colIndx>=freezeCols){$tbl=$($tbl[1])}else{$tbl=$($tbl[0])}}else{$tbl=$($tbl[0])}}}return $tbl};fn._onKeyDownSheet=function(evt,ui){var keyCodes={z:"90",y:"89",c:"67",v:"86"};if(evt.ctrlKey&&evt.keyCode==keyCodes.z){if(this.History.undo()){this.refresh()}return false}else{if(evt.ctrlKey&&evt.keyCode==keyCodes.y){if(this.History.redo()){this.refresh()}return false}else{if(evt.ctrlKey&&evt.keyCode==keyCodes.c){if(this.History.redo()){this.refresh()}return false}}}};fn._OnMouseDownDragSeries=function(evt,ui){this.pqSheet.mouseDownDragSeries=true;return true};fn._onCellUnSelectSheet=function(evt,ui){};fn._onCellSelectSheet=function(evt,ui){if(this.sCells.getSelection().length==1){this.bb(ui.rowIndx,ui.colIndx)}};fn._onCellMouseDownSheet=function(evt,ui){var DM=ui.dataModel,val=DM.data[ui.rowIndx][ui.colIndx];if(DM.mousedown&&evt.shiftKey){var MD=DM.mousedown;var obj={rowIndxStart:MD.rowIndx,colIndxStart:MD.colIndx,rowIndxEnd:ui.rowIndx,colIndxEnd:ui.colIndx};ui.dataModel.obj=obj;this._blockSelect(MD.rowIndx,MD.colIndx,ui.rowIndx,ui.colIndx);this.bb(ui.rowIndx,ui.colIndx)}else{DM.mousedown={rowIndx:ui.rowIndx,colIndx:ui.colIndx,val:val};var obj={rowIndxStart:ui.rowIndx,colIndxStart:ui.colIndx,rowIndxEnd:ui.rowIndx,colIndxEnd:ui.colIndx};ui.dataModel.obj=obj;this.setSelection(null);this.setSelection({rowIndx:ui.rowIndx,colIndx:ui.colIndx});this.bb(ui.rowIndx,ui.colIndx)}return true};fn._onCellMouseMoveSheet=function(evt,ui){if(this.pqSheet.mouseDownDragSeries){var data=this.$dragSeries.data();var rowIndxStart,colIndxStart,rowIndxEnd,colIndxEnd,left,top;if(data){rowIndxStart=data.rowIndx;colIndxStart=data.colIndx;left=data.left;top=data.top}var r2=ui.rowIndx,c2=colIndxStart;if(r2>=rowIndxStart){rowIndxEnd=r2}else{rowIndxEnd=rowIndxStart;rowIndxStart=r2}if(c2>=colIndxStart){colIndxEnd=c2}else{colIndxEnd=colIndxStart;colIndxStart=c2}var obj={rowIndxStart:rowIndxStart,colIndxStart:colIndxStart,rowIndxEnd:rowIndxEnd,colIndxEnd:colIndxEnd};ui.dataModel.obj=obj;this._blockSelect(rowIndxStart,colIndxStart,rowIndxEnd,colIndxEnd)}else{if(ui.dataModel.mousedown){var md=ui.dataModel.mousedown,rowIndxStart=md.rowIndx,colIndxStart=md.colIndx;var r2=ui.rowIndx,c2=ui.colIndx;if(r2>=rowIndxStart){rowIndxEnd=r2}else{rowIndxEnd=rowIndxStart;rowIndxStart=r2}if(c2>=colIndxStart){colIndxEnd=c2}else{colIndxEnd=colIndxStart;colIndxStart=c2}var obj={rowIndxStart:rowIndxStart,colIndxStart:colIndxStart,rowIndxEnd:rowIndxEnd,colIndxEnd:colIndxEnd};ui.dataModel.obj=obj;this._blockSelect(rowIndxStart,colIndxStart,rowIndxEnd,colIndxEnd);this.bb(rowIndxEnd,colIndxEnd)}}};fn.getLargestRowCol=function(arr){var rowIndx,colIndx;for(var i=0;i<arr.length;i++){var sel=arr[i];var rowIndx2=sel.rowIndx;if(rowIndx==null){rowIndx=sel.rowIndx}else{if(rowIndx2>rowIndx){rowIndx=rowIndx2}}rowIndx=sel.rowIndx}};fn._onDocumentMouseUpSheet=function(evt,ui){var DM=this.options.dataModel;DM.mousedown=null;var rowIndxStart,colIndxStart,left,top;if(this.pqSheet.mouseDownDragSeries){var data=this.$dragSeries.data();if(data){rowIndxStart=data.rowIndx;colIndxStart=data.colIndx;left=data.left;top=data.top;var newVal=this.data[rowIndxStart][colIndxStart];var selection=this.selection({type:"cell",method:"getSelection"});var fullOp=[];for(var i=0;i<selection.length;i++){var sel=selection[i];var rowIndx=sel.rowIndx;var colIndx=this.getColIndx({dataIndx:sel.dataIndx});var oldVal=this.data[rowIndx][colIndx];if(oldVal!=newVal){this.data[rowIndx][colIndx]=newVal;var op={rowIndx:rowIndx,colIndx:colIndx,newVal:newVal,oldVal:oldVal};fullOp.push(op)}}if(fullOp.length>0){this.History.push(fullOp)}this.refreshColumn({colIndx:colIndx});this.bb(rowIndx,colIndx)}this.pqSheet.mouseDownDragSeries=false}return true};fn.bb=function(rowIndx,colIndx){var $td=this.getCell({rowIndx:rowIndx,colIndx:colIndx});if($td){$td.css({outline:"2px solid steelblue"});var left=$td[0].offsetLeft+$td[0].offsetWidth;var top=$td[0].offsetTop+$td[0].offsetHeight;this.$dragSeries.css({left:left-4,top:top-5,display:""});this.$dragSeries.data({rowIndx:rowIndx,colIndx:colIndx,left:left,top:top})}else{this.$dragSeries.css({display:"none"})}};fn._onLoad=function(){this.options.dataModel.postData=""};fn._onRefreshSheet=function(){var data=this.$dragSeries.data();if(data){var rowIndx=data.rowIndx,colIndx=data.colIndx,left=data.left,top=data.top;this.bb(rowIndx,colIndx)}};fn.bringCellToView=function(obj){this._bringCellToView(obj)};fn._setUrl=function(queryStr){this.options.dataModel.getUrl=function(){return{url:this.url+((queryStr!=null)?queryStr:"")}}};fn.getFilterData=function(){var CM=this.colModel,CMLength=CM.length,conditions=$.paramquery.filter.getConditions,TRconditions=$.paramquery.filter.getTRConditions,arrS=[];for(var i=0;i<CMLength;i++){var column=CM[i],dataIndx=column.dataIndx,filter=column.filter;if(filter&&filter.on){var value=filter.value,condition=filter.condition;if($.inArray(condition,conditions)!=-1){if((value==null||value==="")){if($.inArray(condition,TRconditions)!=-1){continue}}else{value=(value+"").toUpperCase()}arrS.push({dataIndx:dataIndx,value:value,condition:condition})}}}return arrS};fn.filterLocalData=function(){var arrS=this.getFilterData(),options=this.options,DM=options.dataModel,data1=DM.data,data2=this.dataUF,arr1=[],arr2=[],FM=options.filterModel,FMmode=FM?FM.mode:null;var isMatch=function(rowData,arrS,FMmode){if(arrS.length==0){return true}for(var i=0;i<arrS.length;i++){var s=arrS[i],dataIndx=s.dataIndx,text=s.value,condition=s.condition,cd=rowData[dataIndx],found=false;if(condition=="contain"){cd=(cd+"").toUpperCase();if(cd.indexOf(text)!=-1){found=true}}else{if(condition=="notcontain"){cd=(cd+"").toUpperCase();if(cd.indexOf(text)==-1){found=true}}else{if(condition=="empty"){cd=$.trim(cd+"");if(cd.length==0){found=true}}else{if(condition=="notempty"){cd=$.trim(cd+"");if(cd.length>0){found=true}}else{if(condition=="begin"){cd=(cd+"").toUpperCase();if(cd.indexOf(text)==0){found=true}}else{if(condition=="end"){cd=(cd+"").toUpperCase();var lastIndx=cd.lastIndexOf(text);if(lastIndx!=-1&&(lastIndx+text.length==cd.length)){found=true}}else{if(condition=="regexp"){if(text.test(cd)){found=true}}else{if(condition=="equal"){cd=(cd+"").toUpperCase();if(cd==text){found=true}}else{if(condition=="notequal"){cd=(cd+"").toUpperCase();if(cd!=text){found=true}}else{if(condition=="great"&&cd>text){found=true}else{if(condition=="less"&&cd<text){found=true}}}}}}}}}}}if(FMmode=="OR"&&found){return true}if(FMmode=="AND"&&!found){return false}}if(FMmode=="AND"){return true}else{if(FMmode=="OR"){return false}}};if(!data2){data2=this.dataUF=[]}if(data1){if(FM.on&&FMmode){for(var i=0,len=data1.length;i<len;i++){var rowData=data1[i];if(isMatch(rowData,arrS,FMmode)){arr1.push(rowData)}else{arr2.push(rowData)}}for(var i=0,len=data2.length;i<len;i++){var rowData=data2[i];if(isMatch(rowData,arrS,FMmode)){arr1.push(rowData)}else{arr2.push(rowData)}}}else{for(var i=0,len=data1.length;i<len;i++){var rowData=data1[i];arr1.push(rowData)}for(var i=0,len=data2.length;i<len;i++){var rowData=data2[i];arr1.push(rowData)}}DM.data=arr1;this.dataUF=arr2}else{DM.data=[]}};fn._onDataAvailable=function(){var thisOptions=this.options,FM=thisOptions.filterModel;if(FM&&FM.on&&thisOptions.dataModel.location=="local"){this.filterLocalData()}};fn._setScrollVLength=function(data){var GM=this.options.groupModel;data=(GM)?this.dataGM:data;this._super.call(this,data)};$.widget("paramquery.pqGrid",$.paramquery._pqGrid,fn);$.paramquery.pqGrid.regional={};$.paramquery.pqGrid.regional.en=fn._regional;$.paramquery.pqGrid.setDefaults=function(obj){for(var key in obj){fn.options[key]=obj[key]}$.widget("paramquery.pqGrid",fn);$(".pq-grid").each(function(i,grid){$(grid).pqGrid("option",obj)})}})(jQuery);(function(a){a.paramquery=(a.paramquery==null)?{}:a.paramquery;a.paramquery.pqgrid=(a.paramquery.pqgrid==null)?{}:a.paramquery.pqgrid;a.paramquery.pqgrid.exportToExcel=function(f){var g=this,c=(f.urlPost===undefined)?f.url:f.urlPost,d=f.url,b=(f.sheetName==null)?"pqGrid":f.sheetName,j=f.format,h=function(){var q=g.colModel,l=q.length,w=g.options,x=w.dataModel,t=x.data,m=t.length,p=[];var u=[];for(var s=0;s<l;s++){var o=q[s];if(!o.hidden){u.push('<Column ss:AutoFitWidth="1"  ss:Width="'+o.width+'" />')}}u.push("<Row>");for(var s=0;s<l;s++){var o=q[s];if(!o.hidden){u.push('<Cell><Data ss:Type="String">'+o.title+"</Data></Cell>")}}u.push("</Row>");u=u.join("\n");for(var s=0;s<m;s++){var n=t[s];p.push("<Row>");for(var r=0;r<l;r++){var o=q[r];if(!o.hidden){var v=o.dataIndx;p.push('<Cell><Data ss:Type="String"><![CDATA['+n[v]+"]]></Data></Cell>")}}p.push("</Row>")}p=p.join("\n");var k=['<?xml version="1.0"?>','<?mso-application progid="Excel.Sheet"?>','<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"',' xmlns:o="urn:schemas-microsoft-com:office:office"',' xmlns:x="urn:schemas-microsoft-com:office:excel"',' xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"',' xmlns:html="http://www.w3.org/TR/REC-html40">','<Worksheet ss:Name="',b,'">',"<Table>",u,p,"</Table>","</Worksheet>","</Workbook>"];return k.join("\n")},i=function(){var q=g.colModel,l=q.length,y=g.options,z=y.dataModel,t=z.data,m=t.length,k=[],u=[],p=[];for(var s=0;s<l;s++){var o=q[s];if(!o.hidden){var x=o.title.replace('"','""');u.push('"'+o.title+'"')}}k.push(u.join(","));for(var s=0;s<m;s++){var n=t[s];for(var r=0;r<l;r++){var o=q[r];if(!o.hidden){var w=o.dataIndx;var v=n[w]+"";v=v.replace('"','""');p.push('"'+v+'"')}}k.push(p.join(","));p=[]}return k.join("\n")};var e=(j=="xml")?h():i();a.ajax({url:c,type:"POST",cache:false,data:{extension:j,excel:e},success:function(k){var l=d+"?filename="+k;a(document.body).append("<iframe height='0' width='0' frameborder='0'  src="+l+"></iframe>")}})}})(jQuery);(function(b){var d=b.paramquery.cUCData=function(e){this.that=e;this.udata=[];this.ddata=[];this.adata=[]};var c=d.prototype;c.add=function(l){var h=this.that,g=this.adata,j=l.rowData,k=h.getRecId({rowData:j});for(var f=0,e=g.length;f<e;f++){var m=g[f];if(k!=null&&m.recId==k){throw ("primary key violation")}if(m.rowData==j){throw ("same data can't be added twice.")}}var l={recId:k,rowData:j};g.push(l)};c.update=function(s){var p=this.that,k=s.rowIndx,h=p.getRowData({rowIndx:k}),n=p.getRecId({rowData:h}),q=s.dataIndx,r=s.oldVal,f=s.newVal,g=this.udata,e=false;if(n==null){return}for(var m=0,o=g.length;m<o;m++){var j=g[m];if(j.rowData==h&&j.dataIndx==q){e=true;if(j.oldVal==f){g.splice(m,1);var l={rowIndx:k,dataIndx:q,cls:"pq-cell-dirty"};p.removeClass(l)}else{j.newVal=f}break}}if(!e){var l={rowData:h,recId:n,dataIndx:q,newVal:f,oldVal:r};g.push(l);var l={rowIndx:k,dataIndx:q,cls:"pq-cell-dirty"};p.addClass(l)}};c["delete"]=function(l){var o=this.that,j=l.rowIndx,e=l.rowIndxPage,h=o.rowIndxOffset,j=(j==null)?(e+h):j,e=(e==null)?(j-h):e,f=o.options.dataModel.paging,m=(f=="remote")?e:j,q=this.adata,p=this.ddata,g=o.getRowData(l);for(var k=0,n=q.length;k<n;k++){if(q[k].rowData==g){q.splice(k,1);return}}p.push({indx:m,rowData:g})};c.undeleteNotUsed=function(g){var f=this.ddata;var e=b.inArray(g,f);f.splice(e,1)};c.isDirty=function(){var h=this.that,f=this.udata,g=this.adata,e=this.ddata;if(f.length||g.length||e.length){return true}else{return false}};c.getChangesValue=function(){var o=this.that,e=this.udata,u=this.adata,p=this.ddata,h={updateList:[],addList:[],deleteList:[]},l=[],s=[],n=[],r=[];for(var j=0;j<e.length;j++){var g=e[j],k=g.recId,f=g.rowData;if(b.inArray(f,l)==-1){var t={};for(var q in f){if(q.indexOf("pq_")!=0){t[q]=f[q]}}l.push(f);s.push(t)}}for(var j=0;j<u.length;j++){var g=u[j],f=g.rowData,t={};for(var q in f){if(q.indexOf("pq_")!=0){t[q]=f[q]}}n.push(t)}for(var j=0,m=p.length;j<m;j++){var g=p[j],f=g.rowData,t={};for(var q in f){if(q.indexOf("pq_")!=0){t[q]=f[q]}}r.push(t)}h.updateList=s;h.addList=n;h.deleteList=r;return h};c.getChanges=function(){var n=this.that,e=this.udata,r=this.adata,o=this.ddata,h={updateList:[],addList:[],deleteList:[]},q=[],m=[],p=[];for(var j=0;j<e.length;j++){var g=e[j],k=g.recId,f=g.rowData;if(b.inArray(f,q)==-1){q.push(f)}}for(var j=0;j<r.length;j++){var g=r[j],f=g.rowData;m.push(f)}for(var j=0,l=o.length;j<l;j++){var g=o[j],f=g.rowData;if(!b.inArray(f,p)){p.push(f)}}h.updateList=q;h.addList=m;h.deleteList=p;return h};c.getChangesRaw=function(){var h=this.that,f=this.udata,g=this.adata,e=this.ddata,i={updateList:[],addList:[],deleteList:[]};i.updateList=f;i.addList=g;i.deleteList=e;return i};c.getChangesOld=function(){var l=this.that,g=this.udata,t=this.adata,o=this.ddata,x={updateList:[],addList:[],deleteList:[]},v=[],s=[],h=[];for(var q=0;q<g.length;q++){var k=g[q],m=k.rowData,n=k.dataIndx,u=k.newVal,f=false,w=l.getRecId({rowData:m});if(w!=null){for(var p=0;p<v.length;p++){if(v[p].recId==w){f=true;v[p]["fieldList"].push({dataIndx:n,value:u});break}}if(!f){v.push({recId:w,fieldList:[{dataIndx:n,value:u}]})}}}for(var q=0;q<t.length;q++){var k=t[q],m=k.rowData;var e=[];for(var n in m){e.push({dataIndx:n,value:m[n]})}s.push({fieldList:e})}for(var q=0,r=o.length;q<r;q++){var k=o[q],m=k.rowData,w=l.getRecId({rowData:m});h.push({recId:w,rowData:m})}x.updateList=v;x.addList=s;x.deleteList=h;return x};c.commit=function(u){var o=this.that,s=o.options.dataModel,g=o.colModel,D=s.recIndx,h=this.udata,E=this.adata,w=this.ddata;if(u==null){for(var B=0,C=h.length;B<C;B++){var n=h[B],t=n.dataIndx,q=n.rowData;o.removeClass({rowData:q,dataIndx:t,cls:"pq-cell-dirty"})}this.udata=[];this.ddata=[];this.adata=[]}else{var v=u.type,r=u.rows,F=[];if(v=="add"){for(var z=0;z<r.length;z++){var m=r[z];for(var B=0,C=E.length;B<C;B++){var q=E[B].rowData,e=true;for(var y=0;y<g.length;y++){var f=g[y],A=f.hidden,t=f.dataIndx;if(A||(t==D)){continue}if(q[t]!=m[t]){e=false;break}}if(e){q[D]=m[D];F.push(q)}}}var p=[];for(var B=0;B<E.length;B++){var q=E[B].rowData;if(b.inArray(q,F)==-1){p.push(E[B])}}this.adata=p}else{if(v=="update"){for(var B=0,C=h.length;B<C;B++){var q=h[B].rowData;if(b.inArray(q,F)!=-1){continue}for(var z=0;z<r.length;z++){var m=r[z];if(q[D]==m[D]){F.push(q);for(var y=0;y<g.length;y++){var f=g[y],A=f.hidden,t=f.dataIndx;if(m[t]!==undefined){o.removeClass({rowData:q,dataIndx:t,cls:"pq-cell-dirty"});q[t]=m[t]}}}}}var x=[];for(var B=0;B<h.length;B++){var q=h[B].rowData;if(b.inArray(q,F)==-1){x.push(h[B])}}this.udata=x}else{if(v=="delete"){for(var B=0,C=w.length;B<C;B++){var q=w[B].rowData;for(var z=0;z<r.length;z++){var m=r[z];if(q[D]==m[D]){F.push(q)}}}var l=[];for(var B=0;B<w.length;B++){var q=w[B].rowData;if(b.inArray(q,F)==-1){l.push(w[B])}}this.ddata=l}}}}o.refreshView()};c.rollback=function(o){var k=this.that,m=k.options.dataModel,f=m.paging,r=(o&&(o.refreshView!=null))?o.refreshView:true,q=(o&&(o.type!=null))?o.type:null,A=m.data,w=m.recIndx,e=this.udata,s=this.ddata,x=this.adata;if(q==null||q=="update"){for(var u=0,v=e.length;u<v;u++){var h=e[u],y=h.recId,l=h.rowData,n=h.dataIndx;if(y==null){continue}l[n]=h.oldVal;k.removeClass({rowData:l,dataIndx:n,cls:"pq-cell-dirty"})}this.udata=[]}if(q==null||q=="delete"){for(var u=s.length-1;u>=0;u--){var h=s[u],z=h.indx,l=h.rowData;A.splice(z,0,l);if(f=="remote"){m.totalRecords++}}this.ddata=[]}if(q==null||q=="add"){for(var u=0,v=x.length;u<v;u++){var h=x[u],l=h.rowData;for(var t=0,g=A.length;t<g;t++){if(A[t]==l){var p=A.splice(t,1);if(p&&p.length&&f=="remote"){m.totalRecords--}break}}}this.adata=[]}if(r){k.refreshView()}};var a=b.paramquery.pqGrid.prototype;a.getChanges=function(f){this.quitEditMode();if(f){var e=f.format;if(e){if(e=="byVal"){return this.iUCData.getChangesValue()}else{if(e=="raw"){return this.iUCData.getChangesRaw()}}}}return this.iUCData.getChanges()};a.rollback=function(e){this.quitEditMode();this.iUCData.rollback(e)};a.isDirty=function(){return this.iUCData.isDirty()};a.commit=function(e){this.quitEditMode();this.iUCData.commit(e)};a._getRowIndx=function(){var j=this;var f=j.selection({type:"row",method:"getSelection"});if(f&&f.length>0){var i=f[0].rowIndx,l=j.rowIndxOffset,h=j.options.dataModel,g=h.paging,e=i-l,k=h.rPP;if(g){if(e>=0&&e<k){return i}}else{return i}}else{return null}};a._updateRowRemote=function(g){var e=this,f=g.rowData;f.pq_oper="edit";e.options.dataModel.postDataOnce=f;e.refreshDataAndView()};a._updateRowLocal=function(j){var m=this,h=j.rowIndx,e=j.rowData,l=m.options.dataModel.data[h],g=m.colModel;for(var k=0;k<g.length;k++){var f=g[k],n=f.dataIndx;l[n]=e[n]}m.refreshRow({rowIndx:h})};a._fillForm=function(p){var s=this,u=s.options.dataModel,f=u.paging,q=u.data,k=s.colModel,n=s.rowIndxOffset,e=(p.rowIndxPage==null)?p.rowIndx-n:p.rowIndxPage,m=(p.rowIndx==null)?e+n:p.rowIndx,r=(f=="remote")?e:m,j=q[r];this.rowData=j;this.$crudDialog.dialog("option","title","Edit Record ("+(m+1)+")");var l=this.$crudForm;for(var o=0;o<k.length;o++){var h=k[o],t=h.dataIndx,g=j[t];l.find("*[name='"+t+"']").val(g)}};a.updateRow=function(i){var h=this,g=h.options.dataModel,e=g.location,f=this;f._updateRowLocal(i)};a.openEditForm=function(k){var i=this,g=this;var h=k.rowIndx,l=k.title,l=l?l.replace("{0}",(h+1)):"Edit Record ("+(h+1)+")";if(h!=null){this.createDialog();var f=this.$crudDialog;var j=this.createForm({oper:"edit"});var e=b(j).appendTo(f);this.$crudForm=e;this.crudEditMode=true;g._fillForm({rowIndx:h});this.$crudDialog.dialog({title:l,buttons:{Update:function(){var n=i.options.dataModel,m=i.colModel;if(i._trigger("crudFormUpdate",{$form:g.$frm,dataModel:n,colModel:m})==false){return}var p=g.getFormData(g.$crudForm),o=g._getRowIndx();g.updateRow({rowIndx:o,rowData:p});b(this).dialog("close")},Cancel:function(){if(i._trigger("formCancel",{$frm:g.$frm})==false){return}b(this).dialog("close")}}}).dialog("open");this._trigger("openEditForm",null,{$frm:e,$dialog:f})}};a.getRecId=function(h){var f=this,e=f.options.dataModel;h.dataIndx=e.recIndx;var g=f.getCellData(h);return g};a.getCellData=function(g){var f=this.getRowData(g),e=g.dataIndx;return f[e]};a.getRowData=function(l){var r=l.rowData;if(r!=null){return r}var s=this.options.dataModel,g=s.paging,f=s.recIndx,p=l.recId,m=s.data;if(p!=null){for(var n=0,q=m.length;n<q;n++){var h=m[n];if(h[f]==p){return h}}}else{var k=l.rowIndx,e=l.rowIndxPage,j=this.rowIndxOffset,k=(k!=null)?k:e+j,e=(e!=null)?e:k-j,o=(g=="remote")?e:k,h=m[o];return h}};a.deleteRow=function(e){this._deleteLocal(e)};a._deleteLocal=function(j){var m=this,h=j.rowIndx,n=j.effect,o=m.options,p=o.dataModel,e=p.paging;if(h!=null){var l=(e=="remote")?(h-this.rowIndxOffset):h,i=p.data,f=o.track,f=(j.track!=null)?j.track:f;if(f){this.iUCData["delete"]({rowIndx:h})}if(n){var m=this,k=this.getRow({rowIndx:h});if(k){k.effect("fade",null,350,function(){var q=j.complete;if(q&&typeof q=="function"){q.call(m)}var r=i.splice(l,1);if(r&&r.length&&e=="remote"){p.totalRecords--}m.refreshView()})}}else{var g=i.splice(l,1);if(g&&g.length&&e=="remote"){p.totalRecords--}this.refreshView()}}};a._deleteRemote=function(i){var h=this,j=h.data,f=h.options.dataModel,l=h.rowIndxOffset,e=i-l,g=f.recIndx;var k={pq_oper:"delete"};k[g]=j[e][g];f.postDataOnce=k;h.refreshDataAndView()};a._onDialogOpen=function(){var g=this,f=this,h=this.$crudDialog.parent(".ui-dialog");b(".pq-dialog-buttonset",h).remove();if(this.crudEditMode==false){return}var e=b("<div style='' class='pq-dialog-buttonset'></div>").prependTo(b(".ui-dialog-buttonpane",h));this.prev=b("<button type='button' class='ui-corner-left'></button>").appendTo(e).button({icons:{primary:"ui-icon-circle-triangle-w"},text:false}).bind("click",function(j){var i=g.rowPrevSelect();f._fillForm({rowIndxPage:i})});this.prev.removeClass("ui-corner-all");this.next=b("<button type='button' class='ui-corner-right'></button>").appendTo(e).button({icons:{primary:"ui-icon-circle-triangle-e"},text:false}).bind("click",function(j){var i=g.rowNextSelect();f._fillForm({rowIndxPage:i})});this.next.removeClass("ui-corner-all")};a.getFormData=function(m){var k=this,l={},e=k.colModel;for(var g=0;g<e.length;g++){var h=e[g],f=h.dataIndx,j=m.find("*[name='"+f+"']");l[f]=j.val()}return l};a.createForm=function(g){var p=this,r=g.oper,t=p.colModel;var q=["<table align='center'>"];var B=[];for(var x=0,A=t.length;x<A;x++){var k=t[x],s=k.dataIndx;if(k.hidden){B.push("<input type='hidden' name='"+s+"' />")}else{var f="ui-widget-content ui-corner-all pq-field ",m=k.editor,h;if(k.dataType=="date"){f+="pq-editor-date "}if(m){var n=m.type,o=m.cls?m.cls:"",f=f+o,v=m.attr,u="name='"+s+"' "+(v?v:""),z=m.style?m.style:"";if(typeof n=="function"){h=n.call(p.element,{oper:r,cls:f,dataIndx:s,colModel:t})}else{if(n=="textarea"){h="<textarea class='"+f+"' "+u+" style='"+z+"'  ></textarea>"}else{if(n=="checkbox"){h="<input class='"+f+"' "+u+" style='"+z+"' type=checkbox />"}else{if(n=="select"){var l=m.options;h=["<select class='"+f+"' "+u+" style='"+z+"' >"];if(l){for(var w=0,y=l.length;w<y;w++){var e=l[w];h.push('<option value="'+e+'">'+e+"</option>")}}h.push("</select>");h=h.join("")}else{if(n==="textbox"){h="<input class='"+f+"' "+u+" style='"+z+"' type=text />"}else{if(typeof n=="string"){h=n}}}}}}}else{h="<input class='"+f+"' type=text name='"+s+"' />"}q.push("<tr>","<td class='pq-label'>",k.title,":</td>","<td>",h,"</td>","</tr>")}}q.push("</table>");return"<form class='pq-grid-form'>"+B.join("")+q.join("")+"</form>"};a.createDialog=function(){var k=this,h=this,i=k.options,e=k.colModel;var g=["<div style='display:none;' class=''></div>"];var j=g.join("");if(h.$crudDialog){h.$crudDialog.remove()}var f=b(j).appendTo(document.body);h.$crudDialog=f;h.$crudForm=this.$crudDialog.find("form");f.dialog({width:"auto",modal:true,open:function(){b(".ui-dialog").position({of:this.element});b(".ui-dialog").find('button:contains("Cancel")').button({icons:{primary:"ui-icon-close"}});b(".ui-dialog").find('button:contains("Add")').button({icons:{primary:"ui-icon-disk"}});b(".ui-dialog").find('button:contains("Update")').button({icons:{primary:"ui-icon-disk"}});k._trigger("crudFormOpen",null,{$form:h.$crudForm,colModel:e,dataModel:i.dataModel})},close:function(){window.setTimeout(function(){h.$crudDialog.dialog("destroy")},1)},autoOpen:false});f.parent(".ui-dialog").addClass("pq-grid-dialog");f.on("dialogopen",function(l,m){h._onDialogOpen()});return f};a.openAddForm=function(){var h=this,g=this;this.crudEditMode=false;this.createDialog();var f=this.$crudDialog;var i=this.createForm({oper:"add"});var e=b(i).appendTo(f);this.$crudForm=e;f.dialog({title:"Add Record",buttons:[{text:"Add",click:function(){var k=h.options.dataModel,j=h.colModel;if(h._trigger("openAdd",{$form:g.$crudForm,dataModel:k,colModel:j})==false){}else{var l=g.getFormData(g.$crudForm);g.addRow({rowData:l})}b(this).dialog("close")}},{text:"Cancel",click:function(){b(this).dialog("close")}}]});f.dialog("open")};a.addRow=function(f){var e=this;return e._addLocal(f)};a._addLocal=function(m){var o=this,i=m.rowData,k=m.rowIndx,e=m.rowIndxPage,h=o.options,p=h.dataModel,f=p.paging,g=h.track,g=(m.track!=null)?m.track:g,l=p.data;if(l==null){return null}if(g){this.iUCData.add({rowData:i})}if(k==null&&e==null){l.push(i)}else{var j=this.rowIndxOffset,k=(k==null)?(e+j):k,e=(e==null)?(k-j):e,n=(f=="remote")?e:k;l.splice(n,0,i)}if(f=="remote"){p.totalRecords++}this.refreshDataFromDataModel();this.refresh();if(k==null){return l.length-1}else{return k}};a._addRemote=function(g){var e=this,f=g.rowData;f.pq_oper="add";e.options.dataModel.postDataOnce=f}})(jQuery);(function(b){var a={};a.options={items:[],gridInstance:null};a._create=function(){var r=this,h=this.options,o=h.gridInstance,g=o.colModel,s=h.items,e=this.element,n=e.closest(".pq-grid");e.addClass("pq-toolbar");for(var A=0,D=s.length;A<D;A++){var F=s[A],k=F.type,E=F.icon,h=F.options,p=F.label,u=F.listeners,v=F.cls,d="ui-corner-all "+(v?v:""),q=F.style,C=q?'style="'+q+'"':"",m=F.attr,x=m?m:"",t;if(k=="textbox"){t=b("<input type='text' class='"+d+"' "+x+" "+C+">").appendTo(e)}else{if(k=="checkbox"){t=b("<input type='checkbox' class='"+d+"' "+x+" "+C+">").appendTo(e)}else{if(k=="separator"){b("<span class='pq-separator '"+d+"' "+x+" "+C+"></span>").appendTo(e)}else{if(k=="button"){t=b("<button type='button' class='"+d+"' "+x+" "+C+">"+p+"</button>").button({text:p?true:false,icons:{primary:E}}).appendTo(e)}else{if(k=="select"){var h=F.options?F.options:[];if(typeof h==="function"){h=h.call(o.element,{colModel:g})}var f=["<select class='"+d+"' "+x+" "+C+" >"];for(var z=0,B=h.length;z<B;z++){var c=h[z];if(typeof c=="object"){for(var w in c){f.push('<option value="'+w+'">'+c[w]+"</option>")}}else{f.push("<option>"+c+"</option>")}}f.push("</select>");f=f.join("");t=b(f).appendTo(e)}else{if(typeof k=="string"){t=b(k).appendTo(e)}else{if(typeof k=="function"){var f=k.call(o,{colModel:g,cls:d});t=b(f).appendTo(e)}}}}}}}if(u){for(var z=0;z<u.length;z++){var l=u[z];for(var y in l){t.bind(y,l[y])}}}}};a._destroy=function(){this.element.empty().removeClass("pq-toolbar").enableSelection()};a._disable=function(){if(this.$disable==null){this.$disable=b("<div class='pq-grid-disable'></div>").css("opacity",0.2).appendTo(this.element)}};a._enable=function(){if(this.$disable){this.element[0].removeChild(this.$disable[0]);this.$disable=null}};a._setOption=function(c,d){if(c=="disabled"){if(d==true){this._disable()}else{this._enable()}}};b.widget("paramquery.pqToolbar",a)})(jQuery);