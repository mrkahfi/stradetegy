{% extends 'JariffProjectBundle::base_left_sidebar.html.twig' %}

{% block menu %}
{% endblock %}

{% block wrap_headline %}

    <div class="wrap_cont_nav" style="margin-top: -9%;">
        <div class="cont_nav">
            <form action="{{ path('member_search_result') }}" method="get" id="myForm"
                  data-url="{{ path('member_search_result') }}" class="j-searching">


                <div class="entry-content project_content portfolio_container three_blocks j-content-condition">
                    <div class="cmsms_media">
                        <div class="cmsms_media_box cmsms_media_box_overwrite">
                            <div class="form_info cmsms_input">
                                <select id="search_form_collect" style="width: 123%" name="collect[]"
                                        required="required" class="j-tour-collect">
                                    <option value="all" {% if collect[0] is defined and collect[0] == "all" -%}
                                        selected="selected"
                                            {% endif -%}>All
                                    </option>
                                    <option value="consignee_name"
                                            {% if collect[0] is defined and collect[0] == "consignee_name" -%}
                                                selected="selected"
                                            {% elseif collect[0] is not defined %}
                                                selected="selected"
                                            {% endif -%}
                                            >Importer Name
                                    </option>
                                    <option value="consignee_address"
                                            {% if collect[0] is defined and collect[0] == "consignee_address" -%}
                                        selected="selected"
                                            {% endif -%}>Importer Address
                                    </option>
                                    <option value="shipper_name"
                                            {% if collect[0] is defined and collect[0] == "shipper_name" -%}
                                                selected="selected"
                                            {% endif -%}
                                            >Exporter Name
                                    </option>
                                    <option value="shipper_address"
                                            {% if collect[0] is defined and collect[0] == "shipper_address" -%}
                                        selected="selected"
                                            {% endif -%}>Exporter Address
                                    </option>
                                    <option value="raw_notify_party_name" {% if collect[0] is defined and collect[0] == "raw_notify_party_name" -%}
                                        selected="selected"
                                            {% endif -%}>Importer Notify Party
                                    </option>
                                    <option value="unloading_port" {% if collect[0] is defined and collect[0] == "unloading_port" -%}
                                        selected="selected"
                                            {% endif -%}>US Port Shipment Entered
                                    </option>

                                    <option value="product_description" {% if collect[0] is defined and collect[0] == "product_description" -%}
                                        selected="selected"
                                            {% endif -%}>Product Description
                                    </option>

                                    <option value="carrier_sasc_code" {% if collect[0] is defined and collect[0] == "carrier_sasc_code" -%}
                                        selected="selected"
                                            {% endif -%}>Carrier Code
                                    </option>
                                    <option value="vessel_name" {% if collect[0] is defined and collect[0] == "vessel_name" -%}
                                        selected="selected"
                                            {% endif -%}>Vessel Name
                                    </option>
                                    <option value="loading_port" {% if collect[0] is defined and collect[0] == "loading_port" -%}
                                        selected="selected"
                                            {% endif -%}>Foreign Port
                                    </option>
                                    {#<option value="value.country" {% if collect[loop.index - 1] is defined and collect[loop.index - 1] == "value.country" -%}#}
                                    {#selected="selected"#}
                                    {#{% endif -%}>Origin Of Vessel#}
                                    {#</option>#}
                                    <option value="container_id" {% if collect[0] is defined and collect[0] == "container_id" -%}
                                        selected="selected"
                                            {% endif -%}>Container Number
                                    </option>
                                    <option value="bill_of_lading" {% if collect[0] is defined and collect[0] == "bill_of_lading" -%}
                                        selected="selected"
                                            {% endif -%}>Bill Of Lading Number
                                    </option>

                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="cmsms_media">
                        <div class="cmsms_media_box cmsms_media_box_overwrite_1">
                            <div class="form_info cmsms_input">

                                <input type="text" placeholder="Search" name="q[]" class="input_searching j-tour-q"
                                       id="field_003" size="10" tabindex="11"
                                       value="{% if q[0] is defined %}{{ q[0] }}{% endif %}"
                                        />

                            </div>
                        </div>
                    </div>
                    <div class="cmsms_media">
                        <div class="cmsms_media_box">
                            <div class="form_info cmsms_input">
                                <div class="button_click">

                                </div>
                            </div>
                        </div>
                    </div>


                </div>

                <div class="j-add-condition">
                    {% if collect is defined %}
                        {% if collect is not empty and collect|length > 1 %}
                            {% include 'JariffMemberBundle:Search:append-form-search.html.twig' %}
                        {% endif %}
                    {% endif %}
                </div>

                <input type="hidden" placeholder="Search" name="size" class="j-size"
                       value="{% if size is defined %}{{ size }}{% else %}10{% endif %}"
                        />

                <input type="hidden" placeholder="Search" name="filter_left_bar" class="j-filter-leftbar"
                       value="importer or exporter or product"
                        />

                <input type="hidden" placeholder="Search" name="country_filter" class="j-filter-country"
                       value=""
                        />

                <div style="clear: both"></div>


                <input type="submit" class="button button-search global-button-search j-tour-button-submit"
                       value="Search">

                <a class="j-condition add-condition-search"
                   href="javascript:void(0)">
                    <span class="livicon j-tour-add-condition" data-name="plus" data-size="32"
                          data-original-title="morph-s-t-up"></span></a>


            </form>
            <p>You have made <span class="code j-tour-count-search-today">{{ count_search_today }}</span> search(es)
                today, and you have <span class="code j-tour-count-search-value">{{ count_search_value }}</span>
                search(es) left</p>

            <button class="btn btn-primary btn-lg j-modal-show" data-toggle="modal" data-target="#myModal">
                Export/Email Report
            </button>

            <!-- Modal Export/Email Report -->
            {% include "@JariffMember/Search/Result/modal_export.twig" %}
            <!-- /.modal -->

        </div>
    </div>

{% endblock %}

    {% block content %}

        <ul id="pageTab" class="nav nav-tabs">
            <li class="active j-tour-tab-search-result"><a href="#page1" data-toggle="tab">Search Results</a></li>
            <li class="j-tour-tab-search-importers"><a href="#importer" id="importers"
                                                       data-title="Importer">Importers</a></li>
            <li class="j-tour-tab-search-exporters"><a href="#exporter" id="exporters"
                                                       data-title="Exporter">Exporters</a></li>
            <li class="j-tour-tab-search-product"><a href="#product" id="products" data-title="Products">Products</a>
            </li>
        </ul>
        <div id="pageTabContent" class="tab-content">
            <div class="tab-pane active" id="page1">
                {% if pagination is defined %}
                    <div class="jariff-pagination j-tour-pagination">
                        {{ pagination|raw }}
                    </div>
                {% endif %}

                {% for res in resHybird %}
                    {% if res.getResult.getHit["highlight"] is defined and res.getResult.getHit["highlight"] is not empty and res.getTransformed.getValue.getCompanyAs == 'exporter' %}
                        {% include "@JariffMember/Search/Result/product.html.twig" %}
                    {% else %}
                        {% if res.getTransformed.getValue.getCompanyAs == 'importer' %}
                            {% include "@JariffMember/Search/Result/importer.html.twig" %}
                        {% endif %}
                        {% if res.getTransformed.getValue.getCompanyAs == 'exporter' %}
                            {% include "@JariffMember/Search/Result/exporter.html.twig" %}
                        {% endif %}
                    {% endif %}
                {% endfor %}

                <div class="jariff-pagination">
                    {{ pagination|raw }}
                </div>
            </div>

            <div class="tab-pane" id="importer">

            </div>
            <div class="tab-pane" id="exporter">Exporter</div>
            <div class="tab-pane" id="product">Product</div>
        </div>

        <div id="dialog-confirm" title="Empty the tab?" style="display: none">
            <p><span class="ui-icon ui-icon-alert"></span>All data in this tab will disappear. Are you sure?</p>
        </div>
    {% endblock content %}

{% block left_sidebar %}
    <section id="sidebar">

        <div class="one_first">
            <aside class="widget widget_custom_latest_popular_recent_entries">
                <h2 class="widgettitle" style="display: inline">Show Per Page</h2>
                <select name="size" class="j-size-per-page j-tour-size-per-page">
                    <option value="10"
                            {% if size is defined %}{% if size == 10 %}selected="SELECTED"{% endif %}{% endif %}>10
                    </option>
                    <option value="50"
                            {% if size is defined %}{% if size == 50 %}selected="SELECTED"{% endif %}{% endif %}>50
                    </option>
                    <option value="100"
                            {% if size is defined %}{% if size == 100 %}selected="SELECTED"{% endif %}{% endif %}>100
                    </option>
                </select>
            </aside>


            <aside class="widget widget_custom_latest_popular_recent_entries">
                <h2 class="widgettitle">I would like to see</h2>


                <div class="tab_content">

                    <div class="cmsms-form-builder">
                        <div class="form_info cmsms_checkboxes">

                            <div class="check_parent">
                                <input type="checkbox" name="check_1" id="check_1" value="importer" checked
                                       class="j-filter-see">
                                <label for="check_1">Importer</label>
                                <span
                                        {% if facetCategory[0]['term'] is defined %}
                                            {% if facetCategory[0]['term'] == 'importer' %}
                                                data-total="{{ facetCategory[0]['count'] }}"
                                            {% endif %}
                                        {% else %}
                                            data-total="0"
                                        {% endif %}
                                        class="total-in-country code j-total-importer j-tour-total-importer">0</span>
                            </div>
                            <div class="check_parent">
                                <input type="checkbox" name="check_2" id="check_2" value="exporter" checked
                                       class="j-filter-see">
                                <label for="check_2">Exporter</label>
                                <span
                                        {% if facetCategory[1]['term'] is defined %}
                                            {% if facetCategory[1]['term'] == 'exporter' or facetCategory[0]['term'] == 'exporter' %}
                                                data-total="{{ facetCategory[1]['count'] }}"
                                            {% endif %}
                                        {% elseif facetCategory[0]['term'] is defined %}
                                            {% if facetCategory[0]['term'] == 'exporter' %}
                                                data-total="{{ facetCategory[0]['count'] }}"
                                            {% else %}
                                                data-total='0'
                                            {% endif %}
                                        {% endif %}
                                        class="total-in-country code j-total-exporter j-tour-total-exporter">{{ 0|ribuan }}</span>
                            </div>
                            <div class="check_parent">
                                <input type="checkbox" name="check_3" id="check_3" value="product" checked
                                       class="j-filter-see">
                                <label for="check_3">Product</label>
                                <beta>Beta</beta>
                                <span class="total-in-country code j-total-product j-tour-total-product">{{ 0|ribuan }}</span>
                            </div>

                        </div>
                    </div>


                </div>

            </aside>

            <aside class="widget widget_custom_latest_popular_recent_entries">
                <h2 class="widgettitle">Advanced filter</h2>


                <div class="tab_content">

                    <div class="cmsms-form-builder">
                        <div class="form_info cmsms_checkboxes j-country-importer j-tour-country">

                            {% for country in facetCountry %}
                                <div class="check_parent">
                                    <input type="checkbox" name="check_import[]"
                                           id="check_import_{{ country['term'] }}"
                                           class="j-check-country"
                                           value="{{ country['term'] }}">

                                    <label for="check_import_{{ country['term'] }}">
                                        <img style="position: absolute;"
                                             src="{{ asset('/bundles/jariffproject/frontend/images/flags-iso/shiny/16/'~(country['term']|twolettercodeslug)['code']~".png") }}">
                                        <span style="margin-left: 20px">{{ (country['term']|twolettercodeslug)['country'] }}</span>
                                    </label>
                                    <span class="total-in-country code">{{ country['count']|ribuan }}</span>
                                </div>
                            {% endfor %}


                        </div>

                    </div>

                </div>

            </aside>
        </div>

    </section>
{% endblock %}

{% block style %}

    <link href="{{ asset('/bundles/jariffproject/frontend/hover/css/hoveralls.css') }}" type="text/css" rel="stylesheet"
          media="screen"/>

    <link href="{{ asset('/bundles/jariffproject/frontend/css/wrapping/wrap-ribbon.css') }}" type="text/css"
          rel="stylesheet"
          media="screen"/>

    <link href="{{ asset('/bundles/jariffproject/frontend/css/bootstrap.css') }}" type="text/css"
          rel="stylesheet"
          media="screen"/>

    <link href="{{ asset('/bundles/jariffproject/frontend/css/bootstrap-tour.css') }}" type="text/css"
          rel="stylesheet"
          media="screen"/>

    <style>
        .nav-tabs > li .close {
            margin: -3px 0 0 10px;
            font-size: 18px;
            padding: 5px 0;
            float: right;
        }

        .nav-tabs > li a[data-toggle=tab] {
            float: left !important;
        }
    </style>

{% endblock %}

{% block javascript %}
    <script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
    <script src="{{ path('fos_js_routing_js', {"callback": "fos.Router.setData"}) }}"></script>
    <script src="{{ asset('bundles/jariffproject/frontend/icon/js/livicons-1.2.min.js') }}"
            type="text/javascript"></script>

    <script src="{{ asset('bundles/jariffproject/frontend/js/bootstrap/bootstrap.js') }}"
            type="text/javascript"></script>

    <script src="{{ asset('/bundles/jariffproject/frontend/js/bootstrap-tour/bootstrap-tour.js') }}"
            type="text/javascript"></script>

    <script src="{{ asset('/bundles/jariffproject/frontend/js/jqBootstrapValidation.js') }}"
            type="text/javascript"></script>

    <script src="{{ asset('/bundles/jariffmember/js/search/jariff_all_result.js') }}"
            type="text/javascript"></script>

    <script src="{{ asset('/bundles/jariffmember/js/search/jariff_all_result_category.js') }}"
            type="text/javascript"></script>

    <script src="{{ asset('/bundles/jariffmember/js/search/jariff_all_result_modal.js') }}"
            type="text/javascript"></script>


    <script src="{{ asset('/bundles/jariffmember/js/search/jariff_all_result_tab.js') }}"
            type="text/javascript"></script>


    {% block js_call %}
        <script type="text/javascript">
            $(document).ready(function () {
                var tour = new Tour();

                tour.addSteps([
                    {
                        title: "Welcome to Stradetegy....",
                        content: "Letak text content pembukaan",
                        backdrop: true,
                        orphan: true
                    },
                    {
                        element: ".j-tour-collect",
                        placement: "right",
                        title: "Judul Content",
                        content: "Keterangan collect"
                    },
                    {
                        element: ".j-tour-q",
                        placement: "bottom",
                        title: "Judul Content",
                        content: "Keterangan collect"
                    },
                    {
                        element: ".j-tour-add-condition",
                        placement: "bottom",
                        title: "Judul Content",
                        content: "Keterangan collect"
                    },
                    {
                        element: ".j-tour-count-search-today",
                        placement: "bottom",
                        title: "Judul Content",
                        content: "Keterangan collect"
                    },
                    {
                        element: ".j-tour-count-search-value",
                        placement: "bottom",
                        title: "Judul Content",
                        content: "Keterangan collect"
                    },
                    {
                        element: ".j-tour-button-submit",
                        placement: "bottom",
                        title: "Judul Content",
                        content: "Keterangan collect"
                    },
                    {
                        element: ".j-tour-size-per-page",
                        placement: "top",
                        title: "Judul Content",
                        content: "Keterangan collect"
                    },
                    {
                        element: ".j-tour-total-importer",
                        placement: "right",
                        title: "Judul Content",
                        content: "Keterangan collect"
                    },
                    {
                        element: ".j-tour-total-exporter",
                        placement: "right",
                        title: "Judul Content",
                        content: "Keterangan collect"
                    },
                    {
                        element: ".j-tour-total-product",
                        placement: "right",
                        title: "Judul Content",
                        content: "Keterangan collect"
                    },
                    {
                        element: ".j-tour-country",
                        placement: "top",
                        title: "Judul Content",
                        content: "Keterangan collect"
                    },
                    {
                        element: ".j-tour-tab-search-result",
                        placement: "top",
                        title: "Judul Content",
                        content: "Keterangan collect"
                    },
                    {
                        element: ".j-tour-tab-search-importers",
                        placement: "top",
                        title: "Judul Content",
                        content: "Keterangan collect"
                    },
                    {
                        element: ".j-tour-tab-search-exporters",
                        placement: "top",
                        title: "Judul Content",
                        content: "Keterangan collect"
                    },
                    {
                        element: ".j-tour-tab-search-product",
                        placement: "top",
                        title: "Judul Content",
                        content: "Keterangan collect"
                    },
                    {
                        element: ".pagination",
                        placement: "top",
                        title: "Judul Content",
                        content: "Keterangan collect"
                    }

                ]);

// Initialize the tour
                tour.init();

// Start the tour
                tour.start();
            })


        </script>


    {% endblock %}

{% endblock %}
